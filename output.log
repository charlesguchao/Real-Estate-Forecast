2025-03-27 16:13:56,967 - INFO - Num GPUs Available: 1
2025-03-27 16:13:56,968 - INFO - Running with Metal GPU acceleration
2025-03-27 16:13:56,969 - ERROR - Data file /Users/mastin/project_folder/db_rents_prices.csv not found. Please ensure all required files are generated.
2025-03-27 16:13:56,969 - ERROR - Error in main execution: Data file /Users/mastin/project_folder/db_rents_prices.csv not found.
2025-03-28 14:34:51,256 - INFO - Num GPUs Available: 1
2025-03-28 14:34:51,256 - INFO - Running with Metal GPU acceleration
2025-03-28 14:34:51,257 - ERROR - Data file /Users/mastin/project_folder/db_rents_prices.csv not found. Please ensure all required files are generated.
2025-03-28 14:34:51,258 - ERROR - Error in main execution: Data file /Users/mastin/project_folder/db_rents_prices.csv not found.
2025-03-28 14:35:07,627 - INFO - Num GPUs Available: 1
2025-03-28 14:35:07,627 - INFO - Running with Metal GPU acceleration
2025-03-28 14:35:07,630 - ERROR - Data file /Users/mastin/project_folder/db_rents_prices.csv not found. Please ensure all required files are generated.
2025-03-28 14:35:07,630 - ERROR - Error in main execution: Data file /Users/mastin/project_folder/db_rents_prices.csv not found.
2025-03-28 14:36:22,219 - INFO - Num GPUs Available: 1
2025-03-28 14:36:22,220 - INFO - Running with Metal GPU acceleration
2025-03-28 14:36:22,222 - ERROR - Data file /Users/mastin/project_folder/db_rents_prices.csv not found. Please ensure all required files are generated.
2025-03-28 14:36:22,222 - ERROR - Error in main execution: Data file /Users/mastin/project_folder/db_rents_prices.csv not found.
2025-03-28 14:42:34,421 - INFO - Num GPUs Available: 1
2025-03-28 14:42:34,421 - INFO - Running with Metal GPU acceleration
2025-03-28 14:42:34,424 - ERROR - Data file /Users/mastin/project_folder/db_rents_prices.csv not found. Please ensure all required files are generated.
2025-03-28 14:42:34,424 - ERROR - Error in main execution: Data file /Users/mastin/project_folder/db_rents_prices.csv not found.
2025-03-28 14:43:25,069 - INFO - Num GPUs Available: 1
2025-03-28 14:43:25,070 - INFO - Running with Metal GPU acceleration
2025-03-28 14:43:25,076 - ERROR - Data file /Users/mastin/project_folder/db_rents_prices.csv not found. Please ensure all required files are generated.
2025-03-28 14:43:25,076 - ERROR - Error in main execution: Data file /Users/mastin/project_folder/db_rents_prices.csv not found.
2025-03-28 14:50:19,650 - INFO - Num GPUs Available: 1
2025-03-28 14:50:19,651 - INFO - Running with Metal GPU acceleration
2025-03-28 14:50:19,654 - INFO - All data files found. Proceeding with processing.
2025-03-28 14:50:19,654 - INFO - Processing new data with step_size=12
2025-03-28 14:50:19,654 - INFO - Loading data files...
2025-03-28 14:50:19,722 - INFO - Merging datasets...
2025-03-28 14:50:19,728 - ERROR - Error in preprocessing data: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:50:19,728 - ERROR - Error in main execution: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:54:04,702 - INFO - Num GPUs Available: 1
2025-03-28 14:54:04,703 - INFO - Running with Metal GPU acceleration
2025-03-28 14:54:04,706 - INFO - All data files found. Proceeding with processing.
2025-03-28 14:54:04,706 - INFO - Processing new data with step_size=12
2025-03-28 14:54:04,706 - INFO - Loading data files...
2025-03-28 14:54:04,773 - INFO - Merging datasets...
2025-03-28 14:54:04,780 - ERROR - Error in preprocessing data: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:54:04,780 - ERROR - Error in main execution: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:54:08,566 - INFO - Num GPUs Available: 1
2025-03-28 14:54:08,566 - INFO - Running with Metal GPU acceleration
2025-03-28 14:54:08,569 - INFO - All data files found. Proceeding with processing.
2025-03-28 14:54:08,569 - INFO - Processing new data with step_size=12
2025-03-28 14:54:08,569 - INFO - Loading data files...
2025-03-28 14:54:08,577 - INFO - Merging datasets...
2025-03-28 14:54:08,578 - ERROR - Error in preprocessing data: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:54:08,578 - ERROR - Error in main execution: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:54:09,639 - INFO - Num GPUs Available: 1
2025-03-28 14:54:09,640 - INFO - Running with Metal GPU acceleration
2025-03-28 14:54:09,642 - INFO - All data files found. Proceeding with processing.
2025-03-28 14:54:09,642 - INFO - Processing new data with step_size=12
2025-03-28 14:54:09,642 - INFO - Loading data files...
2025-03-28 14:54:09,649 - INFO - Merging datasets...
2025-03-28 14:54:09,651 - ERROR - Error in preprocessing data: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:54:09,651 - ERROR - Error in main execution: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:54:10,108 - INFO - Num GPUs Available: 1
2025-03-28 14:54:10,108 - INFO - Running with Metal GPU acceleration
2025-03-28 14:54:10,110 - INFO - All data files found. Proceeding with processing.
2025-03-28 14:54:10,110 - INFO - Processing new data with step_size=12
2025-03-28 14:54:10,110 - INFO - Loading data files...
2025-03-28 14:54:10,116 - INFO - Merging datasets...
2025-03-28 14:54:10,117 - ERROR - Error in preprocessing data: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:54:10,117 - ERROR - Error in main execution: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:54:10,720 - INFO - Num GPUs Available: 1
2025-03-28 14:54:10,720 - INFO - Running with Metal GPU acceleration
2025-03-28 14:54:10,722 - INFO - All data files found. Proceeding with processing.
2025-03-28 14:54:10,722 - INFO - Processing new data with step_size=12
2025-03-28 14:54:10,722 - INFO - Loading data files...
2025-03-28 14:54:10,730 - INFO - Merging datasets...
2025-03-28 14:54:10,732 - ERROR - Error in preprocessing data: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:54:10,732 - ERROR - Error in main execution: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:54:11,146 - INFO - Num GPUs Available: 1
2025-03-28 14:54:11,147 - INFO - Running with Metal GPU acceleration
2025-03-28 14:54:11,149 - INFO - All data files found. Proceeding with processing.
2025-03-28 14:54:11,149 - INFO - Processing new data with step_size=12
2025-03-28 14:54:11,149 - INFO - Loading data files...
2025-03-28 14:54:11,156 - INFO - Merging datasets...
2025-03-28 14:54:11,157 - ERROR - Error in preprocessing data: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:54:11,157 - ERROR - Error in main execution: You are trying to merge on int64 and object columns for key 'Year'. If you wish to proceed you should use pd.concat
2025-03-28 14:57:11,666 - INFO - Num GPUs Available: 1
2025-03-28 14:57:11,669 - INFO - Running with Metal GPU acceleration
2025-03-28 14:57:11,672 - INFO - All data files found. Proceeding with processing.
2025-03-28 14:57:11,672 - INFO - Processing new data with step_size=12
2025-03-28 14:57:11,672 - INFO - Loading data files...
2025-03-28 14:57:11,697 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 14:57:11,698 - INFO - df_yields['Year'] dtype: int64
2025-03-28 14:57:11,698 - INFO - df_sales['Year'] dtype: int64
2025-03-28 14:57:11,698 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 14:57:11,698 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 14:57:11,700 - INFO - df_economic['Year'] dtype: int64
2025-03-28 14:57:11,700 - INFO - df_population['Year'] dtype: int64
2025-03-28 14:57:11,706 - INFO - Merging datasets...
2025-03-28 14:57:11,713 - INFO - Shape after merging: (313, 58)
2025-03-28 14:57:11,713 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 14:57:11,714 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 14:57:11,720 - INFO - Feature columns after filling NaNs: 54
2025-03-28 14:57:11,721 - INFO - NaN count in features: 313
2025-03-28 14:57:11,724 - INFO - Feature min/max: -27825.0/8231613070.0
2025-03-28 14:57:11,724 - INFO - Skipping outlier removal to prevent empty DataFrame. Shape remains: (313, 58)
2025-03-28 14:57:11,724 - INFO - price_data shape: (313, 3), features shape: (313, 54)
2025-03-28 14:57:11,965 - INFO - Preprocessed data with step_size=12, train_size=234, test_size=79, n_features=57
2025-03-28 14:57:11,966 - INFO - Starting hyperparameter optimization
2025-03-28 14:57:25,702 - WARNING - Trial 0 failed
2025-03-28 14:57:25,704 - ERROR - No trials completed successfully. Check dataset or model configuration.
2025-03-28 14:57:25,704 - ERROR - Error in main execution: No trials completed successfully.
2025-03-28 15:04:09,274 - INFO - Num GPUs Available: 1
2025-03-28 15:04:09,275 - INFO - Running with Metal GPU acceleration
2025-03-28 15:04:09,289 - INFO - All data files found. Proceeding with processing.
2025-03-28 15:04:09,289 - INFO - Processing new data with step_size=6
2025-03-28 15:04:09,289 - INFO - Loading data files...
2025-03-28 15:04:09,326 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 15:04:09,326 - INFO - df_yields['Year'] dtype: int64
2025-03-28 15:04:09,326 - INFO - df_sales['Year'] dtype: int64
2025-03-28 15:04:09,326 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 15:04:09,326 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 15:04:09,326 - INFO - df_economic['Year'] dtype: int64
2025-03-28 15:04:09,326 - INFO - df_population['Year'] dtype: int64
2025-03-28 15:04:09,335 - INFO - Merging datasets...
2025-03-28 15:04:09,343 - INFO - Shape after merging: (313, 58)
2025-03-28 15:04:09,343 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 15:04:09,345 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 15:04:09,351 - INFO - Feature columns after filling NaNs: 54
2025-03-28 15:04:09,353 - INFO - NaN count in features: 313
2025-03-28 15:04:09,356 - INFO - Feature min/max: -27825.0/8231613070.0
2025-03-28 15:04:09,356 - INFO - Skipping outlier removal to prevent empty DataFrame. Shape remains: (313, 58)
2025-03-28 15:04:09,356 - INFO - price_data shape: (313, 3), features shape: (313, 54)
2025-03-28 15:04:09,605 - INFO - Train dataset size: 117
2025-03-28 15:04:09,605 - INFO - Test dataset size: 40
2025-03-28 15:04:09,605 - INFO - Preprocessed data with step_size=6, train_size=234, test_size=79, n_features=57
2025-03-28 15:04:09,606 - INFO - Starting hyperparameter optimization
2025-03-28 15:04:09,608 - INFO - Starting trial 0
2025-03-28 15:04:09,611 - INFO - Hyperparameters: d_model=16, num_heads=2, lstm_units=8, num_layers=2, dropout_rate=0.20, l2_lambda=0.000647
2025-03-28 15:04:09,960 - INFO - Batch size: 4
2025-03-28 15:04:09,960 - INFO - Starting model training...
2025-03-28 15:04:28,299 - WARNING - Trial 0 failed
2025-03-28 15:04:28,300 - ERROR - No trials completed successfully. Check dataset or model configuration.
2025-03-28 15:04:28,300 - ERROR - Error in main execution: No trials completed successfully.
2025-03-28 15:12:41,415 - INFO - Num GPUs Available: 1
2025-03-28 15:12:41,417 - INFO - Running with Metal GPU acceleration
2025-03-28 15:12:41,433 - INFO - All data files found. Proceeding with processing.
2025-03-28 15:12:41,433 - INFO - Processing new data with step_size=3
2025-03-28 15:12:41,433 - INFO - Loading data files...
2025-03-28 15:12:41,477 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 15:12:41,477 - INFO - df_yields['Year'] dtype: int64
2025-03-28 15:12:41,477 - INFO - df_sales['Year'] dtype: int64
2025-03-28 15:12:41,477 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 15:12:41,477 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 15:12:41,477 - INFO - df_economic['Year'] dtype: int64
2025-03-28 15:12:41,477 - INFO - df_population['Year'] dtype: int64
2025-03-28 15:12:41,490 - INFO - Merging datasets...
2025-03-28 15:12:41,501 - INFO - Shape after merging: (313, 58)
2025-03-28 15:12:41,501 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 15:12:41,503 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 15:12:41,523 - INFO - Feature columns after filling NaNs: 54
2025-03-28 15:12:41,527 - INFO - NaN count in features: 313
2025-03-28 15:12:41,531 - INFO - Feature min/max: -27825.0/8231613070.0
2025-03-28 15:12:41,531 - INFO - Skipping outlier removal to prevent empty DataFrame. Shape remains: (313, 58)
2025-03-28 15:12:41,532 - INFO - price_data shape: (313, 3), features shape: (313, 54)
2025-03-28 15:12:42,067 - INFO - Train dataset size: 117
2025-03-28 15:12:42,067 - INFO - Test dataset size: 40
2025-03-28 15:12:42,067 - INFO - Preprocessed data with step_size=3, train_size=234, test_size=79, n_features=57
2025-03-28 15:12:42,069 - INFO - Starting hyperparameter optimization
2025-03-28 15:12:42,072 - INFO - Starting trial 0
2025-03-28 15:12:42,076 - INFO - Hyperparameters: d_model=8, num_heads=1, lstm_units=8, num_layers=2, dropout_rate=0.16, l2_lambda=0.000116
2025-03-28 15:12:42,076 - INFO - Building model...
2025-03-28 15:12:43,234 - INFO - Batch size: 2
2025-03-28 15:12:43,234 - INFO - Starting model training...
2025-03-28 15:12:43,250 - INFO - Sample batch from train_dataset - Inputs shape: (2, 3, 57), Targets shape: (2, 3)
2025-03-28 15:12:43,259 - INFO - Sample batch from test_dataset - Inputs shape: (2, 3, 57), Targets shape: (2, 3)
2025-03-28 15:12:55,137 - WARNING - Trial 0 failed
2025-03-28 15:12:55,149 - ERROR - No trials completed successfully. Check dataset or model configuration.
2025-03-28 15:12:55,150 - ERROR - Error in main execution: No trials completed successfully.
2025-03-28 15:20:24,937 - INFO - Num GPUs Available: 1
2025-03-28 15:20:24,940 - INFO - Running with Metal GPU acceleration
2025-03-28 15:20:24,981 - INFO - All data files found. Proceeding with processing.
2025-03-28 15:20:24,981 - INFO - Processing new data with step_size=3
2025-03-28 15:20:24,981 - INFO - Loading data files...
2025-03-28 15:20:25,041 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 15:20:25,042 - INFO - df_yields['Year'] dtype: int64
2025-03-28 15:20:25,042 - INFO - df_sales['Year'] dtype: int64
2025-03-28 15:20:25,042 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 15:20:25,042 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 15:20:25,042 - INFO - df_economic['Year'] dtype: int64
2025-03-28 15:20:25,042 - INFO - df_population['Year'] dtype: int64
2025-03-28 15:20:25,056 - INFO - Merging datasets...
2025-03-28 15:20:25,069 - INFO - Shape after merging: (313, 58)
2025-03-28 15:20:25,069 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 15:20:25,071 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 15:20:25,085 - INFO - Feature columns after filling NaNs: 54
2025-03-28 15:20:25,091 - INFO - NaN count in features: 313
2025-03-28 15:20:25,097 - INFO - Feature min/max: -27825.0/8231613070.0
2025-03-28 15:20:25,097 - INFO - Skipping outlier removal to prevent empty DataFrame. Shape remains: (313, 58)
2025-03-28 15:20:25,099 - INFO - price_data shape: (313, 3), features shape: (313, 54)
2025-03-28 15:20:25,641 - INFO - Train dataset size: 234
2025-03-28 15:20:25,641 - INFO - Test dataset size: 79
2025-03-28 15:20:25,641 - INFO - Preprocessed data with step_size=3, train_size=234, test_size=79, n_features=57
2025-03-28 15:20:25,643 - INFO - Starting hyperparameter optimization
2025-03-28 15:20:25,645 - INFO - Starting trial 0
2025-03-28 15:20:25,650 - INFO - Hyperparameters: d_model=4, num_heads=2, lstm_units=6, num_layers=1, dropout_rate=0.15, l2_lambda=0.000161
2025-03-28 15:20:25,650 - INFO - Building model...
2025-03-28 15:20:27,221 - INFO - Batch size: 1
2025-03-28 15:20:27,222 - INFO - Starting model training...
2025-03-28 15:20:27,239 - INFO - Sample batch from train_dataset - Inputs shape: (1, 3, 57), Targets shape: (1, 3)
2025-03-28 15:20:27,251 - INFO - Sample batch from test_dataset - Inputs shape: (1, 3, 57), Targets shape: (1, 3)
2025-03-28 15:20:39,997 - WARNING - Trial 0 failed
2025-03-28 15:20:39,998 - ERROR - No trials completed successfully. Check dataset or model configuration.
2025-03-28 15:20:39,998 - ERROR - Error in main execution: No trials completed successfully.
2025-03-28 15:25:29,652 - INFO - Num GPUs Available: 1
2025-03-28 15:25:29,657 - INFO - Running with Metal GPU acceleration
2025-03-28 15:25:29,801 - INFO - All data files found. Proceeding with processing.
2025-03-28 15:25:29,802 - INFO - Processing new data with step_size=1
2025-03-28 15:25:29,802 - INFO - Loading data files...
2025-03-28 15:25:29,909 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 15:25:29,910 - INFO - df_yields['Year'] dtype: int64
2025-03-28 15:25:29,910 - INFO - df_sales['Year'] dtype: int64
2025-03-28 15:25:29,910 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 15:25:29,910 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 15:25:29,910 - INFO - df_economic['Year'] dtype: int64
2025-03-28 15:25:29,910 - INFO - df_population['Year'] dtype: int64
2025-03-28 15:25:29,928 - INFO - Merging datasets...
2025-03-28 15:25:29,945 - INFO - Shape after merging: (313, 58)
2025-03-28 15:25:29,945 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 15:25:29,950 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 15:25:29,994 - INFO - Feature columns after filling NaNs: 54
2025-03-28 15:25:30,025 - INFO - NaN count in features: 313
2025-03-28 15:25:30,047 - INFO - Feature min/max: -27825.0/8231613070.0
2025-03-28 15:25:30,047 - INFO - Skipping outlier removal to prevent empty DataFrame. Shape remains: (313, 58)
2025-03-28 15:25:30,051 - INFO - price_data shape: (313, 3), features shape: (313, 54)
2025-03-28 15:25:30,865 - INFO - Train dataset size: 234
2025-03-28 15:25:30,865 - INFO - Test dataset size: 79
2025-03-28 15:25:30,865 - INFO - Preprocessed data with step_size=1, train_size=234, test_size=79, n_features=57
2025-03-28 15:25:30,867 - INFO - Starting hyperparameter optimization
2025-03-28 15:25:30,872 - INFO - Starting trial 0
2025-03-28 15:25:30,879 - INFO - Hyperparameters: d_model=2, num_heads=2, lstm_units=2, num_layers=1, dropout_rate=0.10, l2_lambda=0.000786
2025-03-28 15:25:30,879 - INFO - Building model...
2025-03-28 15:25:31,932 - INFO - Batch size: 1
2025-03-28 15:25:31,933 - INFO - Starting model training...
2025-03-28 15:25:31,944 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 15:25:31,993 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 15:25:43,244 - WARNING - Trial 0 failed
2025-03-28 15:25:43,247 - ERROR - No trials completed successfully. Check dataset or model configuration.
2025-03-28 15:25:43,247 - ERROR - Error in main execution: No trials completed successfully.
2025-03-28 15:33:21,093 - INFO - Num GPUs Available: 1
2025-03-28 15:33:21,095 - INFO - Running with Metal GPU acceleration
2025-03-28 15:33:21,209 - INFO - All data files found. Proceeding with processing.
2025-03-28 15:33:21,209 - INFO - Processing new data with step_size=1
2025-03-28 15:33:21,209 - INFO - Loading data files...
2025-03-28 15:33:21,366 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 15:33:21,366 - INFO - df_yields['Year'] dtype: int64
2025-03-28 15:33:21,366 - INFO - df_sales['Year'] dtype: int64
2025-03-28 15:33:21,367 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 15:33:21,367 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 15:33:21,367 - INFO - df_economic['Year'] dtype: int64
2025-03-28 15:33:21,367 - INFO - df_population['Year'] dtype: int64
2025-03-28 15:33:21,378 - INFO - Merging datasets...
2025-03-28 15:33:21,412 - INFO - Shape after merging: (313, 58)
2025-03-28 15:33:21,412 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 15:33:21,413 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 15:33:21,421 - INFO - Feature columns after filling NaNs: 54
2025-03-28 15:33:21,422 - INFO - NaN count in features: 313
2025-03-28 15:33:21,426 - INFO - Feature min/max: -27825.0/8231613070.0
2025-03-28 15:33:21,426 - INFO - Skipping outlier removal to prevent empty DataFrame. Shape remains: (313, 58)
2025-03-28 15:33:21,426 - INFO - price_data shape: (313, 3), features shape: (313, 54)
2025-03-28 15:33:22,002 - INFO - Train dataset size: 234
2025-03-28 15:33:22,002 - INFO - Test dataset size: 79
2025-03-28 15:33:22,002 - INFO - Preprocessed data with step_size=1, train_size=234, test_size=79, n_features=57
2025-03-28 15:33:22,006 - INFO - Starting hyperparameter optimization
2025-03-28 15:33:22,013 - INFO - Starting trial 0
2025-03-28 15:33:22,034 - INFO - Hyperparameters: d_model=4, num_heads=1, lstm_units=4, num_layers=2, dropout_rate=0.18, l2_lambda=0.000018
2025-03-28 15:33:22,035 - INFO - Building model...
2025-03-28 15:33:23,069 - INFO - Batch size: 1
2025-03-28 15:33:23,070 - INFO - Starting model training...
2025-03-28 15:33:23,083 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 15:33:23,094 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 15:33:39,499 - WARNING - Trial 0 failed
2025-03-28 15:33:39,501 - WARNING - No trials completed successfully. Using default parameters to train the model.
2025-03-28 15:33:39,501 - INFO - Default parameters: {'d_model': 4, 'num_heads': 1, 'lstm_units': 4, 'num_layers': 1, 'dropout_rate': 0.1, 'l2_lambda': 1e-05, 'learning_rate': 0.001, 'batch_size': 1}
2025-03-28 15:33:39,602 - INFO - Training final model with default/best parameters
2025-03-28 15:34:03,609 - INFO - Training completed
2025-03-28 15:34:03,648 - INFO - Test data shape for prediction: (79, 1, 57)
2025-03-28 15:34:05,031 - ERROR - Error in main execution: Input contains NaN.
2025-03-28 15:38:44,164 - INFO - Num GPUs Available: 1
2025-03-28 15:38:44,165 - INFO - Running with Metal GPU acceleration
2025-03-28 15:38:44,189 - INFO - All data files found. Proceeding with processing.
2025-03-28 15:38:44,189 - INFO - Processing new data with step_size=1
2025-03-28 15:38:44,192 - INFO - Loading data files...
2025-03-28 15:38:44,395 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 15:38:44,396 - INFO - df_yields['Year'] dtype: int64
2025-03-28 15:38:44,396 - INFO - df_sales['Year'] dtype: int64
2025-03-28 15:38:44,396 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 15:38:44,396 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 15:38:44,396 - INFO - df_economic['Year'] dtype: int64
2025-03-28 15:38:44,396 - INFO - df_population['Year'] dtype: int64
2025-03-28 15:38:44,414 - INFO - Merging datasets...
2025-03-28 15:38:44,434 - INFO - Shape after merging: (313, 58)
2025-03-28 15:38:44,434 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 15:38:44,436 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 15:38:44,478 - INFO - Feature columns after filling NaNs: 54
2025-03-28 15:38:44,492 - INFO - NaN count in features: 313
2025-03-28 15:38:44,501 - INFO - Feature min/max: -27825.0/8231613070.0
2025-03-28 15:38:44,501 - INFO - Skipping outlier removal to prevent empty DataFrame. Shape remains: (313, 58)
2025-03-28 15:38:44,502 - INFO - price_data shape: (313, 3), features shape: (313, 54)
2025-03-28 15:38:45,774 - INFO - Train dataset size: 234
2025-03-28 15:38:45,774 - INFO - Test dataset size: 79
2025-03-28 15:38:45,774 - INFO - Preprocessed data with step_size=1, train_size=234, test_size=79, n_features=57
2025-03-28 15:38:45,781 - INFO - Starting hyperparameter optimization
2025-03-28 15:38:45,786 - INFO - Starting trial 0
2025-03-28 15:38:45,793 - INFO - Hyperparameters: d_model=2, num_heads=2, lstm_units=4, num_layers=2, dropout_rate=0.10, l2_lambda=0.000027
2025-03-28 15:38:45,793 - INFO - Building model...
2025-03-28 15:38:46,884 - INFO - Batch size: 1
2025-03-28 15:38:46,884 - INFO - Starting model training...
2025-03-28 15:38:46,939 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 15:38:46,961 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 15:39:03,851 - WARNING - Trial 0 failed
2025-03-28 15:39:03,854 - WARNING - No trials completed successfully. Using default parameters to train the model.
2025-03-28 15:39:03,855 - INFO - Default parameters: {'d_model': 4, 'num_heads': 1, 'lstm_units': 4, 'num_layers': 1, 'dropout_rate': 0.1, 'l2_lambda': 1e-05, 'learning_rate': 0.001, 'batch_size': 1}
2025-03-28 15:39:03,969 - INFO - Training final model with default/best parameters
2025-03-28 15:39:27,229 - INFO - Training completed
2025-03-28 15:39:27,258 - INFO - Test data shape for prediction: (79, 1, 57)
2025-03-28 15:39:27,814 - WARNING - test_pred contains NaN values. Replacing NaN with 0.
2025-03-28 15:39:27,845 - INFO - Hong Kong - RMSE: 427032.63 HKD/m², MAE: 404392.59 HKD/m², MAPE: 84.73%, R²: -8.6877
2025-03-28 15:39:27,845 - INFO - Kowloon - RMSE: 298552.28 HKD/m², MAE: 286435.91 HKD/m², MAPE: 77.17%, R²: -11.5754
2025-03-28 15:39:27,846 - INFO - New Territories - RMSE: 318065.35 HKD/m², MAE: 305277.72 HKD/m², MAPE: 82.28%, R²: -11.6916
2025-03-28 15:39:27,849 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-03-28 15:39:27,975 - INFO - Saved model with step_size=1
2025-03-28 15:39:27,977 - ERROR - Feature mismatch: last_sequence has 3 features, expected 57
2025-03-28 15:39:39,878 - ERROR - Error in main execution: non-broadcastable output operand with shape (313,1) doesn't match the broadcast shape (313,3)
2025-03-28 15:44:05,566 - INFO - Num GPUs Available: 1
2025-03-28 15:44:05,567 - INFO - Running with Metal GPU acceleration
2025-03-28 15:44:05,607 - INFO - All data files found. Proceeding with processing.
2025-03-28 15:44:05,607 - INFO - Processing new data with step_size=1
2025-03-28 15:44:05,607 - INFO - Loading data files...
2025-03-28 15:44:05,717 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 15:44:05,717 - INFO - df_yields['Year'] dtype: int64
2025-03-28 15:44:05,717 - INFO - df_sales['Year'] dtype: int64
2025-03-28 15:44:05,717 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 15:44:05,717 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 15:44:05,717 - INFO - df_economic['Year'] dtype: int64
2025-03-28 15:44:05,717 - INFO - df_population['Year'] dtype: int64
2025-03-28 15:44:05,729 - INFO - Merging datasets...
2025-03-28 15:44:05,750 - INFO - Shape after merging: (313, 58)
2025-03-28 15:44:05,750 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 15:44:05,756 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 15:44:05,781 - INFO - Feature columns after filling NaNs: 54
2025-03-28 15:44:05,788 - INFO - NaN count in features: 313
2025-03-28 15:44:05,800 - INFO - Feature min/max: -27825.0/8231613070.0
2025-03-28 15:44:05,800 - INFO - Skipping outlier removal to prevent empty DataFrame. Shape remains: (313, 58)
2025-03-28 15:44:05,806 - INFO - price_data shape: (313, 3), features shape: (313, 54)
2025-03-28 15:44:06,509 - INFO - Train dataset size: 234
2025-03-28 15:44:06,510 - INFO - Test dataset size: 79
2025-03-28 15:44:06,510 - INFO - Preprocessed data with step_size=1, train_size=234, test_size=79, n_features=57
2025-03-28 15:44:06,710 - INFO - Starting hyperparameter optimization
2025-03-28 15:44:06,715 - INFO - Starting trial 0
2025-03-28 15:44:06,727 - INFO - Hyperparameters: d_model=2, num_heads=2, lstm_units=3, num_layers=1, dropout_rate=0.15, l2_lambda=0.000011
2025-03-28 15:44:06,728 - INFO - Building model...
2025-03-28 15:44:08,341 - INFO - Batch size: 1
2025-03-28 15:44:08,342 - INFO - Starting model training...
2025-03-28 15:44:08,371 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 15:44:08,393 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 15:44:24,319 - WARNING - Trial 0 failed
2025-03-28 15:44:24,322 - WARNING - No trials completed successfully. Using default parameters to train the model.
2025-03-28 15:44:24,322 - INFO - Default parameters: {'d_model': 4, 'num_heads': 1, 'lstm_units': 4, 'num_layers': 1, 'dropout_rate': 0.1, 'l2_lambda': 1e-05, 'learning_rate': 0.001, 'batch_size': 1}
2025-03-28 15:44:24,453 - INFO - Training final model with default/best parameters
2025-03-28 15:44:49,061 - INFO - Training completed
2025-03-28 15:44:49,110 - INFO - Test data shape for prediction: (79, 1, 57)
2025-03-28 15:44:49,646 - WARNING - test_pred contains NaN values. Replacing NaN with 0.
2025-03-28 15:44:49,678 - INFO - Hong Kong - RMSE: 427032.63 HKD/m², MAE: 404392.59 HKD/m², MAPE: 84.73%, R²: -8.6877
2025-03-28 15:44:49,679 - INFO - Kowloon - RMSE: 298552.28 HKD/m², MAE: 286435.91 HKD/m², MAPE: 77.17%, R²: -11.5754
2025-03-28 15:44:49,680 - INFO - New Territories - RMSE: 318065.35 HKD/m², MAE: 305277.72 HKD/m², MAPE: 82.28%, R²: -11.6916
2025-03-28 15:44:49,681 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-03-28 15:44:49,767 - INFO - Saved model with step_size=1
2025-03-28 15:44:49,768 - ERROR - Feature mismatch: last_sequence has 3 features, expected 57
2025-03-28 15:45:01,331 - ERROR - Error in main execution: 'Predicted Price Ho'
2025-03-28 15:49:42,879 - INFO - Num GPUs Available: 1
2025-03-28 15:49:42,882 - INFO - Running with Metal GPU acceleration
2025-03-28 15:49:42,893 - INFO - All data files found. Proceeding with processing.
2025-03-28 15:49:42,893 - INFO - Processing new data with step_size=1
2025-03-28 15:49:42,893 - INFO - Loading data files...
2025-03-28 15:49:43,015 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 15:49:43,015 - INFO - df_yields['Year'] dtype: int64
2025-03-28 15:49:43,015 - INFO - df_sales['Year'] dtype: int64
2025-03-28 15:49:43,015 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 15:49:43,015 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 15:49:43,015 - INFO - df_economic['Year'] dtype: int64
2025-03-28 15:49:43,015 - INFO - df_population['Year'] dtype: int64
2025-03-28 15:49:43,028 - INFO - Merging datasets...
2025-03-28 15:49:43,061 - INFO - Shape after merging: (313, 58)
2025-03-28 15:49:43,062 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 15:49:43,065 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 15:49:43,094 - INFO - Feature columns after filling NaNs: 54
2025-03-28 15:49:43,108 - INFO - NaN count in features: 313
2025-03-28 15:49:43,115 - INFO - Feature min/max: -27825.0/8231613070.0
2025-03-28 15:49:43,115 - INFO - Skipping outlier removal to prevent empty DataFrame. Shape remains: (313, 58)
2025-03-28 15:49:43,117 - INFO - price_data shape: (313, 3), features shape: (313, 54)
2025-03-28 15:49:44,093 - INFO - Train dataset size: 234
2025-03-28 15:49:44,093 - INFO - Test dataset size: 79
2025-03-28 15:49:44,093 - INFO - Preprocessed data with step_size=1, train_size=234, test_size=79, n_features=57
2025-03-28 15:49:44,369 - INFO - Starting hyperparameter optimization
2025-03-28 15:49:44,376 - INFO - Starting trial 0
2025-03-28 15:49:44,388 - INFO - Hyperparameters: d_model=2, num_heads=1, lstm_units=4, num_layers=1, dropout_rate=0.14, l2_lambda=0.000082
2025-03-28 15:49:44,388 - INFO - Building model...
2025-03-28 15:49:45,888 - INFO - Batch size: 1
2025-03-28 15:49:45,889 - INFO - Starting model training...
2025-03-28 15:49:45,914 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 15:49:45,934 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 15:49:57,196 - WARNING - Trial 0 failed
2025-03-28 15:49:57,197 - WARNING - No trials completed successfully. Using default parameters to train the model.
2025-03-28 15:49:57,198 - INFO - Default parameters: {'d_model': 4, 'num_heads': 1, 'lstm_units': 4, 'num_layers': 1, 'dropout_rate': 0.1, 'l2_lambda': 1e-05, 'learning_rate': 0.001, 'batch_size': 1}
2025-03-28 15:49:57,318 - INFO - Training final model with default/best parameters
2025-03-28 15:50:21,963 - INFO - Training completed
2025-03-28 15:50:21,996 - INFO - Test data shape for prediction: (79, 1, 57)
2025-03-28 15:50:22,586 - WARNING - test_pred contains NaN values. Replacing NaN with 0.
2025-03-28 15:50:22,613 - INFO - Hong Kong - RMSE: 427032.63 HKD/m², MAE: 404392.59 HKD/m², MAPE: 84.73%, R²: -8.6877
2025-03-28 15:50:22,614 - INFO - Kowloon - RMSE: 298552.28 HKD/m², MAE: 286435.91 HKD/m², MAPE: 77.17%, R²: -11.5754
2025-03-28 15:50:22,615 - INFO - New Territories - RMSE: 318065.35 HKD/m², MAE: 305277.72 HKD/m², MAPE: 82.28%, R²: -11.6916
2025-03-28 15:50:22,616 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-03-28 15:50:22,720 - INFO - Saved model with step_size=1
2025-03-28 15:50:22,722 - ERROR - Feature mismatch: last_sequence has 3 features, expected 57
2025-03-28 15:50:35,714 - ERROR - Error in main execution: 'Price_Hong Kong'
2025-03-28 15:57:05,838 - INFO - Num GPUs Available: 1
2025-03-28 15:57:05,840 - INFO - Running with Metal GPU acceleration
2025-03-28 15:57:05,891 - INFO - All data files found. Proceeding with processing.
2025-03-28 15:57:05,892 - INFO - Processing new data with step_size=1
2025-03-28 15:57:05,892 - INFO - Loading data files...
2025-03-28 15:57:06,047 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 15:57:06,048 - INFO - df_yields['Year'] dtype: int64
2025-03-28 15:57:06,048 - INFO - df_sales['Year'] dtype: int64
2025-03-28 15:57:06,048 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 15:57:06,048 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 15:57:06,048 - INFO - df_economic['Year'] dtype: int64
2025-03-28 15:57:06,048 - INFO - df_population['Year'] dtype: int64
2025-03-28 15:57:06,066 - INFO - Merging datasets...
2025-03-28 15:57:06,108 - INFO - Shape after merging: (313, 58)
2025-03-28 15:57:06,108 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 15:57:06,118 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 15:57:06,118 - INFO - Target columns: ['Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-28 15:57:06,195 - INFO - Feature columns after filling NaNs: 54
2025-03-28 15:57:06,217 - INFO - NaN count in features: 313
2025-03-28 15:57:06,233 - INFO - Feature min/max: -27825.0/8231613070.0
2025-03-28 15:57:06,234 - INFO - Skipping outlier removal to prevent empty DataFrame. Shape remains: (313, 58)
2025-03-28 15:57:06,235 - INFO - price_data shape: (313, 3), features shape: (313, 54)
2025-03-28 15:57:07,207 - INFO - Train dataset size: 234
2025-03-28 15:57:07,208 - INFO - Test dataset size: 79
2025-03-28 15:57:07,208 - INFO - Preprocessed data with step_size=1, train_size=234, test_size=79, n_features=57
2025-03-28 15:57:07,460 - INFO - Starting hyperparameter optimization
2025-03-28 15:57:07,464 - INFO - Starting trial 0
2025-03-28 15:57:07,471 - INFO - Hyperparameters: d_model=4, num_heads=1, lstm_units=3, num_layers=2, dropout_rate=0.17, l2_lambda=0.000641
2025-03-28 15:57:07,471 - INFO - Building model...
2025-03-28 15:57:08,881 - INFO - Batch size: 1
2025-03-28 15:57:08,882 - INFO - Starting model training...
2025-03-28 15:57:08,912 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 15:57:08,937 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 15:57:27,189 - WARNING - Trial 0 failed
2025-03-28 15:57:27,190 - WARNING - No trials completed successfully. Using default parameters to train the model.
2025-03-28 15:57:27,190 - INFO - Default parameters: {'d_model': 4, 'num_heads': 1, 'lstm_units': 4, 'num_layers': 1, 'dropout_rate': 0.1, 'l2_lambda': 1e-05, 'learning_rate': 0.001, 'batch_size': 1}
2025-03-28 15:57:27,337 - INFO - Training final model with default/best parameters
2025-03-28 15:57:52,854 - INFO - Training completed
2025-03-28 15:57:52,902 - INFO - Test data shape for prediction: (79, 1, 57)
2025-03-28 15:57:53,445 - WARNING - test_pred contains NaN values. Replacing NaN with 0.
2025-03-28 15:57:53,472 - INFO - Hong Kong - RMSE: 427032.63 HKD/m², MAE: 404392.59 HKD/m², MAPE: 84.73%, R²: -8.6877
2025-03-28 15:57:53,473 - INFO - Kowloon - RMSE: 298552.28 HKD/m², MAE: 286435.91 HKD/m², MAPE: 77.17%, R²: -11.5754
2025-03-28 15:57:53,473 - INFO - New Territories - RMSE: 318065.35 HKD/m², MAE: 305277.72 HKD/m², MAPE: 82.28%, R²: -11.6916
2025-03-28 15:57:53,475 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-03-28 15:57:53,569 - INFO - Saved model with step_size=1
2025-03-28 15:57:53,570 - ERROR - Feature mismatch: last_sequence has 3 features, expected 57
2025-03-28 15:58:05,317 - INFO - dataset columns: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 15:58:05,320 - INFO - future_df columns: ['Date', 'Predicted Price HK', 'Lower Bound HK (95%)', 'Upper Bound HK (95%)', 'Predicted Price KL', 'Lower Bound KL (95%)', 'Upper Bound KL (95%)', 'Predicted Price NT', 'Lower Bound NT (95%)', 'Upper Bound NT (95%)']
2025-03-28 15:58:06,880 - INFO - 
=== Detailed Results ===
2025-03-28 15:58:06,880 - INFO - Test Set Performance:
2025-03-28 15:58:06,881 - INFO - Hong Kong - RMSE: 427032.63 HKD/m², MAE: 404392.59 HKD/m², MAPE: 84.73%, R²: -8.6877
2025-03-28 15:58:06,883 - INFO - Kowloon - RMSE: 298552.28 HKD/m², MAE: 286435.91 HKD/m², MAPE: 77.17%, R²: -11.5754
2025-03-28 15:58:06,889 - INFO - New Territories - RMSE: 318065.35 HKD/m², MAE: 305277.72 HKD/m², MAPE: 82.28%, R²: -11.6916
2025-03-28 15:58:06,889 - INFO - 
Future Predictions (First 12 Months):
2025-03-28 16:02:15,232 - INFO - Num GPUs Available: 1
2025-03-28 16:02:15,235 - INFO - Running with Metal GPU acceleration
2025-03-28 16:02:15,373 - INFO - All data files found. Proceeding with processing.
2025-03-28 16:02:15,373 - INFO - Processing new data with step_size=1
2025-03-28 16:02:15,373 - INFO - Loading data files...
2025-03-28 16:02:15,577 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 16:02:15,577 - INFO - df_yields['Year'] dtype: int64
2025-03-28 16:02:15,577 - INFO - df_sales['Year'] dtype: int64
2025-03-28 16:02:15,577 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 16:02:15,577 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 16:02:15,577 - INFO - df_economic['Year'] dtype: int64
2025-03-28 16:02:15,577 - INFO - df_population['Year'] dtype: int64
2025-03-28 16:02:15,612 - INFO - Merging datasets...
2025-03-28 16:02:15,635 - INFO - Shape after merging: (313, 58)
2025-03-28 16:02:15,635 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 16:02:15,638 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 16:02:15,638 - INFO - Target columns: ['Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-28 16:02:15,699 - INFO - Feature columns after filling NaNs: 54
2025-03-28 16:02:15,712 - INFO - NaN count in features: 313
2025-03-28 16:02:15,720 - INFO - Feature min/max: -27825.0/8231613070.0
2025-03-28 16:02:15,720 - INFO - Skipping outlier removal to prevent empty DataFrame. Shape remains: (313, 58)
2025-03-28 16:02:15,723 - INFO - price_data shape: (313, 3), features shape: (313, 54)
2025-03-28 16:02:16,622 - INFO - Train dataset size: 234
2025-03-28 16:02:16,622 - INFO - Test dataset size: 79
2025-03-28 16:02:16,622 - INFO - Preprocessed data with step_size=1, train_size=234, test_size=79, n_features=57
2025-03-28 16:02:16,866 - INFO - Starting hyperparameter optimization
2025-03-28 16:02:16,870 - INFO - Starting trial 0
2025-03-28 16:02:16,880 - INFO - Hyperparameters: d_model=2, num_heads=1, lstm_units=3, num_layers=2, dropout_rate=0.18, l2_lambda=0.000117
2025-03-28 16:02:16,880 - INFO - Building model...
2025-03-28 16:02:18,210 - INFO - Batch size: 1
2025-03-28 16:02:18,211 - INFO - Starting model training...
2025-03-28 16:02:18,271 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 16:02:18,290 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 57), Targets shape: (1, 3)
2025-03-28 16:02:39,654 - WARNING - Trial 0 failed
2025-03-28 16:02:39,656 - WARNING - No trials completed successfully. Using default parameters to train the model.
2025-03-28 16:02:39,656 - INFO - Default parameters: {'d_model': 4, 'num_heads': 1, 'lstm_units': 4, 'num_layers': 1, 'dropout_rate': 0.1, 'l2_lambda': 1e-05, 'learning_rate': 0.001, 'batch_size': 1}
2025-03-28 16:02:39,786 - INFO - Training final model with default/best parameters
2025-03-28 16:03:05,036 - INFO - Training completed
2025-03-28 16:03:05,066 - INFO - Test data shape for prediction: (79, 1, 57)
2025-03-28 16:03:05,680 - WARNING - test_pred contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:05,715 - INFO - Hong Kong - RMSE: 427032.63 HKD/m², MAE: 404392.59 HKD/m², MAPE: 84.73%, R²: -8.6877
2025-03-28 16:03:05,715 - INFO - Kowloon - RMSE: 298552.28 HKD/m², MAE: 286435.91 HKD/m², MAPE: 77.17%, R²: -11.5754
2025-03-28 16:03:05,716 - INFO - New Territories - RMSE: 318065.35 HKD/m², MAE: 305277.72 HKD/m², MAPE: 82.28%, R²: -11.6916
2025-03-28 16:03:05,717 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-03-28 16:03:05,809 - INFO - Saved model with step_size=1
2025-03-28 16:03:05,810 - ERROR - Feature mismatch: last_sequence has 3 features, expected 57
2025-03-28 16:03:05,814 - INFO - Historical volatility: [0. 0. 0.]
2025-03-28 16:03:05,966 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,008 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,062 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,128 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,192 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,228 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,283 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,348 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,402 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,448 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,496 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,535 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,572 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,613 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,653 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,689 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,744 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,779 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,816 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,863 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,906 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,951 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:06,990 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,033 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,069 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,105 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,140 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,183 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,223 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,260 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,296 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,331 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,365 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,400 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,437 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,473 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,510 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,545 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,581 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,617 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,650 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,685 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,721 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,755 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,787 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,821 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,856 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,891 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,923 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,955 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:07,987 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,020 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,051 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,082 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,115 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,147 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,179 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,211 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,244 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,276 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,308 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,340 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,373 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,406 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,437 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,469 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,501 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,533 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,564 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,596 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,628 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,660 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,699 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,739 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,776 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,810 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,845 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,883 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,921 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,955 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:08,990 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,025 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,064 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,097 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,129 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,161 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,193 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,224 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,256 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,289 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,322 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,356 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,389 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,420 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,453 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,484 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,516 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,548 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,581 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,614 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,646 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,678 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,713 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,744 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,776 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,808 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,844 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,877 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,909 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,940 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:09,971 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,002 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,033 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,064 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,095 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,126 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,157 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,188 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,222 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,254 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,285 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,318 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,349 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,381 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,413 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,443 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,474 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,506 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,538 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,568 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,601 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,633 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,664 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,696 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,728 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,759 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,790 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,821 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,853 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,885 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,916 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,947 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:10,980 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,011 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,046 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,078 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,112 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,143 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,174 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,207 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,239 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,270 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,300 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,332 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,366 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,396 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,427 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,457 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,488 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,520 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,550 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,581 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,612 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,642 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,672 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,703 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,735 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,767 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,798 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,830 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,862 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,894 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,924 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,955 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:11,986 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,018 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,050 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,081 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,113 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,143 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,174 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,205 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,236 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,267 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,298 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,329 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,361 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,392 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,422 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,454 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,486 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,518 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,548 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,580 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,612 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,643 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,673 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,705 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,735 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,766 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,796 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,826 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,858 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,888 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,919 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,951 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:12,981 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,012 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,042 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,073 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,103 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,134 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,165 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,195 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,229 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,260 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,294 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,330 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,364 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,394 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,424 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,456 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,486 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,518 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,549 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,580 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,612 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,643 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,675 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,706 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,737 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,769 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,800 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,830 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,863 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,894 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,924 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,954 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:13,986 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,017 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,049 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,080 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,111 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,142 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,172 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,203 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,234 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,266 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,297 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,329 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,362 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,393 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,424 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,455 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,487 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,517 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,547 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,578 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,608 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,640 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,671 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,702 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,735 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,766 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,798 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,828 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,859 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,897 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,945 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:14,981 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,012 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,043 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,075 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,106 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,140 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,172 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,204 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,236 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,269 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,302 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,335 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,367 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,399 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,431 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,462 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,493 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,526 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,557 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,595 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,633 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,665 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,696 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,726 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,759 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,791 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,823 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,855 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,886 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,920 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,952 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:15,984 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,015 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,046 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,079 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,110 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,142 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,173 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,205 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,237 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,269 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,303 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,334 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,366 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,397 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,429 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,460 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,493 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,525 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,557 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,589 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,621 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,652 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,686 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,718 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,750 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,782 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,813 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,847 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,879 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,909 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,941 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:16,973 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,004 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,035 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,069 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,101 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,131 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,163 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,195 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,226 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,257 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,289 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,321 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,352 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,382 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,414 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,448 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,481 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,513 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,544 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,574 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,606 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,637 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,668 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,700 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,730 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,761 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,791 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,825 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,856 - WARNING - Prediction contains NaN values. Replacing NaN with 0.
2025-03-28 16:03:17,860 - INFO - mc_predictions shape: (5, 72, 3)
2025-03-28 16:03:17,881 - INFO - future_df shape: (72, 10)
2025-03-28 16:03:17,893 - INFO - future_df head:
        Date  Predicted Price HK  Lower Bound HK (95%)  Upper Bound HK (95%)  \
0 2025-02-01             65409.0             -62792.64             193610.64   
1 2025-03-01             65409.0             -62792.64             193610.64   
2 2025-04-01             65409.0             -62792.64             193610.64   
3 2025-05-01             65409.0             -62792.64             193610.64   
4 2025-06-01             65409.0             -62792.64             193610.64   

   Predicted Price KL  Lower Bound KL (95%)  Upper Bound KL (95%)  \
0             79192.0             -76024.32             234408.32   
1             79192.0             -76024.32             234408.32   
2             79192.0             -76024.32             234408.32   
3             79192.0             -76024.32             234408.32   
4             79192.0             -76024.32             234408.32   

   Predicted Price NT  Lower Bound NT (95%)  Upper Bound NT (95%)  
0             61105.0              -58660.8              180870.8  
1             61105.0              -58660.8              180870.8  
2             61105.0              -58660.8              180870.8  
3             61105.0              -58660.8              180870.8  
4             61105.0              -58660.8              180870.8  
2025-03-28 16:03:17,905 - INFO - Saved future predictions to /Users/mastin/project_folder/predicted_prices_2025_2030.csv
2025-03-28 16:03:17,907 - INFO - dataset columns: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 16:03:17,907 - INFO - future_df columns: ['Date', 'Predicted Price HK', 'Lower Bound HK (95%)', 'Upper Bound HK (95%)', 'Predicted Price KL', 'Lower Bound KL (95%)', 'Upper Bound KL (95%)', 'Predicted Price NT', 'Lower Bound NT (95%)', 'Upper Bound NT (95%)']
2025-03-28 16:03:19,513 - INFO - 
=== Detailed Results ===
2025-03-28 16:03:19,513 - INFO - Test Set Performance:
2025-03-28 16:03:19,516 - INFO - Hong Kong - RMSE: 427032.63 HKD/m², MAE: 404392.59 HKD/m², MAPE: 84.73%, R²: -8.6877
2025-03-28 16:03:19,516 - INFO - Kowloon - RMSE: 298552.28 HKD/m², MAE: 286435.91 HKD/m², MAPE: 77.17%, R²: -11.5754
2025-03-28 16:03:19,517 - INFO - New Territories - RMSE: 318065.35 HKD/m², MAE: 305277.72 HKD/m², MAPE: 82.28%, R²: -11.6916
2025-03-28 16:03:19,517 - INFO - 
Future Predictions (First 12 Months):
2025-03-28 16:11:29,145 - INFO - All data files found. Proceeding with processing.
2025-03-28 16:11:29,154 - INFO - Processing new data with step_size=1
2025-03-28 16:11:29,154 - INFO - Loading data files...
2025-03-28 16:11:29,376 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 16:11:29,377 - INFO - df_yields['Year'] dtype: int64
2025-03-28 16:11:29,377 - INFO - df_sales['Year'] dtype: int64
2025-03-28 16:11:29,377 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 16:11:29,377 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 16:11:29,377 - INFO - df_economic['Year'] dtype: int64
2025-03-28 16:11:29,377 - INFO - df_population['Year'] dtype: int64
2025-03-28 16:11:29,407 - INFO - Merging datasets...
2025-03-28 16:11:29,451 - INFO - Shape after merging: (313, 58)
2025-03-28 16:11:29,451 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 16:11:29,453 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 16:11:29,454 - INFO - Target columns: ['Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-28 16:11:29,469 - INFO - Selected features (correlation > 0.3): ['Year', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Unemployment_Rate', 'Real_Interest_Rate', 'Population', 'Median Age', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 16:11:29,540 - INFO - Feature columns after filling NaNs: 45
2025-03-28 16:11:29,555 - INFO - NaN count in features: 0
2025-03-28 16:11:29,564 - INFO - Feature min/max: 0.09/8231613070.0
2025-03-28 16:11:29,596 - INFO - Outliers clipped using IQR method
2025-03-28 16:11:29,600 - INFO - price_data shape: (313, 3), features shape: (313, 45)
2025-03-28 16:11:30,669 - INFO - Train dataset size: 234
2025-03-28 16:11:30,669 - INFO - Test dataset size: 79
2025-03-28 16:11:30,669 - INFO - Preprocessed data with step_size=1, train_size=234, test_size=79, n_features=48
2025-03-28 16:11:30,929 - INFO - Starting hyperparameter optimization
2025-03-28 16:11:30,934 - INFO - Starting trial 0
2025-03-28 16:11:30,939 - INFO - Hyperparameters: d_model=8, num_heads=2, lstm_units=48, num_layers=3, dropout_rate=0.35, l2_lambda=0.000110
2025-03-28 16:11:30,939 - INFO - Building model...
2025-03-28 16:11:33,374 - INFO - Batch size: 1
2025-03-28 16:11:33,374 - INFO - Starting model training...
2025-03-28 16:11:33,398 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:11:33,416 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:13:24,108 - INFO - Completed trial 0 with value: 0.077207
2025-03-28 16:13:24,110 - INFO - Starting trial 1
2025-03-28 16:13:24,115 - INFO - Hyperparameters: d_model=16, num_heads=4, lstm_units=29, num_layers=2, dropout_rate=0.34, l2_lambda=0.000584
2025-03-28 16:13:24,115 - INFO - Building model...
2025-03-28 16:13:24,769 - INFO - Batch size: 1
2025-03-28 16:13:24,769 - INFO - Starting model training...
2025-03-28 16:13:24,799 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:13:24,814 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:14:31,946 - INFO - Completed trial 1 with value: 0.110616
2025-03-28 16:14:31,947 - INFO - Starting trial 2
2025-03-28 16:14:31,949 - INFO - Hyperparameters: d_model=32, num_heads=4, lstm_units=41, num_layers=4, dropout_rate=0.29, l2_lambda=0.001703
2025-03-28 16:14:31,949 - INFO - Building model...
2025-03-28 16:14:32,565 - INFO - Batch size: 1
2025-03-28 16:14:32,565 - INFO - Starting model training...
2025-03-28 16:14:32,585 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:14:32,595 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:17:02,217 - INFO - Completed trial 2 with value: 0.235400
2025-03-28 16:17:02,218 - INFO - Starting trial 3
2025-03-28 16:17:02,223 - INFO - Hyperparameters: d_model=8, num_heads=2, lstm_units=45, num_layers=2, dropout_rate=0.26, l2_lambda=0.004873
2025-03-28 16:17:02,223 - INFO - Building model...
2025-03-28 16:17:02,768 - INFO - Batch size: 1
2025-03-28 16:17:02,768 - INFO - Starting model training...
2025-03-28 16:17:02,791 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:17:02,806 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:18:17,267 - INFO - Completed trial 3 with value: 1.908099
2025-03-28 16:18:17,270 - INFO - Starting trial 4
2025-03-28 16:18:17,279 - INFO - Hyperparameters: d_model=32, num_heads=2, lstm_units=16, num_layers=4, dropout_rate=0.30, l2_lambda=0.000243
2025-03-28 16:18:17,279 - INFO - Building model...
2025-03-28 16:18:17,720 - INFO - Batch size: 1
2025-03-28 16:18:17,720 - INFO - Starting model training...
2025-03-28 16:18:17,746 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:18:17,757 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:22:16,648 - INFO - Completed trial 4 with value: 0.065453
2025-03-28 16:22:16,651 - INFO - Starting trial 5
2025-03-28 16:22:16,663 - INFO - Hyperparameters: d_model=8, num_heads=4, lstm_units=41, num_layers=2, dropout_rate=0.33, l2_lambda=0.003007
2025-03-28 16:22:16,663 - INFO - Building model...
2025-03-28 16:22:17,438 - INFO - Batch size: 1
2025-03-28 16:22:17,439 - INFO - Starting model training...
2025-03-28 16:22:17,481 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:22:17,505 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:23:26,450 - INFO - Completed trial 5 with value: 0.528630
2025-03-28 16:23:26,451 - INFO - Starting trial 6
2025-03-28 16:23:26,453 - INFO - Hyperparameters: d_model=32, num_heads=4, lstm_units=61, num_layers=2, dropout_rate=0.32, l2_lambda=0.006001
2025-03-28 16:23:26,453 - INFO - Building model...
2025-03-28 16:23:26,838 - INFO - Batch size: 1
2025-03-28 16:23:26,838 - INFO - Starting model training...
2025-03-28 16:23:26,866 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:23:26,881 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:24:38,395 - INFO - Completed trial 6 with value: 0.968404
2025-03-28 16:24:38,397 - INFO - Starting trial 7
2025-03-28 16:24:38,401 - INFO - Hyperparameters: d_model=32, num_heads=3, lstm_units=16, num_layers=2, dropout_rate=0.23, l2_lambda=0.000453
2025-03-28 16:24:38,401 - INFO - Building model...
2025-03-28 16:24:38,796 - INFO - Batch size: 1
2025-03-28 16:24:38,797 - INFO - Starting model training...
2025-03-28 16:24:38,819 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:24:38,832 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:25:50,110 - INFO - Completed trial 7 with value: 0.056011
2025-03-28 16:25:50,111 - INFO - Starting trial 8
2025-03-28 16:25:50,117 - INFO - Hyperparameters: d_model=8, num_heads=4, lstm_units=18, num_layers=3, dropout_rate=0.32, l2_lambda=0.004594
2025-03-28 16:25:50,117 - INFO - Building model...
2025-03-28 16:25:50,659 - INFO - Batch size: 1
2025-03-28 16:25:50,659 - INFO - Starting model training...
2025-03-28 16:25:50,679 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:25:50,693 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:27:55,931 - INFO - Completed trial 8 with value: 0.285642
2025-03-28 16:27:55,938 - INFO - Starting trial 9
2025-03-28 16:27:55,952 - INFO - Hyperparameters: d_model=8, num_heads=2, lstm_units=29, num_layers=3, dropout_rate=0.30, l2_lambda=0.000220
2025-03-28 16:27:55,952 - INFO - Building model...
2025-03-28 16:27:56,459 - INFO - Batch size: 1
2025-03-28 16:27:56,460 - INFO - Starting model training...
2025-03-28 16:27:56,503 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:27:56,529 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 48), Targets shape: (1, 3)
2025-03-28 16:29:37,259 - INFO - Completed trial 9 with value: 0.893276
2025-03-28 16:29:37,270 - INFO - Best parameters: {'d_model': 32, 'num_heads': 3, 'lstm_units': 16, 'num_layers': 2, 'dropout_rate': 0.23287223322181394, 'l2_lambda': 0.0004532215718312408, 'learning_rate': 0.0009280606855967436, 'batch_size': 1}
2025-03-28 16:29:37,628 - INFO - Training final model with default/best parameters
2025-03-28 16:31:57,602 - INFO - Training completed
2025-03-28 16:31:57,696 - INFO - Test data shape for prediction: (79, 1, 48)
2025-03-28 16:32:00,082 - INFO - Hong Kong - RMSE: 140491.08 HKD/m², MAE: 111292.47 HKD/m², MAPE: 28.69%, R²: -0.0486
2025-03-28 16:32:00,083 - INFO - Kowloon - RMSE: 84210.08 HKD/m², MAE: 62252.18 HKD/m², MAPE: 18.53%, R²: -0.0005
2025-03-28 16:32:00,084 - INFO - New Territories - RMSE: 89295.59 HKD/m², MAE: 70222.23 HKD/m², MAPE: 20.81%, R²: -0.0003
2025-03-28 16:32:00,086 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-03-28 16:32:00,251 - INFO - Saved model with step_size=1
2025-03-28 16:32:00,270 - ERROR - Feature mismatch: last_sequence has 3 features, expected 48
2025-03-28 16:32:00,275 - INFO - Historical volatility: [0. 0. 0.]
2025-03-28 16:32:14,179 - INFO - mc_predictions shape: (5, 72, 3)
2025-03-28 16:32:14,230 - INFO - future_df shape: (72, 10)
2025-03-28 16:32:14,256 - INFO - future_df head:
        Date  Predicted Price HK  Lower Bound HK (95%)  Upper Bound HK (95%)  \
0 2025-02-01       504658.677233         376457.037233         632860.317233   
1 2025-03-01       497015.215752         368813.575752         625216.855752   
2 2025-04-01       497007.859338         368806.219338         625209.499338   
3 2025-05-01       497007.810295         368806.170295         625209.450295   
4 2025-06-01       497007.810295         368806.170295         625209.450295   

   Predicted Price KL  Lower Bound KL (95%)  Upper Bound KL (95%)  \
0       363715.441403         208499.121403         518931.761403   
1       369307.900085         214091.580085         524524.220085   
2       369309.273848         214092.953848         524525.593848   
3       369309.306557         214092.986557         524525.626557   
4       369309.273848         214092.953848         524525.593848   

   Predicted Price NT  Lower Bound NT (95%)  Upper Bound NT (95%)  
0       374980.919869         255215.119869         494746.719869  
1       364433.166106         244667.366106         484198.966106  
2       364429.729223         244663.929223         484195.529223  
3       364429.806457         244664.006457         484195.606457  
4       364429.729223         244663.929223         484195.529223  
2025-03-28 16:32:14,275 - INFO - Saved future predictions to /Users/mastin/project_folder/predicted_prices_2025_2030.csv
2025-03-28 16:32:14,298 - INFO - dataset columns: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 16:32:14,298 - INFO - future_df columns: ['Date', 'Predicted Price HK', 'Lower Bound HK (95%)', 'Upper Bound HK (95%)', 'Predicted Price KL', 'Lower Bound KL (95%)', 'Upper Bound KL (95%)', 'Predicted Price NT', 'Lower Bound NT (95%)', 'Upper Bound NT (95%)']
2025-03-28 16:32:15,952 - INFO - 
=== Detailed Results ===
2025-03-28 16:32:15,953 - INFO - Test Set Performance:
2025-03-28 16:32:15,955 - INFO - Hong Kong - RMSE: 140491.08 HKD/m², MAE: 111292.47 HKD/m², MAPE: 28.69%, R²: -0.0486
2025-03-28 16:32:15,956 - INFO - Kowloon - RMSE: 84210.08 HKD/m², MAE: 62252.18 HKD/m², MAPE: 18.53%, R²: -0.0005
2025-03-28 16:32:15,957 - INFO - New Territories - RMSE: 89295.59 HKD/m², MAE: 70222.23 HKD/m², MAPE: 20.81%, R²: -0.0003
2025-03-28 16:32:15,957 - INFO - 
Future Predictions (First 12 Months):
2025-03-28 16:39:16,220 - INFO - Num GPUs Available: 1
2025-03-28 16:39:16,225 - INFO - Running with Metal GPU acceleration
2025-03-28 16:39:16,461 - INFO - All data files found. Proceeding with processing.
2025-03-28 16:39:16,461 - INFO - Processing new data with step_size=1
2025-03-28 16:39:16,461 - INFO - Loading data files...
2025-03-28 16:39:16,628 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 16:39:16,628 - INFO - df_yields['Year'] dtype: int64
2025-03-28 16:39:16,628 - INFO - df_sales['Year'] dtype: int64
2025-03-28 16:39:16,628 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 16:39:16,628 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 16:39:16,628 - INFO - df_economic['Year'] dtype: int64
2025-03-28 16:39:16,628 - INFO - df_population['Year'] dtype: int64
2025-03-28 16:39:16,646 - INFO - Merging datasets...
2025-03-28 16:39:16,665 - INFO - Shape after merging: (313, 58)
2025-03-28 16:39:16,665 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 16:39:16,668 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 16:39:16,668 - INFO - Target columns: ['Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-28 16:39:16,680 - INFO - Selected features (correlation > 0.3): ['Year', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Unemployment_Rate', 'Real_Interest_Rate', 'Population', 'Median Age', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 16:39:16,683 - INFO - Updated selected features with lags and trends: ['Year', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Unemployment_Rate', 'Real_Interest_Rate', 'Population', 'Median Age', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank', 'Price_Hong_Kong_lag_1', 'Price_Hong_Kong_lag_2', 'Price_Hong_Kong_lag_3', 'Price_Kowloon_lag_1', 'Price_Kowloon_lag_2', 'Price_Kowloon_lag_3', 'Price_New_Territories_lag_1', 'Price_New_Territories_lag_2', 'Price_New_Territories_lag_3', 'Price_Hong_Kong_change', 'Price_Kowloon_change', 'Price_New_Territories_change']
2025-03-28 16:39:16,686 - INFO - Added EWMA features: ['Price_Hong_Kong_ewma', 'Price_Kowloon_ewma', 'Price_New_Territories_ewma']
2025-03-28 16:39:16,696 - INFO - Feature columns after filling NaNs: 60
2025-03-28 16:39:16,699 - INFO - NaN count in features: 0
2025-03-28 16:39:16,704 - INFO - Feature min/max: -0.6802372405622121/8231613070.0
2025-03-28 16:39:16,746 - INFO - Outliers clipped using IQR method
2025-03-28 16:39:16,747 - INFO - price_data shape: (313, 3), features shape: (313, 60)
2025-03-28 16:39:17,426 - INFO - Train dataset size: 234
2025-03-28 16:39:17,426 - INFO - Test dataset size: 79
2025-03-28 16:39:17,426 - INFO - Preprocessed data with step_size=1, train_size=234, test_size=79, n_features=63
2025-03-28 16:39:17,856 - INFO - Starting hyperparameter optimization
2025-03-28 16:39:17,868 - INFO - Starting trial 0
2025-03-28 16:39:17,874 - INFO - Hyperparameters: d_model=32, num_heads=8, lstm_units=97, num_layers=2, dropout_rate=0.45, l2_lambda=0.009953
2025-03-28 16:39:17,874 - INFO - Building model...
2025-03-28 16:39:21,971 - INFO - Batch size: 1
2025-03-28 16:39:21,974 - INFO - Starting model training...
2025-03-28 16:39:22,026 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 63), Targets shape: (1, 3)
2025-03-28 16:39:22,043 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 63), Targets shape: (1, 3)
2025-03-28 16:44:21,389 - ERROR - Trial 0 failed with exception: The output of the `schedule` function should be a float. Got: 1.669732046138961e-05
2025-03-28 16:44:21,400 - ERROR - Exception traceback: Traceback (most recent call last):
  File "/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/ipykernel_58499/1771311206.py", line 318, in objective
    history = model.fit(train_dataset, epochs=10, validation_data=test_dataset,
  File "/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/keras/src/callbacks/learning_rate_scheduler.py", line 65, in on_epoch_begin
    raise ValueError(
ValueError: The output of the `schedule` function should be a float. Got: 1.669732046138961e-05

2025-03-28 16:44:21,418 - ERROR - Error in main execution: The output of the `schedule` function should be a float. Got: 1.669732046138961e-05
2025-03-28 16:56:29,687 - INFO - Num GPUs Available: 1
2025-03-28 16:56:29,690 - INFO - Running with Metal GPU acceleration
2025-03-28 16:56:29,761 - INFO - All data files found. Proceeding with processing.
2025-03-28 16:56:29,761 - INFO - Processing new data with step_size=1
2025-03-28 16:56:29,761 - INFO - Loading data files...
2025-03-28 16:56:29,895 - INFO - df_rents_prices['Year'] dtype: int64
2025-03-28 16:56:29,895 - INFO - df_yields['Year'] dtype: int64
2025-03-28 16:56:29,896 - INFO - df_sales['Year'] dtype: int64
2025-03-28 16:56:29,896 - INFO - df_rental_prices['Year'] dtype: int64
2025-03-28 16:56:29,896 - INFO - df_rental_indices['Year'] dtype: int64
2025-03-28 16:56:29,896 - INFO - df_economic['Year'] dtype: int64
2025-03-28 16:56:29,896 - INFO - df_population['Year'] dtype: int64
2025-03-28 16:56:29,939 - INFO - Merging datasets...
2025-03-28 16:56:29,978 - INFO - Shape after merging: (313, 58)
2025-03-28 16:56:29,978 - INFO - Columns after merging: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 16:56:29,988 - INFO - Shape after dropping NaN in 'Date': (313, 58)
2025-03-28 16:56:29,988 - INFO - Target columns: ['Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-28 16:56:30,009 - INFO - Selected features (correlation > 0.3): ['Year', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Unemployment_Rate', 'Real_Interest_Rate', 'Population', 'Median Age', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 16:56:30,013 - INFO - Updated selected features with lags and trends: ['Year', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Unemployment_Rate', 'Real_Interest_Rate', 'Population', 'Median Age', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank', 'Price_Hong_Kong_lag_1', 'Price_Hong_Kong_lag_2', 'Price_Hong_Kong_lag_3', 'Price_Kowloon_lag_1', 'Price_Kowloon_lag_2', 'Price_Kowloon_lag_3', 'Price_New_Territories_lag_1', 'Price_New_Territories_lag_2', 'Price_New_Territories_lag_3', 'Price_Hong_Kong_change', 'Price_Kowloon_change', 'Price_New_Territories_change']
2025-03-28 16:56:30,017 - INFO - Added EWMA features: ['Price_Hong_Kong_ewma', 'Price_Kowloon_ewma', 'Price_New_Territories_ewma']
2025-03-28 16:56:30,029 - INFO - Feature columns after filling NaNs: 60
2025-03-28 16:56:30,031 - INFO - NaN count in features: 0
2025-03-28 16:56:30,036 - INFO - Feature min/max: -0.6802372405622121/8231613070.0
2025-03-28 16:56:30,073 - INFO - Outliers clipped using IQR method
2025-03-28 16:56:30,075 - INFO - price_data shape: (313, 3), features shape: (313, 60)
2025-03-28 16:56:30,887 - INFO - Train dataset size: 234
2025-03-28 16:56:30,887 - INFO - Test dataset size: 79
2025-03-28 16:56:30,887 - INFO - Preprocessed data with step_size=1, train_size=234, test_size=79, n_features=63
2025-03-28 16:56:30,893 - INFO - Starting hyperparameter optimization
2025-03-28 16:56:30,898 - INFO - Starting trial 0
2025-03-28 16:56:30,903 - INFO - Hyperparameters: d_model=32, num_heads=4, lstm_units=63, num_layers=3, dropout_rate=0.34, l2_lambda=0.000420
2025-03-28 16:56:30,903 - INFO - Building model...
2025-03-28 16:56:32,716 - INFO - Batch size: 1
2025-03-28 16:56:32,717 - INFO - Starting model training...
2025-03-28 16:56:32,737 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 63), Targets shape: (1, 3)
2025-03-28 16:56:32,753 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 63), Targets shape: (1, 3)
2025-03-28 17:10:50,472 - INFO - Completed trial 0 with value: 0.071141
2025-03-28 17:10:50,475 - INFO - Starting trial 1
2025-03-28 17:10:50,497 - INFO - Hyperparameters: d_model=16, num_heads=7, lstm_units=123, num_layers=3, dropout_rate=0.39, l2_lambda=0.001308
2025-03-28 17:10:50,497 - INFO - Building model...
2025-03-28 17:10:51,946 - INFO - Batch size: 1
2025-03-28 17:10:51,947 - INFO - Starting model training...
2025-03-28 17:10:52,035 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 63), Targets shape: (1, 3)
2025-03-28 17:10:52,051 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 63), Targets shape: (1, 3)
2025-03-28 17:24:22,579 - INFO - Completed trial 1 with value: 0.181056
2025-03-28 17:24:22,580 - INFO - Starting trial 2
2025-03-28 17:24:22,592 - INFO - Hyperparameters: d_model=64, num_heads=7, lstm_units=50, num_layers=4, dropout_rate=0.43, l2_lambda=0.001091
2025-03-28 17:24:22,592 - INFO - Building model...
2025-03-28 17:24:23,784 - INFO - Batch size: 1
2025-03-28 17:24:23,784 - INFO - Starting model training...
2025-03-28 17:24:23,815 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 63), Targets shape: (1, 3)
2025-03-28 17:24:23,826 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 63), Targets shape: (1, 3)
2025-03-28 17:58:43,672 - INFO - Completed trial 2 with value: 0.552279
2025-03-28 17:58:43,675 - INFO - Starting trial 3
2025-03-28 17:58:43,688 - INFO - Hyperparameters: d_model=32, num_heads=6, lstm_units=91, num_layers=4, dropout_rate=0.39, l2_lambda=0.000224
2025-03-28 17:58:43,688 - INFO - Building model...
2025-03-28 17:58:44,832 - INFO - Batch size: 1
2025-03-28 17:58:44,833 - INFO - Starting model training...
2025-03-28 17:58:44,870 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 63), Targets shape: (1, 3)
2025-03-28 17:58:44,882 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 63), Targets shape: (1, 3)
2025-03-28 18:16:58,513 - INFO - Completed trial 3 with value: 0.056979
2025-03-28 18:16:58,515 - INFO - Starting trial 4
2025-03-28 18:16:58,527 - INFO - Hyperparameters: d_model=16, num_heads=5, lstm_units=36, num_layers=2, dropout_rate=0.45, l2_lambda=0.000349
2025-03-28 18:16:58,527 - INFO - Building model...
2025-03-28 18:17:00,003 - INFO - Batch size: 1
2025-03-28 18:17:00,004 - INFO - Starting model training...
2025-03-28 18:17:00,051 - INFO - Sample batch from train_dataset - Inputs shape: (1, 1, 63), Targets shape: (1, 3)
2025-03-28 18:17:00,063 - INFO - Sample batch from test_dataset - Inputs shape: (1, 1, 63), Targets shape: (1, 3)
2025-03-28 18:28:28,143 - INFO - Num GPUs Available: 1
2025-03-28 18:28:28,144 - INFO - Running with GPU acceleration
2025-03-28 18:28:28,228 - INFO - Processing new data with step_size=1
2025-03-28 18:28:28,229 - INFO - Loading data files...
2025-03-28 18:28:28,284 - INFO - Merging datasets...
2025-03-28 18:28:34,675 - ERROR - Error in preprocessing data: A result has failed to un-serialize. Please ensure that the objects returned by the function are always picklable.
2025-03-28 18:28:34,675 - ERROR - Error in main execution: A result has failed to un-serialize. Please ensure that the objects returned by the function are always picklable.
2025-03-28 18:29:54,415 - INFO - Num GPUs Available: 1
2025-03-28 18:29:54,419 - INFO - Running with GPU acceleration
2025-03-28 18:29:54,427 - INFO - Processing new data with step_size=1
2025-03-28 18:29:54,427 - INFO - Loading data files...
2025-03-28 18:29:54,592 - INFO - Merging datasets...
2025-03-28 18:29:55,223 - ERROR - Error in preprocessing data: Could not pickle the task to send it to the workers.
2025-03-28 18:29:55,224 - ERROR - Error in main execution: Could not pickle the task to send it to the workers.
2025-03-28 18:33:25,878 - INFO - Num GPUs Available: 1
2025-03-28 18:33:25,879 - INFO - Running with GPU acceleration
2025-03-28 18:33:25,886 - INFO - Processing new data with step_size=1
2025-03-28 18:33:25,887 - INFO - Loading data files...
2025-03-28 18:33:25,946 - INFO - Merging datasets...
2025-03-28 18:33:25,972 - ERROR - Error in preprocessing data: cannot convert float NaN to integer
2025-03-28 18:33:25,972 - ERROR - Error in main execution: cannot convert float NaN to integer
2025-03-28 18:37:06,954 - INFO - Num GPUs Available: 1
2025-03-28 18:37:06,955 - INFO - Running with GPU acceleration
2025-03-28 18:37:06,959 - INFO - Processing new data with step_size=1
2025-03-28 18:37:06,959 - INFO - Loading data files...
2025-03-28 18:37:07,076 - INFO - Merging datasets...
2025-03-28 18:37:07,078 - ERROR - Error in preprocessing data: You are trying to merge on datetime64[ns] and int64 columns for key 'Date'. If you wish to proceed you should use pd.concat
2025-03-28 18:37:07,078 - ERROR - Error in main execution: You are trying to merge on datetime64[ns] and int64 columns for key 'Date'. If you wish to proceed you should use pd.concat
2025-03-28 18:44:14,310 - INFO - Num GPUs Available: 1
2025-03-28 18:44:14,314 - INFO - Running with GPU acceleration
2025-03-28 18:44:14,346 - INFO - Processing new data with step_size=1
2025-03-28 18:44:14,350 - INFO - Loading data files...
2025-03-28 18:44:14,486 - INFO - Merging datasets...
2025-03-28 18:44:15,709 - INFO - Starting hyperparameter optimization
2025-03-28 18:44:15,718 - INFO - Starting trial 0
2025-03-28 18:44:20,229 - INFO - Batch size: 8
2025-03-28 18:45:24,944 - INFO - Starting trial 1
2025-03-28 18:45:25,544 - INFO - Batch size: 8
2025-03-28 18:47:42,146 - INFO - Starting trial 2
2025-03-28 18:47:43,067 - INFO - Batch size: 8
2025-03-28 18:50:23,869 - INFO - Starting trial 3
2025-03-28 18:50:24,872 - INFO - Batch size: 8
2025-03-28 18:53:44,971 - INFO - Starting trial 4
2025-03-28 18:53:46,190 - INFO - Batch size: 8
2025-03-28 19:02:42,413 - INFO - Hong Kong - RMSE: 149484.48 HKD/m², MAE: 111799.82 HKD/m², MAPE: 23.42%, R²: -0.1871
2025-03-28 19:02:42,416 - INFO - Kowloon - RMSE: 98585.64 HKD/m², MAE: 75118.72 HKD/m², MAPE: 19.21%, R²: -0.3712
2025-03-28 19:02:42,416 - INFO - New Territories - RMSE: 94330.46 HKD/m², MAE: 73566.72 HKD/m², MAPE: 19.29%, R²: -0.1163
2025-03-28 19:02:42,419 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-03-28 19:06:25,411 - INFO - 
Future Predictions (First 12 Months):
2025-03-28 19:16:54,662 - INFO - Num GPUs Available: 1
2025-03-28 19:16:54,667 - INFO - Running with GPU acceleration
2025-03-28 19:16:54,761 - INFO - Processing new data with step_size=1
2025-03-28 19:16:54,761 - INFO - Loading data files...
2025-03-28 19:16:54,930 - INFO - Merging datasets...
2025-03-28 19:16:56,027 - INFO - Starting hyperparameter optimization
2025-03-28 19:16:56,036 - INFO - Starting trial 0
2025-03-28 19:17:02,851 - INFO - Batch size: 8
2025-03-28 19:19:27,303 - INFO - Starting trial 1
2025-03-28 19:19:28,500 - INFO - Batch size: 8
2025-03-28 19:23:19,072 - INFO - Starting trial 2
2025-03-28 19:23:21,362 - INFO - Batch size: 8
2025-03-28 19:49:53,437 - INFO - Starting trial 3
2025-03-28 19:49:54,984 - INFO - Batch size: 8
2025-03-28 19:54:03,930 - INFO - Starting trial 4
2025-03-28 19:54:04,882 - INFO - Batch size: 8
2025-03-28 20:09:55,441 - INFO - Hong Kong - RMSE: 145470.05 HKD/m², MAE: 111923.71 HKD/m², MAPE: 24.83%, R²: -0.1242
2025-03-28 20:09:55,446 - INFO - Kowloon - RMSE: 96449.77 HKD/m², MAE: 73104.05 HKD/m², MAPE: 22.45%, R²: -0.3124
2025-03-28 20:09:55,447 - INFO - New Territories - RMSE: 85846.21 HKD/m², MAE: 68776.68 HKD/m², MAPE: 19.70%, R²: 0.0755
2025-03-28 20:09:55,450 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-03-28 20:12:16,152 - INFO - 
Future Predictions (First 12 Months):
2025-03-28 20:32:00,506 - ERROR - Importing plotly failed. Interactive plots will not work.
2025-03-28 20:32:00,529 - INFO - Processing new data...
2025-03-28 20:32:00,529 - INFO - Loading data files...
2025-03-28 20:32:00,648 - INFO - Merging datasets...
2025-03-28 20:32:00,688 - ERROR - Error in preprocessing data: 'GDP'
2025-03-28 20:32:00,688 - ERROR - Error in main execution: 'GDP'
2025-03-28 20:36:14,297 - INFO - Processing new data...
2025-03-28 20:36:14,306 - INFO - Loading data files...
2025-03-28 20:36:14,441 - INFO - Merging datasets...
2025-03-28 20:36:14,454 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 20:36:14,467 - WARNING - Column 'Economic_GDP' not found in DataFrame. Skipping GDP_Population feature.
2025-03-28 20:36:14,467 - ERROR - Error in preprocessing data: 'Interest_Rate'
2025-03-28 20:36:14,467 - ERROR - Error in main execution: 'Interest_Rate'
2025-03-28 20:40:57,143 - INFO - Processing new data...
2025-03-28 20:40:57,146 - INFO - Loading data files...
2025-03-28 20:40:57,230 - INFO - Merging datasets...
2025-03-28 20:40:57,242 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 20:40:57,257 - WARNING - Column 'Economic_GDP' not found in DataFrame. Skipping GDP_Population feature.
2025-03-28 20:40:57,257 - WARNING - Column 'InterestRate' or 'Rental_Index_Class_A' not found in DataFrame. Skipping Interest_Rental_Ratio feature.
2025-03-28 20:40:57,373 - INFO - Training XGBoost model for Hong Kong...
2025-03-28 20:40:57,378 - ERROR - Error in main execution: fit() got an unexpected keyword argument 'early_stopping_rounds'
2025-03-28 20:44:25,230 - INFO - Processing new data...
2025-03-28 20:44:25,233 - INFO - Loading data files...
2025-03-28 20:44:25,305 - INFO - Merging datasets...
2025-03-28 20:44:25,318 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 20:44:25,331 - WARNING - Column 'GDP' or 'Population' not found in DataFrame. Skipping GDP_Population feature.
2025-03-28 20:44:25,331 - WARNING - Column 'InterestRate' or 'Rental_Index_Class_A' not found in DataFrame. Skipping Interest_Rental_Ratio feature.
2025-03-28 20:44:25,440 - INFO - Training XGBoost model for Hong Kong...
2025-03-28 20:44:25,441 - ERROR - Error in main execution: fit() got an unexpected keyword argument 'early_stopping_rounds'
2025-03-28 20:48:15,575 - INFO - Processing new data...
2025-03-28 20:48:15,577 - INFO - Loading data files...
2025-03-28 20:48:15,653 - INFO - Merging datasets...
2025-03-28 20:48:15,665 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 20:48:15,678 - WARNING - Column 'GDP' or 'Population' not found in DataFrame. Skipping GDP_Population feature.
2025-03-28 20:48:15,678 - WARNING - Column 'InterestRate' or 'Rental_Index_Class_A' not found in DataFrame. Skipping Interest_Rental_Ratio feature.
2025-03-28 20:48:15,765 - INFO - Training XGBoost model for Hong Kong...
2025-03-28 20:48:15,766 - ERROR - Error in main execution: fit() got an unexpected keyword argument 'eval_metric'
2025-03-28 20:56:16,797 - INFO - Processing new data...
2025-03-28 20:56:16,799 - INFO - Loading data files...
2025-03-28 20:56:16,904 - INFO - Merging datasets...
2025-03-28 20:56:16,914 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 20:56:16,929 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-28 20:56:17,910 - INFO - Training LSTM model for Hong Kong...
2025-03-28 20:58:02,870 - INFO - Training LSTM model for Kowloon...
2025-03-28 20:58:39,038 - WARNING - 5 out of the last 727 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x6aa11b790> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2025-03-28 20:58:39,077 - INFO - Training LSTM model for New Territories...
2025-03-28 20:59:12,358 - WARNING - 6 out of the last 728 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x6dc1919d0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2025-03-28 20:59:13,569 - INFO - Training Transformer model for Hong Kong...
2025-03-28 21:00:55,123 - INFO - Training Transformer model for Kowloon...
2025-03-28 21:02:22,561 - INFO - Training Transformer model for New Territories...
2025-03-28 21:04:08,062 - INFO - Training XGBoost model for Hong Kong...
2025-03-28 21:04:08,079 - ERROR - Error in main execution: fit() got an unexpected keyword argument 'eval_metric'
2025-03-28 21:16:25,148 - INFO - Processing new data...
2025-03-28 21:16:25,151 - INFO - Loading data files...
2025-03-28 21:16:25,397 - INFO - Merging datasets...
2025-03-28 21:16:25,427 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 21:16:25,463 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-28 21:16:26,453 - INFO - Training LSTM model for Hong Kong...
2025-03-28 21:17:18,635 - INFO - Training LSTM model for Kowloon...
2025-03-28 21:18:13,894 - INFO - Training LSTM model for New Territories...
2025-03-28 21:19:04,121 - INFO - Training Transformer model for Hong Kong...
2025-03-28 21:21:26,712 - INFO - Training Transformer model for Kowloon...
2025-03-28 21:23:59,148 - INFO - Training Transformer model for New Territories...
2025-03-28 21:27:29,989 - INFO - Training XGBoost model for Hong Kong...
2025-03-28 21:27:30,009 - ERROR - Error in main execution: fit() got an unexpected keyword argument 'callbacks'
2025-03-28 21:32:28,327 - INFO - Processing new data...
2025-03-28 21:32:28,340 - INFO - Loading data files...
2025-03-28 21:32:28,511 - INFO - Merging datasets...
2025-03-28 21:32:28,556 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 21:32:28,584 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-28 21:32:29,602 - INFO - Training LSTM model for Hong Kong...
2025-03-28 21:33:40,127 - INFO - Training LSTM model for Kowloon...
2025-03-28 21:34:33,088 - INFO - Training LSTM model for New Territories...
2025-03-28 21:35:26,445 - INFO - Training Transformer model for Hong Kong...
2025-03-28 21:37:53,936 - INFO - Training Transformer model for Kowloon...
2025-03-28 21:40:44,523 - INFO - Training Transformer model for New Territories...
2025-03-28 21:44:10,110 - INFO - Training XGBoost model for Hong Kong...
2025-03-28 21:44:10,123 - ERROR - Error in main execution: fit() got an unexpected keyword argument 'early_stopping_rounds'
2025-03-28 21:51:02,058 - INFO - Processing new data...
2025-03-28 21:51:02,061 - INFO - Loading data files...
2025-03-28 21:51:02,240 - INFO - Merging datasets...
2025-03-28 21:51:02,296 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 21:51:02,344 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-28 21:51:03,176 - INFO - Training LSTM model for Hong Kong...
2025-03-28 21:52:28,572 - INFO - Training LSTM model for Kowloon...
2025-03-28 21:53:55,258 - INFO - Training LSTM model for New Territories...
2025-03-28 21:54:51,391 - INFO - Training Transformer model for Hong Kong...
2025-03-28 21:57:38,554 - INFO - Training Transformer model for Kowloon...
2025-03-28 22:00:24,622 - INFO - Training Transformer model for New Territories...
2025-03-28 22:03:34,507 - INFO - Training XGBoost model for Hong Kong...
2025-03-28 22:03:34,522 - ERROR - Error in main execution: fit() got an unexpected keyword argument 'callbacks'
2025-03-28 22:13:33,817 - INFO - Processing new data...
2025-03-28 22:13:33,825 - INFO - Loading data files...
2025-03-28 22:13:34,001 - INFO - Merging datasets...
2025-03-28 22:13:34,038 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 22:13:34,072 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-28 22:13:35,092 - INFO - Training LSTM model for Hong Kong...
2025-03-28 22:14:56,771 - INFO - Training LSTM model for Kowloon...
2025-03-28 22:15:57,795 - INFO - Training LSTM model for New Territories...
2025-03-28 22:16:58,923 - INFO - Training Transformer model for Hong Kong...
2025-03-28 22:20:00,110 - INFO - Training Transformer model for Kowloon...
2025-03-28 22:24:35,732 - INFO - Training Transformer model for New Territories...
2025-03-28 22:27:48,750 - INFO - Training XGBoost model for Hong Kong...
2025-03-28 22:27:48,766 - ERROR - Error in main execution: fit() got an unexpected keyword argument 'callbacks'
2025-03-28 22:33:28,733 - INFO - Processing new data...
2025-03-28 22:33:28,735 - INFO - Loading data files...
2025-03-28 22:33:28,933 - INFO - Merging datasets...
2025-03-28 22:33:29,003 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 22:33:29,056 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-28 22:33:30,620 - INFO - Training LSTM model for Hong Kong...
2025-03-28 22:34:59,456 - INFO - Training LSTM model for Kowloon...
2025-03-28 22:36:21,274 - INFO - Training LSTM model for New Territories...
2025-03-28 22:37:30,564 - INFO - Training Transformer model for Hong Kong...
2025-03-28 22:41:22,060 - INFO - Training Transformer model for Kowloon...
2025-03-28 22:44:49,030 - INFO - Training Transformer model for New Territories...
2025-03-28 22:48:44,812 - INFO - Training XGBoost model for Hong Kong...
2025-03-28 22:48:45,133 - INFO - Training XGBoost model for Kowloon...
2025-03-28 22:48:45,201 - INFO - Training XGBoost model for New Territories...
2025-03-28 22:48:45,287 - INFO - Training LightGBM model for Hong Kong...
2025-03-28 22:48:45,467 - INFO - Training LightGBM model for Kowloon...
2025-03-28 22:48:45,508 - INFO - Training LightGBM model for New Territories...
2025-03-28 22:48:45,541 - INFO - Training Prophet model for Hong Kong...
2025-03-28 22:48:46,778 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/f3svsn3l.json
2025-03-28 22:48:46,783 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/n02s6psw.json
2025-03-28 22:48:46,788 - DEBUG - idx 0
2025-03-28 22:48:46,788 - DEBUG - running CmdStan, num_threads: None
2025-03-28 22:48:46,788 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=77099', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/f3svsn3l.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/n02s6psw.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelryfp3lw7/prophet_model-20250328224846.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-28 22:48:46,788 - INFO - Chain [1] start processing
2025-03-28 22:48:47,379 - INFO - Chain [1] done processing
2025-03-28 22:48:47,423 - INFO - Training Prophet model for Kowloon...
2025-03-28 22:48:47,429 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/wr6ia4bu.json
2025-03-28 22:48:47,436 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/y27qjpgg.json
2025-03-28 22:48:47,436 - DEBUG - idx 0
2025-03-28 22:48:47,436 - DEBUG - running CmdStan, num_threads: None
2025-03-28 22:48:47,436 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=88155', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/wr6ia4bu.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/y27qjpgg.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_model4kp_ggit/prophet_model-20250328224847.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-28 22:48:47,436 - INFO - Chain [1] start processing
2025-03-28 22:48:47,483 - INFO - Chain [1] done processing
2025-03-28 22:48:47,507 - INFO - Training Prophet model for New Territories...
2025-03-28 22:48:47,513 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/gf5nn3xb.json
2025-03-28 22:48:47,518 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/wo7ie1zr.json
2025-03-28 22:48:47,518 - DEBUG - idx 0
2025-03-28 22:48:47,518 - DEBUG - running CmdStan, num_threads: None
2025-03-28 22:48:47,518 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=75052', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/gf5nn3xb.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/wo7ie1zr.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelxskbp0k4/prophet_model-20250328224847.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-28 22:48:47,518 - INFO - Chain [1] start processing
2025-03-28 22:48:47,565 - INFO - Chain [1] done processing
2025-03-28 22:48:47,589 - ERROR - Error in main execution: all the input array dimensions except for the concatenation axis must match exactly, but along dimension 0, the array at index 0 has size 76 and the array at index 2 has size 79
2025-03-28 23:06:03,918 - INFO - Processing new data...
2025-03-28 23:06:03,922 - INFO - Loading data files...
2025-03-28 23:06:04,101 - INFO - Merging datasets...
2025-03-28 23:06:04,127 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-28 23:06:04,153 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-28 23:06:04,204 - INFO - Performing feature selection with LightGBM...
2025-03-28 23:06:04,294 - INFO - Selected features after feature selection: ['GDP_Population', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'Index_B', 'Index_A', 'E_Kowloon', 'C_Hong Kong', 'D_New Territories', 'E_Hong Kong', 'E_New Territories', 'Yield_E', 'Price_Kowloon_change', 'Real_Interest_Rate', 'Yield_A', 'Price_Kowloon_rolling_mean_3', 'Price_Hong_Kong_lag_1', 'Primary_Sales_No', 'Secondary_Sales_Consideration', 'Price_New_Territories_lag_1', 'Month', 'Yield_D', 'Price_Kowloon_lag_2', 'Rent_Kowloon', 'Price_New_Territories_lag_3', 'Yield_C', 'Price_Hong_Kong_lag_2', 'Price_Hong_Kong_change', 'Price_Hong_Kong_rolling_mean_3']
2025-03-28 23:06:05,089 - INFO - Training LSTM model for Hong Kong...
2025-03-28 23:08:41,389 - INFO - Training LSTM model for Kowloon...
2025-03-28 23:10:58,934 - INFO - Training LSTM model for New Territories...
2025-03-28 23:29:07,998 - INFO - Training Transformer model for Hong Kong...
2025-03-29 00:05:15,545 - INFO - Training Transformer model for Kowloon...
2025-03-29 00:08:35,795 - INFO - Training Transformer model for New Territories...
2025-03-29 00:11:50,088 - INFO - Training XGBoost model for Hong Kong...
2025-03-29 00:11:50,231 - INFO - Training XGBoost model for Kowloon...
2025-03-29 00:11:50,267 - INFO - Training XGBoost model for New Territories...
2025-03-29 00:11:50,331 - INFO - Training LightGBM model for Hong Kong...
2025-03-29 00:11:50,437 - INFO - Training LightGBM model for Kowloon...
2025-03-29 00:11:50,464 - INFO - Training LightGBM model for New Territories...
2025-03-29 00:11:50,523 - INFO - Training Prophet model for Hong Kong...
2025-03-29 00:11:50,780 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/1ai81nle.json
2025-03-29 00:11:50,786 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/v8lu14wl.json
2025-03-29 00:11:50,812 - DEBUG - idx 0
2025-03-29 00:11:50,812 - DEBUG - running CmdStan, num_threads: None
2025-03-29 00:11:50,816 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=25152', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/1ai81nle.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/v8lu14wl.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_model9t33oice/prophet_model-20250329001150.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 00:11:50,816 - INFO - Chain [1] start processing
2025-03-29 00:11:50,923 - INFO - Chain [1] done processing
2025-03-29 00:11:50,965 - INFO - Training Prophet model for Kowloon...
2025-03-29 00:11:50,971 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/ax9exisu.json
2025-03-29 00:11:50,975 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/biv05rfm.json
2025-03-29 00:11:50,976 - DEBUG - idx 0
2025-03-29 00:11:50,976 - DEBUG - running CmdStan, num_threads: None
2025-03-29 00:11:50,976 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=75149', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/ax9exisu.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/biv05rfm.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modeltx9scfpp/prophet_model-20250329001150.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 00:11:50,976 - INFO - Chain [1] start processing
2025-03-29 00:11:51,030 - INFO - Chain [1] done processing
2025-03-29 00:11:51,050 - INFO - Training Prophet model for New Territories...
2025-03-29 00:11:51,056 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/uee5ahrd.json
2025-03-29 00:11:51,061 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/3yj7288w.json
2025-03-29 00:11:51,061 - DEBUG - idx 0
2025-03-29 00:11:51,061 - DEBUG - running CmdStan, num_threads: None
2025-03-29 00:11:51,061 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=30812', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/uee5ahrd.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/3yj7288w.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_model0y49a3w2/prophet_model-20250329001151.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 00:11:51,061 - INFO - Chain [1] start processing
2025-03-29 00:11:51,114 - INFO - Chain [1] done processing
2025-03-29 00:11:51,150 - ERROR - Error in main execution: all the input array dimensions except for the concatenation axis must match exactly, but along dimension 0, the array at index 0 has size 76 and the array at index 2 has size 79
2025-03-29 11:05:02,725 - INFO - Processing new data...
2025-03-29 11:05:02,728 - INFO - Loading data files...
2025-03-29 11:05:02,851 - INFO - Merging datasets...
2025-03-29 11:05:02,894 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 11:05:02,938 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 11:05:02,994 - INFO - Performing feature selection with LightGBM...
2025-03-29 11:05:03,262 - INFO - Selected features after feature selection: ['Yield_D', 'Month', 'Price_Kowloon_lag_1', 'Yield_E', 'Price_New_Territories_change', 'D_New Territories', 'Price_New_Territories_lag_1', 'Yield_B', 'Rent_Kowloon', 'Rent_Hong_Kong', 'Yield_C', 'Year', 'Secondary_Sales_Consideration', 'Price_Hong_Kong_lag_1', 'Price_Hong_Kong_change']
2025-03-29 11:05:03,390 - INFO - Using device: cpu
2025-03-29 11:05:03,413 - INFO - Training MLP model for Hong Kong...
2025-03-29 11:05:05,121 - INFO - Training MLP model for Kowloon...
2025-03-29 11:05:05,137 - INFO - Training MLP model for New Territories...
2025-03-29 11:05:05,154 - INFO - Training LightGBM model for Hong Kong...
2025-03-29 11:05:05,187 - INFO - Training LightGBM model for Kowloon...
2025-03-29 11:05:05,209 - INFO - Training LightGBM model for New Territories...
2025-03-29 11:05:05,434 - INFO - Training Prophet model for Hong Kong...
2025-03-29 11:05:05,542 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/wzm4une2.json
2025-03-29 11:05:05,546 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/zphft63h.json
2025-03-29 11:05:05,549 - DEBUG - idx 0
2025-03-29 11:05:05,549 - DEBUG - running CmdStan, num_threads: None
2025-03-29 11:05:05,549 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=58949', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/wzm4une2.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/zphft63h.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelt50yiv2_/prophet_model-20250329110505.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 11:05:05,549 - INFO - Chain [1] start processing
2025-03-29 11:05:05,701 - INFO - Chain [1] done processing
2025-03-29 11:05:05,748 - INFO - Training Prophet model for Kowloon...
2025-03-29 11:05:05,755 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/mr6mcnqx.json
2025-03-29 11:05:05,759 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/c4twpdnu.json
2025-03-29 11:05:05,759 - DEBUG - idx 0
2025-03-29 11:05:05,759 - DEBUG - running CmdStan, num_threads: None
2025-03-29 11:05:05,759 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=22221', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/mr6mcnqx.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/c4twpdnu.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelydn2svi_/prophet_model-20250329110505.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 11:05:05,759 - INFO - Chain [1] start processing
2025-03-29 11:05:05,810 - INFO - Chain [1] done processing
2025-03-29 11:05:05,834 - INFO - Training Prophet model for New Territories...
2025-03-29 11:05:05,840 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/0cdh6ak6.json
2025-03-29 11:05:05,845 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/eiuc2l_h.json
2025-03-29 11:05:05,845 - DEBUG - idx 0
2025-03-29 11:05:05,845 - DEBUG - running CmdStan, num_threads: None
2025-03-29 11:05:05,845 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=16940', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/0cdh6ak6.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/eiuc2l_h.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelefrv9izk/prophet_model-20250329110505.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 11:05:05,845 - INFO - Chain [1] start processing
2025-03-29 11:05:05,894 - INFO - Chain [1] done processing
2025-03-29 11:05:05,986 - INFO - Evaluating new model (MLP + LightGBM + Prophet)...
2025-03-29 11:05:06,000 - INFO - Ensemble Hong Kong - RMSE: 76203.77 HKD/m², MAE: 57522.86 HKD/m², MAPE: 13.18%, R²: 0.6913
2025-03-29 11:05:06,000 - INFO - Ensemble Kowloon - RMSE: 67724.31 HKD/m², MAE: 51467.45 HKD/m², MAPE: 14.36%, R²: 0.3702
2025-03-29 11:05:06,000 - INFO - Ensemble New Territories - RMSE: 51816.29 HKD/m², MAE: 38743.11 HKD/m², MAPE: 11.06%, R²: 0.6626
2025-03-29 11:05:06,059 - ERROR - Error in main execution: mat1 and mat2 shapes cannot be multiplied (1x67 and 15x32)
2025-03-29 11:08:54,615 - INFO - Processing new data...
2025-03-29 11:08:54,617 - INFO - Loading data files...
2025-03-29 11:08:54,694 - INFO - Merging datasets...
2025-03-29 11:08:54,716 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 11:08:54,727 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 11:08:54,758 - INFO - Performing feature selection with LightGBM...
2025-03-29 11:08:54,849 - INFO - Selected features after feature selection: ['Yield_D', 'Month', 'Price_Kowloon_lag_1', 'Yield_E', 'Price_New_Territories_change', 'D_New Territories', 'Price_New_Territories_lag_1', 'Yield_B', 'Rent_Kowloon', 'Rent_Hong_Kong', 'Yield_C', 'Year', 'Secondary_Sales_Consideration', 'Price_Hong_Kong_lag_1', 'Price_Hong_Kong_change']
2025-03-29 11:08:54,865 - INFO - Using device: cpu
2025-03-29 11:08:54,886 - INFO - Training MLP model for Hong Kong...
2025-03-29 11:08:55,011 - INFO - Training MLP model for Kowloon...
2025-03-29 11:08:55,051 - INFO - Training MLP model for New Territories...
2025-03-29 11:08:55,069 - INFO - Training LightGBM model for Hong Kong...
2025-03-29 11:08:55,087 - INFO - Training LightGBM model for Kowloon...
2025-03-29 11:08:55,101 - INFO - Training LightGBM model for New Territories...
2025-03-29 11:08:55,125 - INFO - Training Prophet model for Hong Kong...
2025-03-29 11:08:55,156 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/f768011n.json
2025-03-29 11:08:55,162 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/4ofuatmm.json
2025-03-29 11:08:55,167 - DEBUG - idx 0
2025-03-29 11:08:55,167 - DEBUG - running CmdStan, num_threads: None
2025-03-29 11:08:55,167 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=55457', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/f768011n.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/4ofuatmm.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_model2_egx5ho/prophet_model-20250329110855.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 11:08:55,167 - INFO - Chain [1] start processing
2025-03-29 11:08:55,246 - INFO - Chain [1] done processing
2025-03-29 11:08:55,378 - INFO - Training Prophet model for Kowloon...
2025-03-29 11:08:55,387 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/8xdyerwh.json
2025-03-29 11:08:55,393 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/dynjoyl2.json
2025-03-29 11:08:55,393 - DEBUG - idx 0
2025-03-29 11:08:55,393 - DEBUG - running CmdStan, num_threads: None
2025-03-29 11:08:55,393 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=19136', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/8xdyerwh.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/dynjoyl2.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modellqe6oem3/prophet_model-20250329110855.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 11:08:55,393 - INFO - Chain [1] start processing
2025-03-29 11:08:55,463 - INFO - Chain [1] done processing
2025-03-29 11:08:55,488 - INFO - Training Prophet model for New Territories...
2025-03-29 11:08:55,495 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/wi59gdul.json
2025-03-29 11:08:55,499 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/4hut7byu.json
2025-03-29 11:08:55,499 - DEBUG - idx 0
2025-03-29 11:08:55,499 - DEBUG - running CmdStan, num_threads: None
2025-03-29 11:08:55,499 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=17998', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/wi59gdul.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/4hut7byu.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelq99k311f/prophet_model-20250329110855.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 11:08:55,499 - INFO - Chain [1] start processing
2025-03-29 11:08:55,549 - INFO - Chain [1] done processing
2025-03-29 11:08:55,572 - INFO - Evaluating new model (MLP + LightGBM + Prophet)...
2025-03-29 11:08:55,579 - INFO - Ensemble Hong Kong - RMSE: 83633.11 HKD/m², MAE: 60569.07 HKD/m², MAPE: 13.90%, R²: 0.6281
2025-03-29 11:08:55,580 - INFO - Ensemble Kowloon - RMSE: 65692.54 HKD/m², MAE: 49037.59 HKD/m², MAPE: 13.71%, R²: 0.4075
2025-03-29 11:08:55,580 - INFO - Ensemble New Territories - RMSE: 53745.21 HKD/m², MAE: 40522.84 HKD/m², MAPE: 11.46%, R²: 0.6370
2025-03-29 11:08:55,639 - ERROR - Error in main execution: X has 15 features, but MinMaxScaler is expecting 67 features as input.
2025-03-29 11:12:05,525 - INFO - Processing new data...
2025-03-29 11:12:05,527 - INFO - Loading data files...
2025-03-29 11:12:05,587 - INFO - Merging datasets...
2025-03-29 11:12:05,597 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 11:12:05,604 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 11:12:05,633 - INFO - Performing feature selection with LightGBM...
2025-03-29 11:12:05,707 - INFO - Selected features after feature selection: ['Yield_D', 'Month', 'Price_Kowloon_lag_1', 'Yield_E', 'Price_New_Territories_change', 'D_New Territories', 'Price_New_Territories_lag_1', 'Yield_B', 'Rent_Kowloon', 'Rent_Hong_Kong', 'Yield_C', 'Year', 'Secondary_Sales_Consideration', 'Price_Hong_Kong_lag_1', 'Price_Hong_Kong_change']
2025-03-29 11:12:05,712 - INFO - Using device: cpu
2025-03-29 11:12:05,723 - INFO - Training MLP model for Hong Kong...
2025-03-29 11:12:05,878 - INFO - Training MLP model for Kowloon...
2025-03-29 11:12:05,907 - INFO - Training MLP model for New Territories...
2025-03-29 11:12:05,920 - INFO - Training LightGBM model for Hong Kong...
2025-03-29 11:12:05,939 - INFO - Training LightGBM model for Kowloon...
2025-03-29 11:12:05,953 - INFO - Training LightGBM model for New Territories...
2025-03-29 11:12:05,971 - INFO - Training Prophet model for Hong Kong...
2025-03-29 11:12:05,993 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/0ftndxdw.json
2025-03-29 11:12:05,998 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/qr9ao7e9.json
2025-03-29 11:12:06,002 - DEBUG - idx 0
2025-03-29 11:12:06,002 - DEBUG - running CmdStan, num_threads: None
2025-03-29 11:12:06,002 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=11479', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/0ftndxdw.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/qr9ao7e9.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modeln3mmf4jt/prophet_model-20250329111206.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 11:12:06,002 - INFO - Chain [1] start processing
2025-03-29 11:12:06,072 - INFO - Chain [1] done processing
2025-03-29 11:12:06,102 - INFO - Training Prophet model for Kowloon...
2025-03-29 11:12:06,109 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/9xr4nxyk.json
2025-03-29 11:12:06,113 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/qxhi7tx3.json
2025-03-29 11:12:06,114 - DEBUG - idx 0
2025-03-29 11:12:06,114 - DEBUG - running CmdStan, num_threads: None
2025-03-29 11:12:06,114 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=99182', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/9xr4nxyk.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/qxhi7tx3.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelckapvjdg/prophet_model-20250329111206.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 11:12:06,114 - INFO - Chain [1] start processing
2025-03-29 11:12:06,175 - INFO - Chain [1] done processing
2025-03-29 11:12:06,234 - INFO - Training Prophet model for New Territories...
2025-03-29 11:12:06,239 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/_p4earet.json
2025-03-29 11:12:06,243 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/s27m6el7.json
2025-03-29 11:12:06,244 - DEBUG - idx 0
2025-03-29 11:12:06,244 - DEBUG - running CmdStan, num_threads: None
2025-03-29 11:12:06,244 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=73138', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/_p4earet.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/s27m6el7.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelhvaytckv/prophet_model-20250329111206.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 11:12:06,244 - INFO - Chain [1] start processing
2025-03-29 11:12:06,292 - INFO - Chain [1] done processing
2025-03-29 11:12:06,315 - INFO - Evaluating new model (MLP + LightGBM + Prophet)...
2025-03-29 11:12:06,322 - INFO - Ensemble Hong Kong - RMSE: 81170.28 HKD/m², MAE: 61447.38 HKD/m², MAPE: 14.07%, R²: 0.6497
2025-03-29 11:12:06,323 - INFO - Ensemble Kowloon - RMSE: 71936.26 HKD/m², MAE: 53321.86 HKD/m², MAPE: 14.85%, R²: 0.2895
2025-03-29 11:12:06,323 - INFO - Ensemble New Territories - RMSE: 53440.55 HKD/m², MAE: 40572.06 HKD/m², MAPE: 11.43%, R²: 0.6411
2025-03-29 11:12:06,377 - ERROR - Error in main execution: X has 22 features, but MinMaxScaler is expecting 15 features as input.
2025-03-29 11:15:50,304 - INFO - Processing new data...
2025-03-29 11:15:50,306 - INFO - Loading data files...
2025-03-29 11:15:50,354 - INFO - Merging datasets...
2025-03-29 11:15:50,363 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 11:15:50,369 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 11:15:50,393 - INFO - Performing feature selection with LightGBM...
2025-03-29 11:15:50,464 - INFO - Selected features after feature selection: ['Yield_D', 'Month', 'Price_Kowloon_lag_1', 'Yield_E', 'Price_New_Territories_change', 'D_New Territories', 'Price_New_Territories_lag_1', 'Yield_B', 'Rent_Kowloon', 'Rent_Hong_Kong', 'Yield_C', 'Year', 'Secondary_Sales_Consideration', 'Price_Hong_Kong_lag_1', 'Price_Hong_Kong_change']
2025-03-29 11:15:50,476 - INFO - Using device: cpu
2025-03-29 11:15:50,490 - INFO - Training MLP model for Hong Kong...
2025-03-29 11:15:50,593 - INFO - Training MLP model for Kowloon...
2025-03-29 11:15:50,617 - INFO - Training MLP model for New Territories...
2025-03-29 11:15:50,635 - INFO - Training LightGBM model for Hong Kong...
2025-03-29 11:15:50,660 - INFO - Training LightGBM model for Kowloon...
2025-03-29 11:15:50,671 - INFO - Training LightGBM model for New Territories...
2025-03-29 11:15:50,681 - INFO - Training Prophet model for Hong Kong...
2025-03-29 11:15:50,702 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/wb7ddqci.json
2025-03-29 11:15:50,706 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/sedo1ut0.json
2025-03-29 11:15:50,711 - DEBUG - idx 0
2025-03-29 11:15:50,712 - DEBUG - running CmdStan, num_threads: None
2025-03-29 11:15:50,712 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=30998', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/wb7ddqci.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/sedo1ut0.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modele_eqrpm1/prophet_model-20250329111550.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 11:15:50,712 - INFO - Chain [1] start processing
2025-03-29 11:15:50,782 - INFO - Chain [1] done processing
2025-03-29 11:15:50,819 - INFO - Training Prophet model for Kowloon...
2025-03-29 11:15:50,825 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/harfc3q7.json
2025-03-29 11:15:50,829 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/93k62o8d.json
2025-03-29 11:15:50,830 - DEBUG - idx 0
2025-03-29 11:15:50,830 - DEBUG - running CmdStan, num_threads: None
2025-03-29 11:15:50,830 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=45692', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/harfc3q7.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/93k62o8d.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelb_ng58f2/prophet_model-20250329111550.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 11:15:50,830 - INFO - Chain [1] start processing
2025-03-29 11:15:50,886 - INFO - Chain [1] done processing
2025-03-29 11:15:50,912 - INFO - Training Prophet model for New Territories...
2025-03-29 11:15:50,917 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/jwb7rtc8.json
2025-03-29 11:15:50,922 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/s0f9ume2.json
2025-03-29 11:15:50,922 - DEBUG - idx 0
2025-03-29 11:15:50,922 - DEBUG - running CmdStan, num_threads: None
2025-03-29 11:15:50,922 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=4442', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/jwb7rtc8.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/s0f9ume2.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modeldkngqbnt/prophet_model-20250329111550.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 11:15:50,922 - INFO - Chain [1] start processing
2025-03-29 11:15:50,976 - INFO - Chain [1] done processing
2025-03-29 11:15:51,002 - INFO - Evaluating new model (MLP + LightGBM + Prophet)...
2025-03-29 11:15:51,009 - INFO - Ensemble Hong Kong - RMSE: 83422.00 HKD/m², MAE: 63550.26 HKD/m², MAPE: 14.50%, R²: 0.6300
2025-03-29 11:15:51,009 - INFO - Ensemble Kowloon - RMSE: 75077.53 HKD/m², MAE: 54089.80 HKD/m², MAPE: 15.28%, R²: 0.2261
2025-03-29 11:15:51,010 - INFO - Ensemble New Territories - RMSE: 53567.11 HKD/m², MAE: 39615.22 HKD/m², MAPE: 11.23%, R²: 0.6394
2025-03-29 11:15:51,070 - ERROR - Error in main execution: X has 22 features, but MinMaxScaler is expecting 15 features as input.
2025-03-29 11:35:09,823 - INFO - Processing new data...
2025-03-29 11:35:09,825 - INFO - Loading data files...
2025-03-29 11:35:09,920 - INFO - Merging datasets...
2025-03-29 11:35:09,930 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 11:35:09,935 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 11:35:09,967 - INFO - Performing feature selection with mutual information...
2025-03-29 11:35:09,967 - ERROR - Error in preprocessing data: Input X contains NaN.
2025-03-29 11:35:09,967 - ERROR - Error in main execution: Input X contains NaN.
2025-03-29 11:39:42,124 - INFO - Processing new data...
2025-03-29 11:39:42,146 - INFO - Loading data files...
2025-03-29 11:39:42,204 - INFO - Merging datasets...
2025-03-29 11:39:42,213 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 11:39:42,217 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 11:39:42,226 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 11:39:42,253 - INFO - Performing feature selection with mutual information...
2025-03-29 11:39:42,363 - INFO - Selected features after feature selection: ['E_Kowloon', 'Index_E', 'Yield_C', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'Year', 'B_Hong Kong']
2025-03-29 11:39:42,373 - INFO - Using device: cpu
2025-03-29 11:39:42,374 - INFO - Training GRU model for Hong Kong...
2025-03-29 11:39:46,040 - INFO - Best params for Hong Kong: {'hidden_dim': 33, 'num_layers': 3, 'lr': 0.0064764182227143, 'batch_size': 16}
2025-03-29 11:39:46,173 - INFO - Training GRU model for Kowloon...
2025-03-29 11:39:49,293 - INFO - Best params for Kowloon: {'hidden_dim': 61, 'num_layers': 2, 'lr': 0.0009307639925741251, 'batch_size': 8}
2025-03-29 11:39:49,501 - INFO - Training GRU model for New Territories...
2025-03-29 11:39:52,571 - INFO - Best params for New Territories: {'hidden_dim': 64, 'num_layers': 2, 'lr': 0.0020927166725299333, 'batch_size': 8}
2025-03-29 11:39:57,767 - ERROR - Error in main execution: A task has failed to un-serialize. Please ensure that the arguments of the function are all picklable.
2025-03-29 11:44:34,779 - INFO - Processing new data...
2025-03-29 11:44:34,781 - INFO - Loading data files...
2025-03-29 11:44:34,819 - INFO - Merging datasets...
2025-03-29 11:44:34,828 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 11:44:34,831 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 11:44:34,836 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 11:44:34,865 - INFO - Performing feature selection with mutual information...
2025-03-29 11:44:34,906 - INFO - Selected features after feature selection: ['Index_C', 'Index_E', 'Yield_C', 'Yield_B', 'C_Hong Kong', 'B_Hong Kong', 'Real_Interest_Rate', 'Year']
2025-03-29 11:44:34,912 - INFO - Using device: cpu
2025-03-29 11:44:34,913 - INFO - Training GRU model for Hong Kong...
2025-03-29 11:44:38,751 - INFO - Best params for Hong Kong: {'hidden_dim': 30, 'num_layers': 3, 'lr': 0.0008879467209974831, 'batch_size': 8}
2025-03-29 11:44:39,031 - INFO - Training GRU model for Kowloon...
2025-03-29 11:44:41,613 - INFO - Best params for Kowloon: {'hidden_dim': 16, 'num_layers': 1, 'lr': 0.0035293739456167083, 'batch_size': 8}
2025-03-29 11:44:41,732 - INFO - Training GRU model for New Territories...
2025-03-29 11:44:44,182 - INFO - Best params for New Territories: {'hidden_dim': 35, 'num_layers': 3, 'lr': 0.0009225901524952666, 'batch_size': 8}
2025-03-29 11:44:44,405 - INFO - Training LightGBM model for Hong Kong...
2025-03-29 11:44:44,875 - INFO - Best params for Hong Kong: {'n_estimators': 46, 'learning_rate': 0.06395002389759655, 'max_depth': 5, 'min_data_in_leaf': 7, 'num_leaves': 8, 'subsample': 0.6303981548831922, 'colsample_bytree': 0.7451031445045491}
2025-03-29 11:44:44,886 - INFO - Training LightGBM model for Kowloon...
2025-03-29 11:44:45,375 - INFO - Best params for Kowloon: {'n_estimators': 63, 'learning_rate': 0.05099743682149195, 'max_depth': 5, 'min_data_in_leaf': 4, 'num_leaves': 18, 'subsample': 0.7280389291575493, 'colsample_bytree': 0.5966434403332865}
2025-03-29 11:44:45,388 - INFO - Training LightGBM model for New Territories...
2025-03-29 11:44:45,834 - INFO - Best params for New Territories: {'n_estimators': 24, 'learning_rate': 0.08838783825415467, 'max_depth': 6, 'min_data_in_leaf': 7, 'num_leaves': 15, 'subsample': 0.7773324826004889, 'colsample_bytree': 0.9959128276725676}
2025-03-29 11:44:46,754 - ERROR - Error in main execution: A task has failed to un-serialize. Please ensure that the arguments of the function are all picklable.
2025-03-29 11:49:19,861 - INFO - Processing new data...
2025-03-29 11:49:19,864 - INFO - Loading data files...
2025-03-29 11:49:19,918 - INFO - Merging datasets...
2025-03-29 11:49:19,925 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 11:49:19,928 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 11:49:19,948 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 11:49:19,973 - INFO - Performing feature selection with mutual information...
2025-03-29 11:49:20,014 - INFO - Selected features after feature selection: ['Yield_C', 'Yield_A', 'Index_E', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'B_Hong Kong', 'Year']
2025-03-29 11:49:20,020 - INFO - Using device: cpu
2025-03-29 11:49:20,021 - INFO - Training GRU model for Hong Kong...
2025-03-29 11:49:22,885 - INFO - Best params for Hong Kong: {'hidden_dim': 27, 'num_layers': 2, 'lr': 0.004481018278052598, 'batch_size': 16}
2025-03-29 11:49:22,980 - INFO - Training GRU model for Kowloon...
2025-03-29 11:49:25,647 - INFO - Best params for Kowloon: {'hidden_dim': 37, 'num_layers': 2, 'lr': 0.003112270719927926, 'batch_size': 16}
2025-03-29 11:49:25,742 - INFO - Training GRU model for New Territories...
2025-03-29 11:49:28,712 - INFO - Best params for New Territories: {'hidden_dim': 48, 'num_layers': 2, 'lr': 0.003442319461697561, 'batch_size': 8}
2025-03-29 11:49:38,550 - INFO - Evaluating new model (GRU + Prophet)...
2025-03-29 11:49:38,572 - INFO - Ensemble Hong Kong - RMSE: 123061.88 HKD/m², MAE: 100133.62 HKD/m², MAPE: 22.94%, R²: 0.1949
2025-03-29 11:49:38,572 - INFO - Ensemble Hong Kong - 90% CI: [351277.98, 544772.57]
2025-03-29 11:49:38,572 - INFO - Ensemble Kowloon - RMSE: 70117.63 HKD/m², MAE: 49564.93 HKD/m², MAPE: 13.98%, R²: 0.3249
2025-03-29 11:49:38,572 - INFO - Ensemble Kowloon - 90% CI: [260550.94, 421970.40]
2025-03-29 11:49:38,572 - INFO - Ensemble New Territories - RMSE: 78944.68 HKD/m², MAE: 63357.07 HKD/m², MAPE: 18.54%, R²: 0.2169
2025-03-29 11:49:38,572 - INFO - Ensemble New Territories - 90% CI: [282812.11, 414970.42]
2025-03-29 11:49:38,686 - ERROR - Error in main execution: X has 11 features, but MinMaxScaler is expecting 8 features as input.
2025-03-29 12:03:04,490 - INFO - Processing new data...
2025-03-29 12:03:04,494 - INFO - Loading data files...
2025-03-29 12:03:04,621 - INFO - Merging datasets...
2025-03-29 12:03:04,682 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 12:03:04,707 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 12:03:04,713 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 12:03:04,761 - INFO - Performing feature selection with mutual information...
2025-03-29 12:03:04,826 - INFO - Selected features after feature selection: ['Index_C', 'Yield_C', 'Yield_B', 'Index_E', 'Year', 'Real_Interest_Rate', 'C_Hong Kong', 'B_Hong Kong']
2025-03-29 12:03:04,826 - INFO - Applying PCA to reduce features to 6 dimensions...
2025-03-29 12:03:04,841 - INFO - Using device: cpu
2025-03-29 12:03:04,841 - INFO - Training Transformer model for Hong Kong...
2025-03-29 12:03:05,255 - INFO - Training Transformer model for Kowloon...
2025-03-29 12:03:05,419 - INFO - Training Transformer model for New Territories...
2025-03-29 12:03:07,400 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 12:03:07,407 - INFO - Ensemble Hong Kong - RMSE: 215170641617.08 HKD/m², MAE: 214491051460.46 HKD/m², MAPE: 50593141.35%, R²: -2461464259664.6357
2025-03-29 12:03:07,407 - INFO - Ensemble Hong Kong - 90% CI: [188189671259.80, 240476365378.05]
2025-03-29 12:03:07,407 - INFO - Ensemble Kowloon - RMSE: 113887716150.15 HKD/m², MAE: 113604293026.30 HKD/m², MAPE: 32653665.58%, R²: -1780900018838.2219
2025-03-29 12:03:07,407 - INFO - Ensemble Kowloon - 90% CI: [100854990366.85, 125621003239.46]
2025-03-29 12:03:07,408 - INFO - Ensemble New Territories - RMSE: 108237868658.92 HKD/m², MAE: 107896069245.04 HKD/m², MAPE: 31430928.15%, R²: -1472102925087.0835
2025-03-29 12:03:07,408 - INFO - Ensemble New Territories - 90% CI: [94944547124.70, 120761756953.68]
2025-03-29 12:03:07,487 - ERROR - Error in main execution: X has 8 features, but MinMaxScaler is expecting 6 features as input.
2025-03-29 12:10:55,290 - INFO - Processing new data...
2025-03-29 12:10:55,295 - INFO - Loading data files...
2025-03-29 12:10:55,531 - INFO - Merging datasets...
2025-03-29 12:10:55,547 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 12:10:55,572 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 12:10:55,594 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 12:10:55,665 - INFO - Performing feature selection with mutual information...
2025-03-29 12:10:55,717 - INFO - Selected features after feature selection: ['E_Kowloon', 'Yield_C', 'Index_E', 'C_Hong Kong', 'Real_Interest_Rate', 'Yield_B', 'Year', 'B_Hong Kong']
2025-03-29 12:10:55,718 - INFO - Applying PCA to reduce features to 6 dimensions...
2025-03-29 12:10:55,735 - INFO - Using device: cpu
2025-03-29 12:10:55,735 - INFO - Training Transformer model for Hong Kong...
2025-03-29 12:10:56,178 - INFO - Training Transformer model for Kowloon...
2025-03-29 12:10:56,298 - INFO - Training Transformer model for New Territories...
2025-03-29 12:10:58,344 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 12:10:58,352 - INFO - Ensemble Hong Kong - RMSE: 215170641299.90 HKD/m², MAE: 214491051262.55 HKD/m², MAPE: 50593140.37%, R²: -2461464252407.8311
2025-03-29 12:10:58,352 - INFO - Ensemble Hong Kong - 90% CI: [188225603515.40, 240208131839.01]
2025-03-29 12:10:58,352 - INFO - Ensemble Kowloon - RMSE: 113887737497.17 HKD/m², MAE: 113604315479.46 HKD/m², MAPE: 32653671.52%, R²: -1780900686459.2427
2025-03-29 12:10:58,352 - INFO - Ensemble Kowloon - 90% CI: [100986170978.79, 125495878042.99]
2025-03-29 12:10:58,353 - INFO - Ensemble New Territories - RMSE: 108237879675.40 HKD/m², MAE: 107896081184.30 HKD/m², MAPE: 31430931.27%, R²: -1472103224749.2473
2025-03-29 12:10:58,353 - INFO - Ensemble New Territories - 90% CI: [95128483347.88, 120719346816.00]
2025-03-29 12:10:58,361 - INFO - Features shape before PCA: (8,)
2025-03-29 12:10:58,444 - ERROR - Error in main execution: X has 11 features, but PCA is expecting 8 features as input.
2025-03-29 12:15:02,335 - INFO - Processing new data...
2025-03-29 12:15:02,337 - INFO - Loading data files...
2025-03-29 12:15:02,400 - INFO - Merging datasets...
2025-03-29 12:15:02,410 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 12:15:02,413 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 12:15:02,420 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 12:15:02,449 - INFO - Performing feature selection with mutual information...
2025-03-29 12:15:02,493 - INFO - Selected features after feature selection: ['Index_C', 'Yield_C', 'Yield_B', 'Index_E', 'C_Hong Kong', 'Real_Interest_Rate', 'B_Hong Kong', 'Year']
2025-03-29 12:15:02,493 - INFO - Applying PCA to reduce features to 6 dimensions...
2025-03-29 12:15:02,512 - INFO - Using device: cpu
2025-03-29 12:15:02,512 - INFO - Training Transformer model for Hong Kong...
2025-03-29 12:15:02,923 - INFO - Training Transformer model for Kowloon...
2025-03-29 12:15:03,080 - INFO - Training Transformer model for New Territories...
2025-03-29 12:15:03,811 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 12:15:03,818 - INFO - Ensemble Hong Kong - RMSE: 215170632012.48 HKD/m², MAE: 214491044330.43 HKD/m², MAPE: 50593137.64%, R²: -2461464039919.3262
2025-03-29 12:15:03,818 - INFO - Ensemble Hong Kong - 90% CI: [188238077959.17, 240363873696.37]
2025-03-29 12:15:03,819 - INFO - Ensemble Kowloon - RMSE: 113887762785.25 HKD/m², MAE: 113604338414.27 HKD/m², MAPE: 32653679.09%, R²: -1780901477335.5491
2025-03-29 12:15:03,819 - INFO - Ensemble Kowloon - 90% CI: [101071548680.66, 125429472762.29]
2025-03-29 12:15:03,819 - INFO - Ensemble New Territories - RMSE: 108237858061.04 HKD/m², MAE: 107896058017.25 HKD/m², MAPE: 31430925.11%, R²: -1472102636811.5198
2025-03-29 12:15:03,819 - INFO - Ensemble New Territories - 90% CI: [95154237518.63, 120476446754.69]
2025-03-29 12:15:03,828 - INFO - Features shape before PCA: (8,)
2025-03-29 12:15:03,903 - ERROR - Error in main execution: X has 11 features, but PCA is expecting 8 features as input.
2025-03-29 12:19:06,028 - INFO - Processing new data...
2025-03-29 12:19:06,041 - INFO - Loading data files...
2025-03-29 12:19:06,194 - INFO - Merging datasets...
2025-03-29 12:19:06,204 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 12:19:06,208 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 12:19:06,216 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 12:19:06,251 - INFO - Performing feature selection with mutual information...
2025-03-29 12:19:06,315 - INFO - Selected features after feature selection: ['E_Kowloon', 'Index_E', 'Yield_C', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'Year', 'B_Hong Kong']
2025-03-29 12:19:06,315 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'E_Kowloon', 'Index_E', 'Yield_C', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'Year', 'B_Hong Kong']
2025-03-29 12:19:06,316 - INFO - Applying PCA to reduce features to 6 dimensions...
2025-03-29 12:19:06,325 - INFO - Using device: cpu
2025-03-29 12:19:06,325 - INFO - Training Transformer model for Hong Kong...
2025-03-29 12:19:06,623 - INFO - Training Transformer model for Kowloon...
2025-03-29 12:19:06,762 - INFO - Training Transformer model for New Territories...
2025-03-29 12:19:07,347 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 12:19:07,353 - INFO - Ensemble Hong Kong - RMSE: 215170618777.19 HKD/m², MAE: 214491027012.47 HKD/m², MAPE: 50593135.91%, R²: -2461463737106.7212
2025-03-29 12:19:07,353 - INFO - Ensemble Hong Kong - 90% CI: [187840805169.62, 240283934385.02]
2025-03-29 12:19:07,353 - INFO - Ensemble Kowloon - RMSE: 113887717669.98 HKD/m², MAE: 113604294375.28 HKD/m², MAPE: 32653665.91%, R²: -1780900066370.3870
2025-03-29 12:19:07,353 - INFO - Ensemble Kowloon - 90% CI: [100914634584.36, 125428803303.02]
2025-03-29 12:19:07,354 - INFO - Ensemble New Territories - RMSE: 108237841079.91 HKD/m², MAE: 107896041444.35 HKD/m², MAPE: 31430920.16%, R²: -1472102174903.7124
2025-03-29 12:19:07,354 - INFO - Ensemble New Territories - 90% CI: [95121981797.12, 120477590959.15]
2025-03-29 12:19:07,362 - INFO - Features shape before PCA: (8,)
2025-03-29 12:19:07,467 - ERROR - Error in main execution: X has 11 features, but PCA is expecting 8 features as input.
2025-03-29 12:22:39,758 - INFO - Processing new data...
2025-03-29 12:22:39,761 - INFO - Loading data files...
2025-03-29 12:22:39,916 - INFO - Merging datasets...
2025-03-29 12:22:40,000 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 12:22:40,015 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 12:22:40,075 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 12:22:40,097 - INFO - Number of selected features before feature selection: 57
2025-03-29 12:22:40,143 - INFO - Performing feature selection with mutual information...
2025-03-29 12:22:40,212 - INFO - Selected features after feature selection: ['Index_C', 'Yield_C', 'Index_E', 'Yield_B', 'C_Hong Kong', 'Real_Interest_Rate', 'Year', 'B_Hong Kong']
2025-03-29 12:22:40,212 - INFO - Number of selected features after feature selection: 8
2025-03-29 12:22:40,215 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Index_C', 'Yield_C', 'Index_E', 'Yield_B', 'C_Hong Kong', 'Real_Interest_Rate', 'Year', 'B_Hong Kong']
2025-03-29 12:22:40,215 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 12:22:40,215 - INFO - Applying PCA to reduce features to 6 dimensions...
2025-03-29 12:22:40,226 - INFO - Using device: cpu
2025-03-29 12:22:40,228 - INFO - Training Transformer model for Hong Kong...
2025-03-29 12:22:40,848 - INFO - Training Transformer model for Kowloon...
2025-03-29 12:22:40,989 - INFO - Training Transformer model for New Territories...
2025-03-29 12:22:41,545 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 12:22:41,555 - INFO - Ensemble Hong Kong - RMSE: 215170678884.08 HKD/m², MAE: 214491089968.07 HKD/m², MAPE: 50593149.02%, R²: -2461465112303.1484
2025-03-29 12:22:41,555 - INFO - Ensemble Hong Kong - 90% CI: [188009159718.40, 240385766010.22]
2025-03-29 12:22:41,555 - INFO - Ensemble Kowloon - RMSE: 113887750877.76 HKD/m², MAE: 113604328388.65 HKD/m², MAPE: 32653675.38%, R²: -1780901104932.6951
2025-03-29 12:22:41,555 - INFO - Ensemble Kowloon - 90% CI: [101105703175.45, 125486343885.97]
2025-03-29 12:22:41,556 - INFO - Ensemble New Territories - RMSE: 108237883778.33 HKD/m², MAE: 107896085237.84 HKD/m², MAPE: 31430932.35%, R²: -1472103336354.1594
2025-03-29 12:22:41,556 - INFO - Ensemble New Territories - 90% CI: [95103292763.36, 120452167122.15]
2025-03-29 12:22:41,568 - INFO - Features shape before PCA: (8,)
2025-03-29 12:22:41,568 - INFO - Number of selected features in predict_future: 8
2025-03-29 12:22:41,658 - ERROR - Error in main execution: X has 11 features, but PCA is expecting 8 features as input.
2025-03-29 12:26:48,620 - INFO - Processing new data...
2025-03-29 12:26:48,623 - INFO - Loading data files...
2025-03-29 12:26:48,713 - INFO - Merging datasets...
2025-03-29 12:26:48,725 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 12:26:48,759 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 12:26:48,775 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 12:26:48,788 - INFO - Number of selected features before feature selection: 57
2025-03-29 12:26:48,815 - INFO - Performing feature selection with mutual information...
2025-03-29 12:26:48,874 - INFO - Selected features after feature selection: ['Index_C', 'Yield_C', 'Index_E', 'C_Hong Kong', 'Yield_B', 'Real_Interest_Rate', 'B_Hong Kong', 'Year']
2025-03-29 12:26:48,874 - INFO - Number of selected features after feature selection: 8
2025-03-29 12:26:48,875 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Index_C', 'Yield_C', 'Index_E', 'C_Hong Kong', 'Yield_B', 'Real_Interest_Rate', 'B_Hong Kong', 'Year']
2025-03-29 12:26:48,875 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 12:26:48,879 - INFO - Using device: cpu
2025-03-29 12:26:48,880 - INFO - Training Transformer model for Hong Kong...
2025-03-29 12:26:49,128 - INFO - Training Transformer model for Kowloon...
2025-03-29 12:26:49,308 - INFO - Training Transformer model for New Territories...
2025-03-29 12:26:49,914 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 12:26:49,921 - INFO - Ensemble Hong Kong - RMSE: 215170734911.38 HKD/m², MAE: 214491144811.35 HKD/m², MAPE: 50593162.57%, R²: -2461466394162.4399
2025-03-29 12:26:49,921 - INFO - Ensemble Hong Kong - 90% CI: [187960394596.01, 240312806842.14]
2025-03-29 12:26:49,921 - INFO - Ensemble Kowloon - RMSE: 113887778528.14 HKD/m², MAE: 113604355299.05 HKD/m², MAPE: 32653683.35%, R²: -1780901969689.4448
2025-03-29 12:26:49,921 - INFO - Ensemble Kowloon - 90% CI: [100875003252.30, 125310615898.52]
2025-03-29 12:26:49,922 - INFO - Ensemble New Territories - RMSE: 108237950126.93 HKD/m², MAE: 107896149700.61 HKD/m², MAPE: 31430951.87%, R²: -1472105141120.2246
2025-03-29 12:26:49,922 - INFO - Ensemble New Territories - 90% CI: [95061163411.47, 120640540778.15]
2025-03-29 12:26:49,929 - INFO - Features shape: (8,)
2025-03-29 12:26:49,929 - INFO - Number of selected features in predict_future: 8
2025-03-29 12:26:50,011 - ERROR - Error in main execution: X has 11 features, but MinMaxScaler is expecting 8 features as input.
2025-03-29 12:30:10,106 - INFO - Processing new data...
2025-03-29 12:30:10,109 - INFO - Loading data files...
2025-03-29 12:30:10,415 - INFO - Merging datasets...
2025-03-29 12:30:10,566 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 12:30:10,618 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 12:30:10,696 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 12:30:10,740 - INFO - Number of selected features before feature selection: 57
2025-03-29 12:30:10,833 - INFO - Performing feature selection with mutual information...
2025-03-29 12:30:10,895 - INFO - Selected features after feature selection: ['C_Kowloon', 'Index_C', 'Yield_B', 'Index_E', 'C_Hong Kong', 'Real_Interest_Rate', 'B_Hong Kong', 'Year']
2025-03-29 12:30:10,895 - INFO - Number of selected features after feature selection: 8
2025-03-29 12:30:10,896 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'C_Kowloon', 'Index_C', 'Yield_B', 'Index_E', 'C_Hong Kong', 'Real_Interest_Rate', 'B_Hong Kong', 'Year']
2025-03-29 12:30:10,896 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 12:30:10,903 - INFO - Using device: cpu
2025-03-29 12:30:10,903 - INFO - Training Transformer model for Hong Kong...
2025-03-29 12:30:11,158 - INFO - Training Transformer model for Kowloon...
2025-03-29 12:30:11,312 - INFO - Training Transformer model for New Territories...
2025-03-29 12:30:11,862 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 12:30:11,874 - INFO - Ensemble Hong Kong - RMSE: 215170701582.58 HKD/m², MAE: 214491111314.34 HKD/m², MAPE: 50593154.72%, R²: -2461465631626.5747
2025-03-29 12:30:11,874 - INFO - Ensemble Hong Kong - 90% CI: [188058124355.89, 240356361333.21]
2025-03-29 12:30:11,874 - INFO - Ensemble Kowloon - RMSE: 113887789895.38 HKD/m², MAE: 113604366529.80 HKD/m², MAPE: 32653686.66%, R²: -1780902325196.0999
2025-03-29 12:30:11,874 - INFO - Ensemble Kowloon - 90% CI: [100953714392.22, 125389155182.67]
2025-03-29 12:30:11,875 - INFO - Ensemble New Territories - RMSE: 108237934106.98 HKD/m², MAE: 107896134062.54 HKD/m², MAPE: 31430947.25%, R²: -1472104705357.1792
2025-03-29 12:30:11,875 - INFO - Ensemble New Territories - 90% CI: [95026447556.61, 120628280405.01]
2025-03-29 12:30:11,886 - INFO - Features shape: (8,)
2025-03-29 12:30:11,886 - INFO - Number of selected features in predict_future: 8
2025-03-29 12:30:11,980 - ERROR - Error in main execution: X has 11 features, but MinMaxScaler is expecting 8 features as input.
2025-03-29 12:33:59,987 - INFO - Processing new data...
2025-03-29 12:33:59,991 - INFO - Loading data files...
2025-03-29 12:34:00,146 - INFO - Merging datasets...
2025-03-29 12:34:00,175 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 12:34:00,181 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 12:34:00,208 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 12:34:00,224 - INFO - Number of selected features before feature selection: 57
2025-03-29 12:34:00,259 - INFO - Performing feature selection with mutual information...
2025-03-29 12:34:00,317 - INFO - Selected features after feature selection: ['Yield_C', 'Yield_A', 'Index_E', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'B_Hong Kong', 'Year']
2025-03-29 12:34:00,317 - INFO - Number of selected features after feature selection: 8
2025-03-29 12:34:00,318 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Yield_C', 'Yield_A', 'Index_E', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'B_Hong Kong', 'Year']
2025-03-29 12:34:00,318 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 12:34:00,323 - INFO - Using device: cpu
2025-03-29 12:34:00,323 - INFO - Training Transformer model for Hong Kong...
2025-03-29 12:34:00,611 - INFO - Training Transformer model for Kowloon...
2025-03-29 12:34:00,730 - INFO - Training Transformer model for New Territories...
2025-03-29 12:34:01,289 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 12:34:01,296 - INFO - Ensemble Hong Kong - RMSE: 215170740207.03 HKD/m², MAE: 214491150177.11 HKD/m², MAPE: 50593163.73%, R²: -2461466515322.7002
2025-03-29 12:34:01,296 - INFO - Ensemble Hong Kong - 90% CI: [187965518094.86, 240486640651.93]
2025-03-29 12:34:01,296 - INFO - Ensemble Kowloon - RMSE: 113887803495.44 HKD/m², MAE: 113604380358.27 HKD/m², MAPE: 32653690.53%, R²: -1780902750533.6787
2025-03-29 12:34:01,296 - INFO - Ensemble Kowloon - 90% CI: [100791438730.57, 125587140635.17]
2025-03-29 12:34:01,297 - INFO - Ensemble New Territories - RMSE: 108237931207.24 HKD/m², MAE: 107896131230.24 HKD/m², MAPE: 31430946.27%, R²: -1472104626480.3433
2025-03-29 12:34:01,297 - INFO - Ensemble New Territories - 90% CI: [94873587004.02, 120726699599.27]
2025-03-29 12:34:01,302 - INFO - Features shape: (8,)
2025-03-29 12:34:01,302 - INFO - Number of selected features in predict_future: 8
2025-03-29 12:34:01,424 - ERROR - Error in main execution: X has 11 features, but MinMaxScaler is expecting 8 features as input.
2025-03-29 12:39:33,204 - INFO - Processing new data...
2025-03-29 12:39:33,209 - INFO - Loading data files...
2025-03-29 12:39:33,352 - INFO - Merging datasets...
2025-03-29 12:39:33,369 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 12:39:33,383 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 12:39:33,402 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 12:39:33,418 - INFO - Number of selected features before feature selection: 57
2025-03-29 12:39:33,462 - INFO - Performing feature selection with mutual information...
2025-03-29 12:39:33,525 - INFO - Selected features after feature selection: ['C_Kowloon', 'Yield_B', 'Yield_C', 'Index_E', 'Real_Interest_Rate', 'C_Hong Kong', 'B_Hong Kong', 'Year']
2025-03-29 12:39:33,525 - INFO - Number of selected features after feature selection: 8
2025-03-29 12:39:33,526 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'C_Kowloon', 'Yield_B', 'Yield_C', 'Index_E', 'Real_Interest_Rate', 'C_Hong Kong', 'B_Hong Kong', 'Year']
2025-03-29 12:39:33,526 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 12:39:33,534 - INFO - Using device: cpu
2025-03-29 12:39:33,534 - INFO - Training Transformer model for Hong Kong...
2025-03-29 12:39:34,158 - INFO - Training Transformer model for Kowloon...
2025-03-29 12:39:34,378 - INFO - Training Transformer model for New Territories...
2025-03-29 12:39:36,761 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 12:39:36,773 - INFO - Ensemble Hong Kong - RMSE: 215170761028.31 HKD/m², MAE: 214491170585.30 HKD/m², MAPE: 50593168.64%, R²: -2461466991696.8013
2025-03-29 12:39:36,774 - INFO - Ensemble Hong Kong - 90% CI: [187918002902.47, 240125326615.50]
2025-03-29 12:39:36,774 - INFO - Ensemble Kowloon - RMSE: 113887805361.13 HKD/m², MAE: 113604381909.38 HKD/m², MAPE: 32653691.13%, R²: -1780902808882.7993
2025-03-29 12:39:36,774 - INFO - Ensemble Kowloon - 90% CI: [100846583542.37, 125452920833.23]
2025-03-29 12:39:36,775 - INFO - Ensemble New Territories - RMSE: 108237904459.18 HKD/m², MAE: 107896104230.85 HKD/m², MAPE: 31430938.62%, R²: -1472103898899.3484
2025-03-29 12:39:36,775 - INFO - Ensemble New Territories - 90% CI: [94972676866.84, 120848310333.76]
2025-03-29 12:39:36,791 - INFO - Features shape: (8,)
2025-03-29 12:39:36,791 - INFO - Number of selected features in predict_future: 8
2025-03-29 12:39:36,791 - INFO - Features values shape after manual selection: (1, 8)
2025-03-29 12:39:37,537 - INFO - 
Future Predictions (First 12 Months):
2025-03-29 12:59:56,149 - INFO - Processing new data...
2025-03-29 12:59:56,154 - INFO - Loading data files...
2025-03-29 12:59:56,358 - INFO - Merging datasets...
2025-03-29 12:59:56,376 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 12:59:56,392 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 12:59:56,417 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 12:59:56,437 - INFO - Number of selected features before feature selection: 57
2025-03-29 12:59:56,492 - INFO - Performing feature selection with mutual information...
2025-03-29 12:59:56,545 - INFO - Selected features after feature selection: ['E_Kowloon', 'Yield_C', 'Index_E', 'C_Hong Kong', 'Real_Interest_Rate', 'Yield_B', 'Year', 'B_Hong Kong']
2025-03-29 12:59:56,546 - INFO - Number of selected features after feature selection: 8
2025-03-29 12:59:56,546 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'E_Kowloon', 'Yield_C', 'Index_E', 'C_Hong Kong', 'Real_Interest_Rate', 'Yield_B', 'Year', 'B_Hong Kong']
2025-03-29 12:59:56,546 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 12:59:56,555 - INFO - Using device: cpu
2025-03-29 12:59:56,555 - INFO - Training Transformer model for Hong Kong...
2025-03-29 12:59:56,670 - ERROR - Error in main execution: 'TransformerModel' object has no attribute 'num_layers'
2025-03-29 13:03:17,000 - INFO - Processing new data...
2025-03-29 13:03:17,003 - INFO - Loading data files...
2025-03-29 13:03:17,091 - INFO - Merging datasets...
2025-03-29 13:03:17,104 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 13:03:17,109 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 13:03:17,124 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 13:03:17,174 - INFO - Number of selected features before feature selection: 57
2025-03-29 13:03:17,263 - INFO - Performing feature selection with mutual information...
2025-03-29 13:03:17,360 - INFO - Selected features after feature selection: ['Index_C', 'Yield_A', 'Index_E', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'Year', 'B_Hong Kong']
2025-03-29 13:03:17,360 - INFO - Number of selected features after feature selection: 8
2025-03-29 13:03:17,364 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Index_C', 'Yield_A', 'Index_E', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'Year', 'B_Hong Kong']
2025-03-29 13:03:17,364 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 13:03:17,372 - INFO - Using device: cpu
2025-03-29 13:03:17,372 - INFO - Training Transformer model for Hong Kong...
2025-03-29 13:03:17,701 - INFO - Training Transformer model for Kowloon...
2025-03-29 13:03:18,017 - INFO - Training Transformer model for New Territories...
2025-03-29 13:03:20,383 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 13:03:20,397 - INFO - Ensemble Hong Kong - RMSE: 215170708704.02 HKD/m², MAE: 214491118705.69 HKD/m², MAPE: 50593156.28%, R²: -2461465794559.2427
2025-03-29 13:03:20,397 - INFO - Ensemble Hong Kong - 90% CI: [187846677433.82, 240419115649.24]
2025-03-29 13:03:20,397 - INFO - Ensemble Kowloon - RMSE: 113887786752.98 HKD/m², MAE: 113604363307.10 HKD/m², MAPE: 32653685.67%, R²: -1780902226918.7053
2025-03-29 13:03:20,397 - INFO - Ensemble Kowloon - 90% CI: [100773913562.01, 125495409408.18]
2025-03-29 13:03:20,398 - INFO - Ensemble New Territories - RMSE: 108237912631.74 HKD/m², MAE: 107896112436.53 HKD/m², MAPE: 31430940.95%, R²: -1472104121203.2754
2025-03-29 13:03:20,398 - INFO - Ensemble New Territories - 90% CI: [94943608313.20, 120731417843.45]
2025-03-29 13:03:20,406 - INFO - Features shape: (8,)
2025-03-29 13:03:20,407 - INFO - Number of selected features in predict_future: 8
2025-03-29 13:03:20,407 - INFO - Features values shape after manual selection: (1, 8)
2025-03-29 13:03:21,007 - INFO - 
Future Predictions (First 12 Months):
2025-03-29 13:07:35,783 - INFO - Processing new data...
2025-03-29 13:07:35,787 - INFO - Loading data files...
2025-03-29 13:07:35,947 - INFO - Merging datasets...
2025-03-29 13:07:35,958 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 13:07:35,964 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 13:07:35,974 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 13:07:35,987 - INFO - Number of selected features before feature selection: 57
2025-03-29 13:07:36,032 - INFO - Performing feature selection with mutual information...
2025-03-29 13:07:36,118 - INFO - Selected features after feature selection: ['Yield_C', 'E_Kowloon', 'Index_E', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'Year', 'B_Hong Kong']
2025-03-29 13:07:36,118 - INFO - Number of selected features after feature selection: 8
2025-03-29 13:07:36,119 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Yield_C', 'E_Kowloon', 'Index_E', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'Year', 'B_Hong Kong']
2025-03-29 13:07:36,119 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 13:07:36,127 - INFO - Using device: cpu
2025-03-29 13:07:36,127 - INFO - Training Transformer model for Hong Kong...
2025-03-29 13:07:36,391 - INFO - Training Transformer model for Kowloon...
2025-03-29 13:07:36,519 - INFO - Training Transformer model for New Territories...
2025-03-29 13:07:37,251 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 13:07:37,258 - INFO - Ensemble Hong Kong - RMSE: 215170724946.98 HKD/m², MAE: 214491134155.14 HKD/m², MAPE: 50593160.37%, R²: -2461466166185.0210
2025-03-29 13:07:37,258 - INFO - Ensemble Hong Kong - 90% CI: [187903783928.68, 240300271866.58]
2025-03-29 13:07:37,258 - INFO - Ensemble Kowloon - RMSE: 113887784285.50 HKD/m², MAE: 113604360784.09 HKD/m², MAPE: 32653685.05%, R²: -1780902149749.0740
2025-03-29 13:07:37,258 - INFO - Ensemble Kowloon - 90% CI: [100589078158.52, 125339343191.06]
2025-03-29 13:07:37,258 - INFO - Ensemble New Territories - RMSE: 108237917696.00 HKD/m², MAE: 107896117540.48 HKD/m², MAPE: 31430942.49%, R²: -1472104258957.4685
2025-03-29 13:07:37,258 - INFO - Ensemble New Territories - 90% CI: [94813458088.21, 120466725565.35]
2025-03-29 13:07:37,263 - INFO - Features shape: (8,)
2025-03-29 13:07:37,263 - INFO - Number of selected features in predict_future: 8
2025-03-29 13:07:37,263 - INFO - Features values shape after manual selection: (1, 8)
2025-03-29 13:07:37,811 - INFO - 
Future Predictions (First 12 Months):
2025-03-29 13:07:37,817 - INFO -          Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price
0  2025-02-01       646814.106704       592088.438474       363925.125022           592088.438474
1  2025-03-01       648531.390601       591464.632546       364083.740523           591464.632546
2  2025-04-01       645819.564557       589063.439508       365205.558943           589063.439508
3  2025-05-01       641717.513949       587120.928847       366445.451436           587120.928847
4  2025-06-01       640397.271808       586793.934328       366825.889428           586793.934328
5  2025-07-01       643242.109220       587558.317485       366210.127716           587558.317485
6  2025-08-01       647589.508400       588027.555519       365603.873689           588027.555519
7  2025-09-01       649341.255118       587657.813722       366267.877312           587657.813722
8  2025-10-01       647662.816372       587581.813583       368286.111513           587581.813583
9  2025-11-01       645517.278537       589380.460472       370688.318238           589380.460472
10 2025-12-01       646739.718471       593148.175760       372020.271294           593148.175760
11 2026-01-01       651972.971750       597394.143390       372012.481740           597394.143390
2025-03-29 13:11:32,330 - INFO - Processing new data...
2025-03-29 13:11:32,356 - INFO - Loading data files...
2025-03-29 13:11:32,480 - INFO - Merging datasets...
2025-03-29 13:11:32,491 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 13:11:32,496 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 13:11:32,507 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 13:11:32,517 - INFO - Number of selected features before feature selection: 57
2025-03-29 13:11:32,551 - INFO - Performing feature selection with mutual information...
2025-03-29 13:11:32,603 - INFO - Selected features after feature selection: ['Yield_A', 'E_Kowloon', 'Yield_B', 'Index_E', 'Real_Interest_Rate', 'C_Hong Kong', 'B_Hong Kong', 'Year']
2025-03-29 13:11:32,603 - INFO - Number of selected features after feature selection: 8
2025-03-29 13:11:32,604 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Yield_A', 'E_Kowloon', 'Yield_B', 'Index_E', 'Real_Interest_Rate', 'C_Hong Kong', 'B_Hong Kong', 'Year']
2025-03-29 13:11:32,604 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 13:11:32,611 - INFO - Using device: cpu
2025-03-29 13:11:32,611 - INFO - Training Transformer model for Hong Kong...
2025-03-29 13:11:32,919 - INFO - Training Transformer model for Kowloon...
2025-03-29 13:11:33,064 - INFO - Training Transformer model for New Territories...
2025-03-29 13:11:33,195 - INFO - Training Prophet model for Hong Kong...
2025-03-29 13:11:33,206 - INFO - Prophet train data for Hong Kong:           ds       y
0 1999-01-01  145982
1 1999-02-01  111466
2 1999-03-01  107098
3 1999-04-01  110840
4 1999-05-01  171299
2025-03-29 13:11:33,206 - INFO - Number of data points in prophet_train for Hong Kong: 234
2025-03-29 13:11:33,252 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/lv_5d_hw.json
2025-03-29 13:11:33,255 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/i4v08254.json
2025-03-29 13:11:33,259 - DEBUG - idx 0
2025-03-29 13:11:33,273 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:11:33,274 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=23532', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/lv_5d_hw.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/i4v08254.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_model4gydrvli/prophet_model-20250329131133.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:11:33,274 - INFO - Chain [1] start processing
2025-03-29 13:11:33,365 - INFO - Chain [1] done processing
2025-03-29 13:11:33,434 - INFO - Training Prophet model for Kowloon...
2025-03-29 13:11:33,437 - INFO - Prophet train data for Kowloon:           ds       y
0 1999-01-01  136973
1 1999-02-01  234150
2 1999-03-01  161751
3 1999-04-01  227823
4 1999-05-01  139793
2025-03-29 13:11:33,438 - INFO - Number of data points in prophet_train for Kowloon: 234
2025-03-29 13:11:33,524 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/6iecces0.json
2025-03-29 13:11:33,526 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/62z4mkp7.json
2025-03-29 13:11:33,527 - DEBUG - idx 0
2025-03-29 13:11:33,528 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:11:33,528 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=45144', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/6iecces0.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/62z4mkp7.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_model_56kbx4p/prophet_model-20250329131133.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:11:33,528 - INFO - Chain [1] start processing
2025-03-29 13:11:33,599 - INFO - Chain [1] done processing
2025-03-29 13:11:33,632 - INFO - Training Prophet model for New Territories...
2025-03-29 13:11:33,634 - INFO - Prophet train data for New Territories:           ds         y
0 1999-01-01  140446.0
1 1999-02-01  111028.0
2 1999-03-01  104394.0
3 1999-04-01   82195.0
4 1999-05-01  153616.0
2025-03-29 13:11:33,634 - INFO - Number of data points in prophet_train for New Territories: 234
2025-03-29 13:11:33,640 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/ly1fcuzv.json
2025-03-29 13:11:33,641 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/yzfu4g7q.json
2025-03-29 13:11:33,642 - DEBUG - idx 0
2025-03-29 13:11:33,643 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:11:33,643 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=14400', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/ly1fcuzv.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/yzfu4g7q.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_model01okt87y/prophet_model-20250329131133.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:11:33,643 - INFO - Chain [1] start processing
2025-03-29 13:11:33,701 - INFO - Chain [1] done processing
2025-03-29 13:11:33,743 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 13:11:33,750 - INFO - Ensemble Hong Kong - RMSE: 225261927517.57 HKD/m², MAE: 224452292448.78 HKD/m², MAPE: 52959183.79%, R²: -2697758666409.6865
2025-03-29 13:11:33,750 - INFO - Ensemble Hong Kong - 90% CI: [195398671204.96, 253518567036.08]
2025-03-29 13:11:33,750 - INFO - Ensemble Kowloon - RMSE: 115464783180.46 HKD/m², MAE: 115190101286.08 HKD/m², MAPE: 33137295.26%, R²: -1830563756415.9136
2025-03-29 13:11:33,750 - INFO - Ensemble Kowloon - 90% CI: [103070825060.33, 127314999352.31]
2025-03-29 13:11:33,751 - INFO - Ensemble New Territories - RMSE: 126090037207.19 HKD/m², MAE: 125470129693.22 HKD/m², MAPE: 36620589.69%, R²: -1997750544367.1248
2025-03-29 13:11:33,751 - INFO - Ensemble New Territories - 90% CI: [106456272736.16, 144492389256.81]
2025-03-29 13:11:33,755 - INFO - Features shape: (8,)
2025-03-29 13:11:33,755 - INFO - Number of selected features in predict_future: 8
2025-03-29 13:11:33,755 - INFO - Features values shape after manual selection: (1, 8)
2025-03-29 13:11:34,757 - INFO - 
Future Predictions (First 12 Months):
2025-03-29 13:11:34,767 - INFO -          Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price
0  2025-02-01       649636.094265       432118.923247       371426.284599           432118.923247
1  2025-03-01       650571.544551       432704.003908       372278.463897           432704.003908
2  2025-04-01       651607.221654       433351.771782       373221.948119           433351.771782
3  2025-05-01       652609.489818       433978.643919       374134.997367           433978.643919
4  2025-06-01       653645.166921       434626.411794       375078.481590           434626.411794
5  2025-07-01       654647.435085       435253.283931       375991.530837           435253.283931
6  2025-08-01       655683.112188       435901.051805       376935.015060           435901.051805
7  2025-09-01       656718.789290       436548.819680       377878.499283           436548.819680
8  2025-10-01       657721.057454       437175.691817       378791.548530           437175.691817
9  2025-11-01       658756.734557       437823.459692       379735.032753           437823.459692
10 2025-12-01       659759.002721       438450.331828       380648.082001           438450.331828
11 2026-01-01       660794.679824       439098.099703       381591.566224           439098.099703
2025-03-29 13:17:12,463 - INFO - Processing new data...
2025-03-29 13:17:12,475 - INFO - Loading data files...
2025-03-29 13:17:12,633 - INFO - Merging datasets...
2025-03-29 13:17:12,646 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 13:17:12,655 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 13:17:12,670 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 13:17:12,690 - INFO - Number of selected features before feature selection: 57
2025-03-29 13:17:12,728 - INFO - Performing feature selection with mutual information...
2025-03-29 13:17:12,802 - INFO - Selected features after feature selection: ['D_Kowloon', 'Index_C', 'Index_E', 'Yield_B', 'B_Hong Kong', 'Real_Interest_Rate', 'C_Hong Kong', 'Year']
2025-03-29 13:17:12,802 - INFO - Number of selected features after feature selection: 8
2025-03-29 13:17:12,803 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'D_Kowloon', 'Index_C', 'Index_E', 'Yield_B', 'B_Hong Kong', 'Real_Interest_Rate', 'C_Hong Kong', 'Year']
2025-03-29 13:17:12,803 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 13:17:12,812 - INFO - Using device: cpu
2025-03-29 13:17:12,812 - INFO - Training Transformer model for Hong Kong...
2025-03-29 13:17:13,121 - INFO - Training Transformer model for Kowloon...
2025-03-29 13:17:13,252 - INFO - Training Transformer model for New Territories...
2025-03-29 13:17:13,358 - INFO - Training Prophet model for Hong Kong...
2025-03-29 13:17:13,366 - INFO - Prophet train data for Hong Kong:           ds       y
0 1999-01-01  145982
1 1999-02-01  111466
2 1999-03-01  107098
3 1999-04-01  110840
4 1999-05-01  171299
2025-03-29 13:17:13,366 - INFO - Number of data points in prophet_train for Hong Kong: 234
2025-03-29 13:17:13,418 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/9pghbzb3.json
2025-03-29 13:17:13,420 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/2edb2gjz.json
2025-03-29 13:17:13,424 - DEBUG - idx 0
2025-03-29 13:17:13,424 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:17:13,425 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=4762', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/9pghbzb3.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/2edb2gjz.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelccx2xsr5/prophet_model-20250329131713.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:17:13,425 - INFO - Chain [1] start processing
2025-03-29 13:17:13,498 - INFO - Chain [1] done processing
2025-03-29 13:17:13,538 - INFO - Training Prophet model for Kowloon...
2025-03-29 13:17:13,539 - INFO - Prophet train data for Kowloon:           ds       y
0 1999-01-01  136973
1 1999-02-01  234150
2 1999-03-01  161751
3 1999-04-01  227823
4 1999-05-01  139793
2025-03-29 13:17:13,539 - INFO - Number of data points in prophet_train for Kowloon: 234
2025-03-29 13:17:13,544 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/qdpuyuc2.json
2025-03-29 13:17:13,545 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/g54qvkhr.json
2025-03-29 13:17:13,545 - DEBUG - idx 0
2025-03-29 13:17:13,545 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:17:13,545 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=22711', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/qdpuyuc2.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/g54qvkhr.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelmwkvl8gr/prophet_model-20250329131713.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:17:13,545 - INFO - Chain [1] start processing
2025-03-29 13:17:13,591 - INFO - Chain [1] done processing
2025-03-29 13:17:13,615 - INFO - Training Prophet model for New Territories...
2025-03-29 13:17:13,617 - INFO - Prophet train data for New Territories:           ds         y
0 1999-01-01  140446.0
1 1999-02-01  111028.0
2 1999-03-01  104394.0
3 1999-04-01   82195.0
4 1999-05-01  153616.0
2025-03-29 13:17:13,617 - INFO - Number of data points in prophet_train for New Territories: 234
2025-03-29 13:17:13,624 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/sk5rqxgs.json
2025-03-29 13:17:13,625 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/xvrpiea_.json
2025-03-29 13:17:13,626 - DEBUG - idx 0
2025-03-29 13:17:13,626 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:17:13,626 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=44428', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/sk5rqxgs.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/xvrpiea_.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_model1ywi68m2/prophet_model-20250329131713.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:17:13,626 - INFO - Chain [1] start processing
2025-03-29 13:17:13,677 - INFO - Chain [1] done processing
2025-03-29 13:17:13,703 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 13:17:13,708 - INFO - Ensemble Hong Kong - RMSE: 225261922781.25 HKD/m², MAE: 224452286849.26 HKD/m², MAPE: 52959182.94%, R²: -2697758552964.3662
2025-03-29 13:17:13,708 - INFO - Ensemble Hong Kong - 90% CI: [195067365934.05, 253705737906.08]
2025-03-29 13:17:13,708 - INFO - Ensemble Kowloon - RMSE: 115464743528.97 HKD/m², MAE: 115190061374.57 HKD/m², MAPE: 33137284.02%, R²: -1830562499156.9187
2025-03-29 13:17:13,708 - INFO - Ensemble Kowloon - 90% CI: [102932592400.25, 127393037007.55]
2025-03-29 13:17:13,709 - INFO - Ensemble New Territories - RMSE: 126090041951.99 HKD/m², MAE: 125470134662.33 HKD/m², MAPE: 36620591.12%, R²: -1997750694718.8147
2025-03-29 13:17:13,709 - INFO - Ensemble New Territories - 90% CI: [106239472565.73, 144614876002.00]
2025-03-29 13:17:13,712 - INFO - Features shape: (8,)
2025-03-29 13:17:13,712 - INFO - Number of selected features in predict_future: 8
2025-03-29 13:17:13,713 - INFO - Features values shape after manual selection: (1, 8)
2025-03-29 13:17:15,869 - INFO - 
Future Predictions (First 12 Months):
2025-03-29 13:17:15,871 - INFO -          Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0  2025-02-01       626612.783598       424877.513838       407860.853916           424877.513838                 490644.996539                 544059.223610
1  2025-03-01       627548.233884       425462.594499       408713.033214           425462.594499                 488964.326782                 544908.032453
2  2025-04-01       628583.910987       426110.362374       409656.517437           426110.362374                 489796.187696                 546587.289883
3  2025-05-01       629586.179151       426737.234511       410569.566685           426737.234511                 489796.187696                 545739.893367
4  2025-06-01       630621.856254       427385.002386       411513.050907           427385.002386                 487241.287199                 545826.045346
5  2025-07-01       631624.124418       428011.874522       412426.100155           428011.874522                 491433.075299                 543141.210717
6  2025-08-01       632659.801521       428659.642397       413369.584378           428659.642397                 487201.742029                 545739.893367
7  2025-09-01       633695.478624       429307.410272       414313.068601           429307.410272                 488116.930266                 547462.932950
8  2025-10-01       634697.746788       429934.282409       415226.117848           429934.282409                 495798.579685                 544059.223610
9  2025-11-01       635733.423890       430582.050283       416169.602071           430582.050283                 486450.383784                 541460.540960
10 2025-12-01       636735.692054       431208.922420       417082.651319           431208.922420                 490644.996539                 544864.250300
11 2026-01-01       637771.369157       431856.690295       418026.135541           431856.690295                 490644.996539                 544864.250300
2025-03-29 13:24:29,026 - INFO - Processing new data...
2025-03-29 13:24:29,030 - INFO - Loading data files...
2025-03-29 13:24:29,129 - INFO - Merging datasets...
2025-03-29 13:24:29,141 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 13:24:29,153 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 13:24:29,169 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 13:24:29,178 - INFO - Number of selected features before feature selection: 57
2025-03-29 13:24:29,231 - INFO - Target values (y) before scaling: [[145982. 136973. 140446.]
 [111466. 234150. 111028.]
 [107098. 161751. 104394.]
 [110840. 227823.  82195.]
 [171299. 139793. 153616.]]
2025-03-29 13:24:29,232 - INFO - Target values (y) min: 61105.0, max: 888210.0
2025-03-29 13:24:29,245 - INFO - Price scaler data_min_: [65409. 79192. 61105.]
2025-03-29 13:24:29,245 - INFO - Price scaler data_max_: [888210. 627952. 652198.]
2025-03-29 13:24:29,245 - INFO - y_test before inverse transform: [[0.38579195 0.83457067 0.58725784]
 [0.46364188 0.51212005 0.9174783 ]
 [0.5606702  0.62355492 0.49971493]
 [0.62330746 0.54961732 0.43132299]
 [0.46912315 0.39165756 0.50962877]]
2025-03-29 13:24:29,245 - INFO - Performing feature selection with mutual information...
2025-03-29 13:24:29,304 - INFO - Selected features after feature selection: ['Index_C', 'Yield_B', 'Index_E', 'Yield_C', 'Real_Interest_Rate', 'B_Hong Kong', 'C_Hong Kong', 'Year']
2025-03-29 13:24:29,304 - INFO - Number of selected features after feature selection: 8
2025-03-29 13:24:29,305 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Index_C', 'Yield_B', 'Index_E', 'Yield_C', 'Real_Interest_Rate', 'B_Hong Kong', 'C_Hong Kong', 'Year']
2025-03-29 13:24:29,305 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 13:24:29,312 - INFO - Using device: cpu
2025-03-29 13:24:29,312 - INFO - Training Transformer model for Hong Kong...
2025-03-29 13:24:29,605 - INFO - Training Transformer model for Kowloon...
2025-03-29 13:24:29,746 - INFO - Training Transformer model for New Territories...
2025-03-29 13:24:29,866 - INFO - Transformer test predictions: [[0.60929    0.7037558  0.5603714 ]
 [0.60929    0.7037558  0.5603714 ]
 [0.60736918 0.69770443 0.55131388]
 [0.60736918 0.69770443 0.55131388]
 [0.60536534 0.69142288 0.54220617]]
2025-03-29 13:24:29,872 - INFO - Training Prophet model for Hong Kong...
2025-03-29 13:24:29,879 - INFO - Prophet train data for Hong Kong:           ds       y
0 1999-01-01  145982
1 1999-02-01  111466
2 1999-03-01  107098
3 1999-04-01  110840
4 1999-05-01  171299
2025-03-29 13:24:29,879 - INFO - Number of data points in prophet_train for Hong Kong: 234
2025-03-29 13:24:29,925 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/5km2ek7j.json
2025-03-29 13:24:29,927 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/wta6e9l0.json
2025-03-29 13:24:29,933 - DEBUG - idx 0
2025-03-29 13:24:29,933 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:24:29,933 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=36313', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/5km2ek7j.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/wta6e9l0.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelsfubm5e2/prophet_model-20250329132429.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:24:29,933 - INFO - Chain [1] start processing
2025-03-29 13:24:30,007 - INFO - Chain [1] done processing
2025-03-29 13:24:30,062 - INFO - Prophet test predictions for Hong Kong: [582763.72152935 585352.91428638 587942.1070434  590447.77745342
 593036.97021045]
2025-03-29 13:24:30,063 - INFO - Training Prophet model for Kowloon...
2025-03-29 13:24:30,063 - INFO - Prophet train data for Kowloon:           ds       y
0 1999-01-01  136973
1 1999-02-01  234150
2 1999-03-01  161751
3 1999-04-01  227823
4 1999-05-01  139793
2025-03-29 13:24:30,063 - INFO - Number of data points in prophet_train for Kowloon: 234
2025-03-29 13:24:30,068 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/9hg_gl93.json
2025-03-29 13:24:30,069 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/eo_3bntq.json
2025-03-29 13:24:30,069 - DEBUG - idx 0
2025-03-29 13:24:30,069 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:24:30,069 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=75790', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/9hg_gl93.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/eo_3bntq.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelpe72e9r4/prophet_model-20250329132430.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:24:30,069 - INFO - Chain [1] start processing
2025-03-29 13:24:30,117 - INFO - Chain [1] done processing
2025-03-29 13:24:30,141 - INFO - Prophet test predictions for Kowloon: [462721.77912543 464341.19881219 465960.61849894 467527.79884096
 469147.21852771]
2025-03-29 13:24:30,141 - INFO - Training Prophet model for New Territories...
2025-03-29 13:24:30,143 - INFO - Prophet train data for New Territories:           ds         y
0 1999-01-01  140446.0
1 1999-02-01  111028.0
2 1999-03-01  104394.0
3 1999-04-01   82195.0
4 1999-05-01  153616.0
2025-03-29 13:24:30,143 - INFO - Number of data points in prophet_train for New Territories: 234
2025-03-29 13:24:30,149 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/elwnp4hf.json
2025-03-29 13:24:30,150 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/no4fps5q.json
2025-03-29 13:24:30,150 - DEBUG - idx 0
2025-03-29 13:24:30,150 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:24:30,150 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=42817', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/elwnp4hf.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/no4fps5q.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelj_n3rmn5/prophet_model-20250329132430.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:24:30,150 - INFO - Chain [1] start processing
2025-03-29 13:24:30,202 - INFO - Chain [1] done processing
2025-03-29 13:24:30,225 - INFO - Prophet test predictions for New Territories: [440289.26925715 442647.97981381 445006.69037048 447289.31348983
 449648.02404649]
2025-03-29 13:24:30,230 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 13:24:30,230 - INFO - Ensemble predictions before inverse transform: [[233105.85418574 185089.13390365 176116.0439257 ]
 [234141.53128855 185736.90177835 177059.52814837]
 [235177.20723887 186384.66602224 178003.00693652]
 [236179.47540288 187011.53815904 178916.05618426]
 [237215.15130338 187659.30226481 179859.5349423 ]]
2025-03-29 13:24:30,233 - INFO - y_true (actual test prices): [[382839. 537171. 408229.]
 [446894. 360223. 603420.]
 [526729. 421374. 356483.]
 [578267. 380800. 316057.]
 [451404. 294118. 362343.]]
2025-03-29 13:24:30,233 - INFO - y_pred (predicted test prices): [[1.91799795e+11 1.01569592e+11 1.04101022e+11]
 [1.92651951e+11 1.01925061e+11 1.04658709e+11]
 [1.93504107e+11 1.02280529e+11 1.05216392e+11]
 [1.94328774e+11 1.02624531e+11 1.05756090e+11]
 [1.95180929e+11 1.02979998e+11 1.06313773e+11]]
2025-03-29 13:24:30,236 - INFO - Ensemble Hong Kong - RMSE: 225261933806.39 HKD/m², MAE: 224452298505.39 HKD/m², MAPE: 52959185.39%, R²: -2697758817040.6353
2025-03-29 13:24:30,236 - INFO - Ensemble Hong Kong - 90% CI: [195440714624.44, 253841041693.75]
2025-03-29 13:24:30,236 - INFO - Ensemble Kowloon - RMSE: 115464794203.89 HKD/m², MAE: 115190112203.85 HKD/m², MAPE: 33137298.42%, R²: -1830564105944.0579
2025-03-29 13:24:30,236 - INFO - Ensemble Kowloon - 90% CI: [103088366086.75, 127449520870.63]
2025-03-29 13:24:30,237 - INFO - Ensemble New Territories - RMSE: 126090040784.84 HKD/m², MAE: 125470133547.46 HKD/m², MAPE: 36620590.70%, R²: -1997750657734.7168
2025-03-29 13:24:30,237 - INFO - Ensemble New Territories - 90% CI: [106483789465.49, 144703414537.91]
2025-03-29 13:24:30,239 - INFO - Features shape: (8,)
2025-03-29 13:24:30,239 - INFO - Number of selected features in predict_future: 8
2025-03-29 13:24:30,239 - INFO - Features values shape after manual selection: (1, 8)
2025-03-29 13:24:30,292 - INFO - Prophet future predictions: [[783802.01076018 588461.88190014 623431.73086648]
 [786140.6364762  589924.5835527  625562.17911121]
 [788729.82923322 591544.00323945 627920.88966788]
 [791235.49964325 593111.18358147 630203.51278723]
 [793824.69240027 594730.60326822 632562.22334389]]
2025-03-29 13:24:30,346 - INFO - Transformer future predictions: [[339347.0538522  491584.85137892 339041.19295502]
 [339347.0538522  491584.85137892 339041.19295502]
 [339347.0538522  491584.85137892 339041.19295502]
 [339347.0538522  491584.85137892 339041.19295502]
 [339347.0538522  491584.85137892 339041.19295502]]
2025-03-29 13:24:30,346 - INFO - Future predictions before inverse transform: [[517129.03661539 530335.66358741 452797.4081196 ]
 [518064.4869018  530920.74424843 453649.5874175 ]
 [519100.16400461 531568.51212313 454593.07164016]
 [520102.43216862 532195.38425994 455506.1208879 ]
 [521138.10927143 532843.15213464 456449.60511057]]
2025-03-29 13:24:30,353 - INFO - Future predictions (first 5 rows):         Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0 2025-02-01       517129.036615       530335.663587       452797.408120           517129.036615                 500878.272856                 560224.275539
1 2025-03-01       518064.486902       530920.744248       453649.587417           518064.486902                 504281.982196                 556821.978527
2 2025-04-01       519100.164005       531568.512123       454593.071640           519100.164005                 503476.955506                 557696.209266
3 2025-05-01       520102.432169       532195.384260       455506.120888           520102.432169                 503476.955506                 560224.275539
4 2025-06-01       521138.109271       532843.152135       456449.605111           521138.109271                 502558.942613                 557653.839440
2025-03-29 13:24:32,274 - INFO - 
Future Predictions (First 12 Months):
2025-03-29 13:24:32,276 - INFO -          Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0  2025-02-01       517129.036615       530335.663587       452797.408120           517129.036615                 500878.272856                 560224.275539
1  2025-03-01       518064.486902       530920.744248       453649.587417           518064.486902                 504281.982196                 556821.978527
2  2025-04-01       519100.164005       531568.512123       454593.071640           519100.164005                 503476.955506                 557696.209266
3  2025-05-01       520102.432169       532195.384260       455506.120888           520102.432169                 503476.955506                 560224.275539
4  2025-06-01       521138.109271       532843.152135       456449.605111           521138.109271                 502558.942613                 557653.839440
5  2025-07-01       522140.377435       533470.024271       457362.654358           522140.377435                 503433.173352                 558501.235957
6  2025-08-01       523176.054538       534117.792146       458306.138581           523176.054538                 502601.312439                 557653.839440
7  2025-09-01       524211.731641       534765.560021       459249.622804           524211.731641                 502515.160460                 558545.018110
8  2025-10-01       525213.999805       535392.432158       460162.672051           525213.999805                 501710.133769                 558501.235957
9  2025-11-01       526249.676908       536040.200032       461106.156274           526249.676908                 504281.982196                 558501.235957
10 2025-12-01       527251.945072       536667.072169       462019.205522           527251.945072                 505156.212935                 556821.978527
11 2026-01-01       528287.622175       537314.840044       462962.689744           528287.622175                 503476.955506                 556821.978527
2025-03-29 13:34:49,817 - INFO - Processing new data...
2025-03-29 13:34:49,829 - INFO - Loading data files...
2025-03-29 13:34:50,013 - INFO - Merging datasets...
2025-03-29 13:34:50,033 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 13:34:50,035 - INFO - Target columns: ['Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-29 13:34:50,036 - INFO - Data in Price_Hong_Kong (first 5 rows): [145982, 111466, 107098, 110840, 171299]
2025-03-29 13:34:50,037 - INFO - Min value in Price_Hong_Kong: 65409, Max value in Price_Hong_Kong: 888210
2025-03-29 13:34:50,037 - INFO - Data in Price_Kowloon (first 5 rows): [136973, 234150, 161751, 227823, 139793]
2025-03-29 13:34:50,037 - INFO - Min value in Price_Kowloon: 79192, Max value in Price_Kowloon: 627952
2025-03-29 13:34:50,037 - INFO - Data in Price_New_Territories (first 5 rows): [140446, 111028, 104394, 82195, 153616]
2025-03-29 13:34:50,037 - INFO - Min value in Price_New_Territories: 61105, Max value in Price_New_Territories: 708985
2025-03-29 13:34:50,040 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 13:34:50,049 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 13:34:50,063 - INFO - Number of selected features before feature selection: 57
2025-03-29 13:34:50,084 - INFO - Target values (y) before scaling: [[145982. 136973. 140446.]
 [111466. 234150. 111028.]
 [107098. 161751. 104394.]
 [110840. 227823.  82195.]
 [171299. 139793. 153616.]]
2025-03-29 13:34:50,085 - INFO - Target values (y) min: 61105.0, max: 888210.0
2025-03-29 13:34:50,095 - INFO - Price scaler data_min_: [65409. 79192. 61105.]
2025-03-29 13:34:50,095 - INFO - Price scaler data_max_: [888210. 627952. 652198.]
2025-03-29 13:34:50,095 - INFO - y_test before inverse transform: [[0.38579195 0.83457067 0.58725784]
 [0.46364188 0.51212005 0.9174783 ]
 [0.5606702  0.62355492 0.49971493]
 [0.62330746 0.54961732 0.43132299]
 [0.46912315 0.39165756 0.50962877]]
2025-03-29 13:34:50,095 - INFO - Performing feature selection with mutual information...
2025-03-29 13:34:50,157 - INFO - Selected features after feature selection: ['Index_C', 'Index_E', 'Yield_B', 'Yield_C', 'C_Hong Kong', 'Real_Interest_Rate', 'B_Hong Kong', 'Year']
2025-03-29 13:34:50,157 - INFO - Number of selected features after feature selection: 8
2025-03-29 13:34:50,159 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Index_C', 'Index_E', 'Yield_B', 'Yield_C', 'C_Hong Kong', 'Real_Interest_Rate', 'B_Hong Kong', 'Year']
2025-03-29 13:34:50,159 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 13:34:50,166 - INFO - Using device: cpu
2025-03-29 13:34:50,166 - INFO - Training Transformer model for Hong Kong...
2025-03-29 13:34:50,660 - INFO - Epoch 10/50, Loss for Hong Kong: 0.0285
2025-03-29 13:34:50,969 - INFO - Epoch 20/50, Loss for Hong Kong: 0.0220
2025-03-29 13:34:51,381 - INFO - Epoch 30/50, Loss for Hong Kong: 0.0221
2025-03-29 13:34:51,812 - INFO - Epoch 40/50, Loss for Hong Kong: 0.0202
2025-03-29 13:34:52,184 - INFO - Epoch 50/50, Loss for Hong Kong: 0.0121
2025-03-29 13:34:52,187 - INFO - Training Transformer model for Kowloon...
2025-03-29 13:34:52,507 - INFO - Epoch 10/50, Loss for Kowloon: 0.0455
2025-03-29 13:34:52,794 - INFO - Epoch 20/50, Loss for Kowloon: 0.0454
2025-03-29 13:34:53,081 - INFO - Epoch 30/50, Loss for Kowloon: 0.0277
2025-03-29 13:34:53,365 - INFO - Epoch 40/50, Loss for Kowloon: 0.0294
2025-03-29 13:34:53,646 - INFO - Epoch 50/50, Loss for Kowloon: 0.0216
2025-03-29 13:34:53,647 - INFO - Training Transformer model for New Territories...
2025-03-29 13:34:53,956 - INFO - Epoch 10/50, Loss for New Territories: 0.0851
2025-03-29 13:34:54,242 - INFO - Epoch 20/50, Loss for New Territories: 0.0305
2025-03-29 13:34:54,526 - INFO - Epoch 30/50, Loss for New Territories: 0.0442
2025-03-29 13:34:54,807 - INFO - Epoch 40/50, Loss for New Territories: 0.0044
2025-03-29 13:34:55,098 - INFO - Epoch 50/50, Loss for New Territories: 0.0078
2025-03-29 13:34:55,099 - INFO - Transformer test predictions: [[0.66076559 0.67114866 0.66763246]
 [0.66076559 0.67114866 0.66763246]
 [0.65590733 0.66562289 0.65688312]
 [0.65590733 0.66562289 0.65688312]
 [0.6509214  0.65984118 0.645702  ]]
2025-03-29 13:34:55,108 - INFO - Training Prophet model for Hong Kong...
2025-03-29 13:34:55,119 - INFO - Prophet train data for Hong Kong:           ds       y
0 1999-01-01  145982
1 1999-02-01  111466
2 1999-03-01  107098
3 1999-04-01  110840
4 1999-05-01  171299
2025-03-29 13:34:55,119 - INFO - Number of data points in prophet_train for Hong Kong: 234
2025-03-29 13:34:55,174 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/nylpwgir.json
2025-03-29 13:34:55,179 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/jnhp0ud5.json
2025-03-29 13:34:55,184 - DEBUG - idx 0
2025-03-29 13:34:55,184 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:34:55,185 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=87502', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/nylpwgir.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/jnhp0ud5.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_model8git49c4/prophet_model-20250329133455.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:34:55,185 - INFO - Chain [1] start processing
2025-03-29 13:34:55,268 - INFO - Chain [1] done processing
2025-03-29 13:34:55,310 - INFO - Prophet test predictions for Hong Kong: [549557.87033569 533494.81948792 533899.36184859 540976.22768549
 553007.88661332]
2025-03-29 13:34:55,310 - INFO - Training Prophet model for Kowloon...
2025-03-29 13:34:55,311 - INFO - Prophet train data for Kowloon:           ds       y
0 1999-01-01  136973
1 1999-02-01  234150
2 1999-03-01  161751
3 1999-04-01  227823
4 1999-05-01  139793
2025-03-29 13:34:55,311 - INFO - Number of data points in prophet_train for Kowloon: 234
2025-03-29 13:34:55,316 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/dmt5s7j1.json
2025-03-29 13:34:55,321 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/yoqhjdx7.json
2025-03-29 13:34:55,322 - DEBUG - idx 0
2025-03-29 13:34:55,322 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:34:55,322 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=98255', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/dmt5s7j1.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/yoqhjdx7.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelg3ardroa/prophet_model-20250329133455.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:34:55,322 - INFO - Chain [1] start processing
2025-03-29 13:34:55,374 - INFO - Chain [1] done processing
2025-03-29 13:34:55,399 - INFO - Prophet test predictions for Kowloon: [411687.64391091 434039.85363333 404201.25486984 387293.33844205
 431525.77853287]
2025-03-29 13:34:55,399 - INFO - Training Prophet model for New Territories...
2025-03-29 13:34:55,401 - INFO - Prophet train data for New Territories:           ds         y
0 1999-01-01  140446.0
1 1999-02-01  111028.0
2 1999-03-01  104394.0
3 1999-04-01   82195.0
4 1999-05-01  153616.0
2025-03-29 13:34:55,401 - INFO - Number of data points in prophet_train for New Territories: 234
2025-03-29 13:34:55,406 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/qyycf5a9.json
2025-03-29 13:34:55,410 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/v6yql80h.json
2025-03-29 13:34:55,411 - DEBUG - idx 0
2025-03-29 13:34:55,411 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:34:55,411 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=22424', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/qyycf5a9.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/v6yql80h.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelhzbilkor/prophet_model-20250329133455.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:34:55,411 - INFO - Chain [1] start processing
2025-03-29 13:34:55,463 - INFO - Chain [1] done processing
2025-03-29 13:34:55,495 - INFO - Prophet test predictions for New Territories: [402793.91425732 399316.91910021 416399.45842783 392776.27986319
 432534.18146572]
2025-03-29 13:34:55,499 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 13:34:55,500 - INFO - Ensemble predictions before inverse transform: [[219823.54459363 164675.46025356 161117.9662824 ]
 [213398.32425452 173616.34414253 159727.16821956]
 [213560.13828384 161680.90132167 166560.177501  ]
 [216390.88461859 154917.73475055 157110.90607515]
 [221203.54519817 172610.70731786 173014.06000749]]
2025-03-29 13:34:55,502 - INFO - y_true (actual test prices): [[382839. 537171. 408229.]
 [446894. 360223. 603420.]
 [526729. 421374. 356483.]
 [578267. 380800. 316057.]
 [451404. 294118. 362343.]]
2025-03-29 13:34:55,502 - INFO - y_pred (predicted test prices): [[1.80871098e+11 9.03673848e+10 9.52357631e+10]
 [1.75584420e+11 9.52737842e+10 9.44136721e+10]
 [1.75717561e+11 8.87240906e+10 9.84526161e+10]
 [1.78046702e+11 8.50127353e+10 9.28672179e+10]
 [1.82006564e+11 9.47219309e+10 1.02267461e+11]]
2025-03-29 13:34:55,505 - INFO - Ensemble Hong Kong - RMSE: 192550206958.46 HKD/m², MAE: 192207844845.48 HKD/m², MAPE: 45180490.11%, R²: -1971130980938.0232
2025-03-29 13:34:55,505 - INFO - Ensemble Hong Kong - 90% CI: [175599798044.83, 210495047547.80]
2025-03-29 13:34:55,505 - INFO - Ensemble Kowloon - RMSE: 92585572806.54 HKD/m², MAE: 92517543085.99 HKD/m², MAPE: 26409872.63%, R²: -1176989006219.7068
2025-03-29 13:34:55,505 - INFO - Ensemble Kowloon - 90% CI: [85773332277.58, 97195783511.27]
2025-03-29 13:34:55,506 - INFO - Ensemble New Territories - RMSE: 107098924776.45 HKD/m², MAE: 106877213011.03 HKD/m², MAPE: 31071459.30%, R²: -1441285221060.5234
2025-03-29 13:34:55,506 - INFO - Ensemble New Territories - 90% CI: [95546736198.81, 117827490125.90]
2025-03-29 13:34:55,509 - INFO - Features shape: (8,)
2025-03-29 13:34:55,509 - INFO - Number of selected features in predict_future: 8
2025-03-29 13:34:55,509 - INFO - Features values shape after manual selection: (1, 8)
2025-03-29 13:34:55,568 - INFO - Prophet future predictions: [[604221.48103139 425927.26046351 513848.70141675]
 [686365.26703981 436616.77133309 503569.43820518]
 [613583.83340956 443109.91800411 496157.38026166]
 [618133.95469029 421522.3899425  491583.54174065]
 [629246.28027444 410712.42432507 506732.67507544]]
2025-03-29 13:34:55,644 - INFO - Transformer future predictions: [[566033.2408939  324803.34036779 394588.21082234]
 [566033.2408939  324803.34036779 394588.21082234]
 [566033.2408939  324803.34036779 394588.21082234]
 [566033.2408939  324803.34036779 394588.21082234]
 [566033.2408939  324803.34036779 394588.21082234]]
2025-03-29 13:34:55,644 - INFO - Future predictions before inverse transform: [[581308.5369489  365252.90840608 442292.40706011]
 [614166.05135226 369528.71275391 438180.70177548]
 [585053.47790017 372125.97142232 435215.87859807]
 [586873.52641246 363490.96019767 433386.34318967]
 [591318.45664612 359166.9739507  439445.99652358]]
2025-03-29 13:34:55,653 - INFO - Future predictions (first 5 rows):         Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0 2025-02-01       581308.536949       365252.908406       442292.407060           442292.407060                 458569.181085                 487906.903947
1 2025-03-01       614166.051352       369528.712754       438180.701775           438180.701775                 458171.820557                 488050.509691
2 2025-04-01       585053.477900       372125.971422       435215.878598           435215.878598                 461485.264076                 488692.609796
3 2025-05-01       586873.526412       363490.960198       433386.343190           433386.343190                 461076.789218                 489845.147783
4 2025-06-01       591318.456646       359166.973951       439445.996524           439445.996524                 458243.829464                 488013.561211
2025-03-29 13:34:57,707 - INFO - 
Future Predictions (First 12 Months):
2025-03-29 13:34:57,711 - INFO -          Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0  2025-02-01       581308.536949       365252.908406       442292.407060           442292.407060                 458569.181085                 487906.903947
1  2025-03-01       614166.051352       369528.712754       438180.701775           438180.701775                 458171.820557                 488050.509691
2  2025-04-01       585053.477900       372125.971422       435215.878598           435215.878598                 461485.264076                 488692.609796
3  2025-05-01       586873.526412       363490.960198       433386.343190           433386.343190                 461076.789218                 489845.147783
4  2025-06-01       591318.456646       359166.973951       439445.996524           439445.996524                 458243.829464                 488013.561211
5  2025-07-01       592562.804011       364344.788892       438765.416495           438765.416495                 458748.651840                 492786.419108
6  2025-08-01       592846.207272       371152.891442       437272.603901           437272.603901                 458618.588240                 488565.774805
7  2025-09-01       592216.796849       356540.252090       438865.196967           438865.196967                 462498.241428                 491511.300870
8  2025-10-01       598337.773899       355479.111271       435345.074747           435345.074747                 458453.086444                 487863.730948
9  2025-11-01       599540.772654       370321.601251       444904.820035           444904.820035                 462789.447615                 487710.677297
10 2025-12-01       582218.244716       369331.482091       439992.042890           439992.042890                 458200.764082                 488898.307194
11 2026-01-01       595892.562665       367429.385326       441009.950614           441009.950614                 460952.640438                 488719.232011
2025-03-29 13:42:32,859 - INFO - Processing new data...
2025-03-29 13:42:32,867 - INFO - Loading data files...
2025-03-29 13:42:33,032 - INFO - Merging datasets...
2025-03-29 13:42:33,048 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 13:42:33,053 - INFO - Target columns: ['Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-29 13:42:33,054 - INFO - Data in Price_Hong_Kong (first 5 rows): [145982, 111466, 107098, 110840, 171299]
2025-03-29 13:42:33,057 - INFO - Min value in Price_Hong_Kong: 65409, Max value in Price_Hong_Kong: 888210
2025-03-29 13:42:33,057 - INFO - Data in Price_Kowloon (first 5 rows): [136973, 234150, 161751, 227823, 139793]
2025-03-29 13:42:33,057 - INFO - Min value in Price_Kowloon: 79192, Max value in Price_Kowloon: 627952
2025-03-29 13:42:33,057 - INFO - Data in Price_New_Territories (first 5 rows): [140446, 111028, 104394, 82195, 153616]
2025-03-29 13:42:33,057 - INFO - Min value in Price_New_Territories: 61105, Max value in Price_New_Territories: 708985
2025-03-29 13:42:33,061 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 13:42:33,068 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 13:42:33,078 - INFO - Number of selected features before feature selection: 57
2025-03-29 13:42:33,101 - INFO - Target values (y) before scaling: [[145982. 136973. 140446.]
 [111466. 234150. 111028.]
 [107098. 161751. 104394.]
 [110840. 227823.  82195.]
 [171299. 139793. 153616.]]
2025-03-29 13:42:33,101 - INFO - Target values (y) min: 61105.0, max: 888210.0
2025-03-29 13:42:33,118 - INFO - Price scaler mean_: [341777.68690096 297930.59744409 249102.16536864]
2025-03-29 13:42:33,118 - INFO - Price scaler scale_: [184464.04997183 124015.20656389 133778.90598671]
2025-03-29 13:42:33,118 - INFO - y_test before inverse transform: [[ 0.22259792  1.92912151  1.18947627]
 [ 0.56984715  0.50229649  2.64853291]
 [ 1.00264151  0.99538924  0.80267389]
 [ 1.2820347   0.66821969  0.50048873]
 [ 0.59429636 -0.03074298  0.84647751]]
2025-03-29 13:42:33,118 - INFO - Performing feature selection with mutual information...
2025-03-29 13:42:33,166 - INFO - Selected features after feature selection: ['E_Kowloon', 'Yield_C', 'Yield_B', 'Index_E', 'Real_Interest_Rate', 'B_Hong Kong', 'Year', 'C_Hong Kong']
2025-03-29 13:42:33,166 - INFO - Number of selected features after feature selection: 8
2025-03-29 13:42:33,167 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'E_Kowloon', 'Yield_C', 'Yield_B', 'Index_E', 'Real_Interest_Rate', 'B_Hong Kong', 'Year', 'C_Hong Kong']
2025-03-29 13:42:33,167 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 13:42:33,181 - INFO - Using device: cpu
2025-03-29 13:42:33,181 - INFO - Training Transformer model for Hong Kong...
2025-03-29 13:42:33,673 - INFO - Epoch 10/100, Loss for Hong Kong: 0.1310
2025-03-29 13:42:33,967 - INFO - Epoch 20/100, Loss for Hong Kong: 0.3296
2025-03-29 13:42:34,283 - INFO - Epoch 30/100, Loss for Hong Kong: 0.1498
2025-03-29 13:42:34,575 - INFO - Epoch 40/100, Loss for Hong Kong: 0.5880
2025-03-29 13:42:34,858 - INFO - Epoch 50/100, Loss for Hong Kong: 0.0786
2025-03-29 13:42:35,143 - INFO - Epoch 60/100, Loss for Hong Kong: 0.2572
2025-03-29 13:42:35,426 - INFO - Epoch 70/100, Loss for Hong Kong: 0.1858
2025-03-29 13:42:35,706 - INFO - Epoch 80/100, Loss for Hong Kong: 0.1267
2025-03-29 13:42:35,983 - INFO - Epoch 90/100, Loss for Hong Kong: 0.3720
2025-03-29 13:42:36,272 - INFO - Epoch 100/100, Loss for Hong Kong: 0.1197
2025-03-29 13:42:36,274 - INFO - Training Transformer model for Kowloon...
2025-03-29 13:42:36,575 - INFO - Epoch 10/100, Loss for Kowloon: 0.2019
2025-03-29 13:42:36,860 - INFO - Epoch 20/100, Loss for Kowloon: 0.3679
2025-03-29 13:42:37,138 - INFO - Epoch 30/100, Loss for Kowloon: 0.2701
2025-03-29 13:42:37,416 - INFO - Epoch 40/100, Loss for Kowloon: 0.3018
2025-03-29 13:42:37,701 - INFO - Epoch 50/100, Loss for Kowloon: 0.1912
2025-03-29 13:42:37,982 - INFO - Epoch 60/100, Loss for Kowloon: 0.2027
2025-03-29 13:42:38,267 - INFO - Epoch 70/100, Loss for Kowloon: 0.1217
2025-03-29 13:42:38,564 - INFO - Epoch 80/100, Loss for Kowloon: 0.1906
2025-03-29 13:42:38,855 - INFO - Epoch 90/100, Loss for Kowloon: 0.2997
2025-03-29 13:42:39,143 - INFO - Epoch 100/100, Loss for Kowloon: 0.2095
2025-03-29 13:42:39,144 - INFO - Training Transformer model for New Territories...
2025-03-29 13:42:39,448 - INFO - Epoch 10/100, Loss for New Territories: 0.4096
2025-03-29 13:42:39,731 - INFO - Epoch 20/100, Loss for New Territories: 0.3126
2025-03-29 13:42:40,011 - INFO - Epoch 30/100, Loss for New Territories: 0.1481
2025-03-29 13:42:40,297 - INFO - Epoch 40/100, Loss for New Territories: 0.1845
2025-03-29 13:42:40,587 - INFO - Epoch 50/100, Loss for New Territories: 0.1800
2025-03-29 13:42:40,865 - INFO - Epoch 60/100, Loss for New Territories: 0.1769
2025-03-29 13:42:41,143 - INFO - Epoch 70/100, Loss for New Territories: 0.1731
2025-03-29 13:42:41,428 - INFO - Epoch 80/100, Loss for New Territories: 0.2554
2025-03-29 13:42:41,705 - INFO - Epoch 90/100, Loss for New Territories: 0.1938
2025-03-29 13:42:41,988 - INFO - Epoch 100/100, Loss for New Territories: 0.0559
2025-03-29 13:42:41,990 - INFO - Transformer test predictions: [[1.03988409 1.08558404 1.10064507]
 [1.03988409 1.08558404 1.10064507]
 [1.03314567 1.0865916  1.09476376]
 [1.03314567 1.0865916  1.09476376]
 [1.02541614 1.08744109 1.08760726]]
2025-03-29 13:42:41,994 - INFO - Training Prophet model for Hong Kong...
2025-03-29 13:42:42,003 - INFO - Prophet train data for Hong Kong:           ds       y
0 1999-01-01  145982
1 1999-02-01  111466
2 1999-03-01  107098
3 1999-04-01  110840
4 1999-05-01  171299
2025-03-29 13:42:42,003 - INFO - Number of data points in prophet_train for Hong Kong: 234
2025-03-29 13:42:42,041 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/q_fujtts.json
2025-03-29 13:42:42,046 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/_4si43ef.json
2025-03-29 13:42:42,049 - DEBUG - idx 0
2025-03-29 13:42:42,049 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:42:42,049 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=8969', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/q_fujtts.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/_4si43ef.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelyylno9mn/prophet_model-20250329134242.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:42:42,049 - INFO - Chain [1] start processing
2025-03-29 13:42:42,121 - INFO - Chain [1] done processing
2025-03-29 13:42:42,165 - INFO - Prophet test predictions for Hong Kong: [549557.87033569 533494.81948792 533899.36184859 540976.22768549
 553007.88661332]
2025-03-29 13:42:42,165 - INFO - Training Prophet model for Kowloon...
2025-03-29 13:42:42,166 - INFO - Prophet train data for Kowloon:           ds       y
0 1999-01-01  136973
1 1999-02-01  234150
2 1999-03-01  161751
3 1999-04-01  227823
4 1999-05-01  139793
2025-03-29 13:42:42,166 - INFO - Number of data points in prophet_train for Kowloon: 234
2025-03-29 13:42:42,172 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/3ntyevr_.json
2025-03-29 13:42:42,176 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/1v_g3ist.json
2025-03-29 13:42:42,176 - DEBUG - idx 0
2025-03-29 13:42:42,176 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:42:42,176 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=43887', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/3ntyevr_.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/1v_g3ist.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_model8kfxdrx7/prophet_model-20250329134242.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:42:42,176 - INFO - Chain [1] start processing
2025-03-29 13:42:42,265 - INFO - Chain [1] done processing
2025-03-29 13:42:42,292 - INFO - Prophet test predictions for Kowloon: [411687.64391091 434039.85363333 404201.25486984 387293.33844205
 431525.77853287]
2025-03-29 13:42:42,292 - INFO - Training Prophet model for New Territories...
2025-03-29 13:42:42,294 - INFO - Prophet train data for New Territories:           ds         y
0 1999-01-01  140446.0
1 1999-02-01  111028.0
2 1999-03-01  104394.0
3 1999-04-01   82195.0
4 1999-05-01  153616.0
2025-03-29 13:42:42,294 - INFO - Number of data points in prophet_train for New Territories: 234
2025-03-29 13:42:42,300 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/w660lkm1.json
2025-03-29 13:42:42,304 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/r5yiuvpb.json
2025-03-29 13:42:42,305 - DEBUG - idx 0
2025-03-29 13:42:42,305 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:42:42,305 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=85189', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/w660lkm1.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/r5yiuvpb.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelgu4b1e43/prophet_model-20250329134242.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:42:42,305 - INFO - Chain [1] start processing
2025-03-29 13:42:42,355 - INFO - Chain [1] done processing
2025-03-29 13:42:42,396 - INFO - Prophet test predictions for New Territories: [402793.91425732 399316.91910021 416399.45842783 392776.27986319
 432534.18146572]
2025-03-29 13:42:42,402 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 13:42:42,402 - INFO - Ensemble predictions before inverse transform: [[219823.77206473 164675.70891479 161118.22608997]
 [213398.55172562 173616.59280376 159727.42802712]
 [213560.36462684 161681.1539029  166560.44022938]
 [216391.11096159 154917.98733178 157111.16880353]
 [221203.76989501 172610.9638778  173014.32515065]]
2025-03-29 13:42:42,407 - INFO - y_true (actual test prices): [[382839. 537171. 408229.]
 [446894. 360223. 603420.]
 [526729. 421374. 356483.]
 [578267. 380800. 316057.]
 [451404. 294118. 362343.]]
2025-03-29 13:42:42,407 - INFO - y_pred (predicted test prices): [[4.05499251e+10 2.04225900e+10 2.15544691e+10]
 [3.93647029e+10 2.15313956e+10 2.13684097e+10]
 [3.93945516e+10 2.00512196e+10 2.22825226e+10]
 [3.99167225e+10 1.92124841e+10 2.10184094e+10]
 [4.08044850e+10 2.14066823e+10 2.31459162e+10]]
2025-03-29 13:42:42,411 - INFO - Ensemble Hong Kong - RMSE: 43167904784.64 HKD/m², MAE: 43091149001.74 HKD/m², MAPE: 10129038.37%, R²: -99071661069.3437
2025-03-29 13:42:42,411 - INFO - Ensemble Hong Kong - 90% CI: [39412741819.71, 47321676767.60]
2025-03-29 13:42:42,411 - INFO - Ensemble Kowloon - RMSE: 20923598788.31 HKD/m², MAE: 20908224691.64 HKD/m², MAPE: 5968424.23%, R²: -60111634670.7670
2025-03-29 13:42:42,411 - INFO - Ensemble Kowloon - 90% CI: [19384252496.97, 21950214079.43]
2025-03-29 13:42:42,411 - INFO - Ensemble New Territories - RMSE: 24239112469.32 HKD/m², MAE: 24188932146.13 HKD/m², MAPE: 7032237.47%, R²: -73826646169.6818
2025-03-29 13:42:42,411 - INFO - Ensemble New Territories - 90% CI: [21582560721.53, 26700026128.49]
2025-03-29 13:42:42,417 - INFO - Features shape: (8,)
2025-03-29 13:42:42,417 - INFO - Number of selected features in predict_future: 8
2025-03-29 13:42:42,417 - INFO - Features values shape after manual selection: (1, 8)
2025-03-29 13:42:42,466 - INFO - Prophet future predictions: [[604221.48103139 425927.26046351 513848.70141675]
 [686365.26703981 436616.77133309 503569.43820518]
 [613583.83340956 443109.91800411 496157.38026166]
 [618133.95469029 421522.3899425  491583.54174065]
 [629246.28027444 410712.42432507 506732.67507544]]
2025-03-29 13:42:42,541 - INFO - Transformer future predictions: [[465643.09149298 365139.11435246 363237.7773538 ]
 [465643.09149298 365139.11435246 363237.7773538 ]
 [465643.09149298 365139.11435246 363237.7773538 ]
 [465643.09149298 365139.11435246 363237.7773538 ]
 [465643.09149298 365139.11435246 363237.7773538 ]]
2025-03-29 13:42:42,541 - INFO - Future predictions before inverse transform: [[521074.44730834 389454.37279688 423482.14697898]
 [553931.96171171 393730.17714471 419370.44169435]
 [524819.38825961 396327.43581312 416405.61851694]
 [526639.4367719  387692.42458848 414576.08310854]
 [531084.36700556 383368.43834151 420635.73644246]]
2025-03-29 13:42:42,550 - INFO - Future predictions (first 5 rows):         Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0 2025-02-01       521074.447308       389454.372797       423482.146979           423482.146979                 442603.270198                 469723.925673
1 2025-03-01       553931.961712       393730.177145       419370.441694           419370.441694                 440870.909776                 469742.084278
2 2025-04-01       524819.388260       396327.435813       416405.618517           416405.618517                 441811.930282                 469689.376996
3 2025-05-01       526639.436772       387692.424588       414576.083109           414576.083109                 441841.221691                 471206.616047
4 2025-06-01       531084.367006       383368.438342       420635.736442           420635.736442                 441144.140552                 468495.679707
2025-03-29 13:42:44,486 - INFO - 
Future Predictions (First 12 Months):
2025-03-29 13:42:44,488 - INFO -          Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0  2025-02-01       521074.447308       389454.372797       423482.146979           423482.146979                 442603.270198                 469723.925673
1  2025-03-01       553931.961712       393730.177145       419370.441694           419370.441694                 440870.909776                 469742.084278
2  2025-04-01       524819.388260       396327.435813       416405.618517           416405.618517                 441811.930282                 469689.376996
3  2025-05-01       526639.436772       387692.424588       414576.083109           414576.083109                 441841.221691                 471206.616047
4  2025-06-01       531084.367006       383368.438342       420635.736442           420635.736442                 441144.140552                 468495.679707
5  2025-07-01       532328.714371       388546.253283       419955.156414           419955.156414                 441512.556198                 470745.738065
6  2025-08-01       532612.117632       395354.355832       418462.343820           418462.343820                 444254.116876                 471152.156898
7  2025-09-01       531982.707209       380741.716481       420054.936886           420054.936886                 439957.113973                 471482.194285
8  2025-10-01       538103.684258       379680.575662       416534.814666           416534.814666                 442073.468545                 471265.053503
9  2025-11-01       539306.683013       394523.065642       426094.559954           426094.559954                 440329.001285                 468116.418075
10 2025-12-01       521984.155075       393532.946481       421181.782809           421181.782809                 441878.810155                 471118.115516
11 2026-01-01       535658.473024       391630.849717       422199.690533           422199.690533                 443100.895088                 469824.391161
2025-03-29 13:47:47,506 - INFO - Processing new data...
2025-03-29 13:47:47,510 - INFO - Loading data files...
2025-03-29 13:47:47,685 - INFO - Merging datasets...
2025-03-29 13:47:47,716 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 13:47:47,720 - INFO - Target columns: ['Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-29 13:47:47,721 - INFO - Data in Price_Hong_Kong (first 5 rows): [145982, 111466, 107098, 110840, 171299]
2025-03-29 13:47:47,722 - INFO - Min value in Price_Hong_Kong: 65409, Max value in Price_Hong_Kong: 888210
2025-03-29 13:47:47,722 - INFO - Data in Price_Kowloon (first 5 rows): [136973, 234150, 161751, 227823, 139793]
2025-03-29 13:47:47,722 - INFO - Min value in Price_Kowloon: 79192, Max value in Price_Kowloon: 627952
2025-03-29 13:47:47,722 - INFO - Data in Price_New_Territories (first 5 rows): [140446, 111028, 104394, 82195, 153616]
2025-03-29 13:47:47,722 - INFO - Min value in Price_New_Territories: 61105, Max value in Price_New_Territories: 708985
2025-03-29 13:47:47,728 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 13:47:47,747 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 13:47:47,767 - INFO - Number of selected features before feature selection: 57
2025-03-29 13:47:47,795 - INFO - Target values (y) before scaling: [[145982. 136973. 140446.]
 [111466. 234150. 111028.]
 [107098. 161751. 104394.]
 [110840. 227823.  82195.]
 [171299. 139793. 153616.]]
2025-03-29 13:47:47,795 - INFO - Target values (y) min: 61105.0, max: 888210.0
2025-03-29 13:47:47,812 - INFO - Price scaler mean_: [341777.68690096 297930.59744409 249102.16536864]
2025-03-29 13:47:47,812 - INFO - Price scaler scale_: [184464.04997183 124015.20656389 133778.90598671]
2025-03-29 13:47:47,812 - INFO - y_test before inverse transform: [[ 0.22259792  1.92912151  1.18947627]
 [ 0.56984715  0.50229649  2.64853291]
 [ 1.00264151  0.99538924  0.80267389]
 [ 1.2820347   0.66821969  0.50048873]
 [ 0.59429636 -0.03074298  0.84647751]]
2025-03-29 13:47:47,814 - INFO - Performing feature selection with mutual information...
2025-03-29 13:47:47,885 - INFO - Selected features after feature selection: ['Index_C', 'Index_E', 'Yield_C', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'B_Hong Kong', 'Year']
2025-03-29 13:47:47,885 - INFO - Number of selected features after feature selection: 8
2025-03-29 13:47:47,886 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Index_C', 'Index_E', 'Yield_C', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'B_Hong Kong', 'Year']
2025-03-29 13:47:47,886 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 13:47:47,901 - INFO - Using device: cpu
2025-03-29 13:47:47,901 - INFO - Training Transformer model for Hong Kong...
2025-03-29 13:47:48,570 - INFO - Epoch 10/100, Loss for Hong Kong: 0.2402
2025-03-29 13:47:49,064 - INFO - Epoch 20/100, Loss for Hong Kong: 0.2446
2025-03-29 13:47:49,699 - INFO - Epoch 30/100, Loss for Hong Kong: 0.1780
2025-03-29 13:47:50,099 - INFO - Epoch 40/100, Loss for Hong Kong: 0.2790
2025-03-29 13:47:50,432 - INFO - Epoch 50/100, Loss for Hong Kong: 0.1198
2025-03-29 13:47:50,719 - INFO - Epoch 60/100, Loss for Hong Kong: 0.2252
2025-03-29 13:47:51,001 - INFO - Epoch 70/100, Loss for Hong Kong: 0.1788
2025-03-29 13:47:51,343 - INFO - Epoch 80/100, Loss for Hong Kong: 0.3321
2025-03-29 13:47:51,672 - INFO - Epoch 90/100, Loss for Hong Kong: 0.2630
2025-03-29 13:47:52,039 - INFO - Epoch 100/100, Loss for Hong Kong: 0.1603
2025-03-29 13:47:52,043 - INFO - Training Transformer model for Kowloon...
2025-03-29 13:47:52,617 - INFO - Epoch 10/100, Loss for Kowloon: 0.2502
2025-03-29 13:47:52,934 - INFO - Epoch 20/100, Loss for Kowloon: 0.3156
2025-03-29 13:47:53,226 - INFO - Epoch 30/100, Loss for Kowloon: 0.1445
2025-03-29 13:47:53,510 - INFO - Epoch 40/100, Loss for Kowloon: 0.2674
2025-03-29 13:47:53,785 - INFO - Epoch 50/100, Loss for Kowloon: 0.0558
2025-03-29 13:47:54,072 - INFO - Epoch 60/100, Loss for Kowloon: 0.3261
2025-03-29 13:47:54,348 - INFO - Epoch 70/100, Loss for Kowloon: 0.2111
2025-03-29 13:47:54,624 - INFO - Epoch 80/100, Loss for Kowloon: 0.1241
2025-03-29 13:47:54,906 - INFO - Epoch 90/100, Loss for Kowloon: 0.2508
2025-03-29 13:47:55,192 - INFO - Epoch 100/100, Loss for Kowloon: 0.1645
2025-03-29 13:47:55,193 - INFO - Training Transformer model for New Territories...
2025-03-29 13:47:55,477 - INFO - Epoch 10/100, Loss for New Territories: 0.2932
2025-03-29 13:47:55,754 - INFO - Epoch 20/100, Loss for New Territories: 0.1043
2025-03-29 13:47:56,026 - INFO - Epoch 30/100, Loss for New Territories: 0.2945
2025-03-29 13:47:56,306 - INFO - Epoch 40/100, Loss for New Territories: 0.3081
2025-03-29 13:47:56,585 - INFO - Epoch 50/100, Loss for New Territories: 0.0767
2025-03-29 13:47:56,862 - INFO - Epoch 60/100, Loss for New Territories: 0.0730
2025-03-29 13:47:57,138 - INFO - Epoch 70/100, Loss for New Territories: 0.0786
2025-03-29 13:47:57,410 - INFO - Epoch 80/100, Loss for New Territories: 0.0846
2025-03-29 13:47:57,679 - INFO - Epoch 90/100, Loss for New Territories: 0.1390
2025-03-29 13:47:57,952 - INFO - Epoch 100/100, Loss for New Territories: 0.0951
2025-03-29 13:47:57,954 - INFO - Transformer test predictions: [[1.11489499 1.02891421 1.10907018]
 [1.11489499 1.02891421 1.10907018]
 [1.10303676 1.03107607 1.10184252]
 [1.10303676 1.03107607 1.10184252]
 [1.0903815  1.03305864 1.09330142]]
2025-03-29 13:47:57,960 - INFO - Training Prophet model for Hong Kong...
2025-03-29 13:47:57,968 - INFO - Prophet train data for Hong Kong:           ds       y
0 1999-01-01  145982
1 1999-02-01  111466
2 1999-03-01  107098
3 1999-04-01  110840
4 1999-05-01  171299
2025-03-29 13:47:57,968 - INFO - Number of data points in prophet_train for Hong Kong: 234
2025-03-29 13:47:58,009 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/7lkpq2sp.json
2025-03-29 13:47:58,014 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/swjz_4ut.json
2025-03-29 13:47:58,019 - DEBUG - idx 0
2025-03-29 13:47:58,019 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:47:58,019 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=7644', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/7lkpq2sp.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/swjz_4ut.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_model1dgaaz3y/prophet_model-20250329134758.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:47:58,019 - INFO - Chain [1] start processing
2025-03-29 13:47:58,113 - INFO - Chain [1] done processing
2025-03-29 13:47:58,154 - INFO - Prophet test predictions for Hong Kong: [549557.87033569 533494.81948792 533899.36184859 540976.22768549
 553007.88661332]
2025-03-29 13:47:58,155 - INFO - Training Prophet model for Kowloon...
2025-03-29 13:47:58,155 - INFO - Prophet train data for Kowloon:           ds       y
0 1999-01-01  136973
1 1999-02-01  234150
2 1999-03-01  161751
3 1999-04-01  227823
4 1999-05-01  139793
2025-03-29 13:47:58,155 - INFO - Number of data points in prophet_train for Kowloon: 234
2025-03-29 13:47:58,161 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/4tcwbo1b.json
2025-03-29 13:47:58,166 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/2tnflibt.json
2025-03-29 13:47:58,166 - DEBUG - idx 0
2025-03-29 13:47:58,166 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:47:58,166 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=86176', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/4tcwbo1b.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/2tnflibt.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelklyjefs3/prophet_model-20250329134758.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:47:58,166 - INFO - Chain [1] start processing
2025-03-29 13:47:58,222 - INFO - Chain [1] done processing
2025-03-29 13:47:58,248 - INFO - Prophet test predictions for Kowloon: [411687.64391091 434039.85363333 404201.25486984 387293.33844205
 431525.77853287]
2025-03-29 13:47:58,248 - INFO - Training Prophet model for New Territories...
2025-03-29 13:47:58,250 - INFO - Prophet train data for New Territories:           ds         y
0 1999-01-01  140446.0
1 1999-02-01  111028.0
2 1999-03-01  104394.0
3 1999-04-01   82195.0
4 1999-05-01  153616.0
2025-03-29 13:47:58,250 - INFO - Number of data points in prophet_train for New Territories: 234
2025-03-29 13:47:58,255 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/fnw_mwz3.json
2025-03-29 13:47:58,260 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/_nk0uny3.json
2025-03-29 13:47:58,260 - DEBUG - idx 0
2025-03-29 13:47:58,260 - DEBUG - running CmdStan, num_threads: None
2025-03-29 13:47:58,260 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=86341', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/fnw_mwz3.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/_nk0uny3.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelojdny_ui/prophet_model-20250329134758.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 13:47:58,260 - INFO - Chain [1] start processing
2025-03-29 13:47:58,318 - INFO - Chain [1] done processing
2025-03-29 13:47:58,344 - INFO - Prophet test predictions for New Territories: [402793.91425732 399316.91910021 416399.45842783 392776.27986319
 432534.18146572]
2025-03-29 13:47:58,348 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 13:47:58,349 - INFO - Ensemble predictions before inverse transform: [[219823.81707127 164675.67491289 161118.23114504]
 [213398.59673216 173616.55880186 159727.43308219]
 [213560.40656149 161681.12059358 166560.44447664]
 [216391.15289625 154917.95402246 157111.17305079]
 [221203.80887423 172610.93124834 173014.32856714]]
2025-03-29 13:47:58,353 - INFO - y_true (actual test prices): [[382839. 537171. 408229.]
 [446894. 360223. 603420.]
 [526729. 421374. 356483.]
 [578267. 380800. 316057.]
 [451404. 294118. 362343.]]
2025-03-29 13:47:58,353 - INFO - y_pred (predicted test prices): [[4.05499334e+10 2.04225858e+10 2.15544698e+10]
 [3.93647112e+10 2.15313913e+10 2.13684104e+10]
 [3.93945593e+10 2.00512155e+10 2.22825231e+10]
 [3.99167302e+10 1.92124800e+10 2.10184100e+10]
 [4.08044922e+10 2.14066782e+10 2.31459167e+10]]
2025-03-29 13:47:58,357 - INFO - Ensemble Hong Kong - RMSE: 43167911196.35 HKD/m², MAE: 43091155484.01 HKD/m², MAPE: 10129039.77%, R²: -99071690499.4759
2025-03-29 13:47:58,357 - INFO - Ensemble Hong Kong - 90% CI: [39364185803.57, 47269478171.89]
2025-03-29 13:47:58,358 - INFO - Ensemble Kowloon - RMSE: 20923593290.14 HKD/m², MAE: 20908219193.78 HKD/m², MAPE: 5968422.65%, R²: -60111603079.2835
2025-03-29 13:47:58,358 - INFO - Ensemble Kowloon - 90% CI: [19401997557.34, 21968168551.50]
2025-03-29 13:47:58,358 - INFO - Ensemble New Territories - RMSE: 24239113222.43 HKD/m², MAE: 24188932940.40 HKD/m², MAPE: 7032237.68%, R²: -73826650757.3059
2025-03-29 13:47:58,358 - INFO - Ensemble New Territories - 90% CI: [21647611866.89, 26668948649.66]
2025-03-29 13:47:58,363 - INFO - Features shape: (8,)
2025-03-29 13:47:58,363 - INFO - Number of selected features in predict_future: 8
2025-03-29 13:47:58,363 - INFO - Features values shape after manual selection: (1, 8)
2025-03-29 13:47:58,421 - INFO - Prophet future predictions: [[604221.48103139 425927.26046351 513848.70141675]
 [686365.26703981 436616.77133309 503569.43820518]
 [613583.83340956 443109.91800411 496157.38026166]
 [618133.95469029 421522.3899425  491583.54174065]
 [629246.28027444 410712.42432507 506732.67507544]]
2025-03-29 13:47:58,493 - INFO - Transformer future predictions: [[411896.96589908 407249.56661872 340938.22840857]
 [411896.96589908 407249.56661872 340938.22840857]
 [411896.96589908 407249.56661872 340938.22840857]
 [411896.96589908 407249.56661872 340938.22840857]
 [411896.96589908 407249.56661872 340938.22840857]]
2025-03-29 13:47:58,493 - INFO - Future predictions before inverse transform: [[488826.77195201 414720.64415664 410102.41761184]
 [521684.28635537 418996.44850447 405990.71232721]
 [492571.71290327 421593.70717288 403025.88914981]
 [494391.76141557 412958.69594823 401196.3537414 ]
 [498836.69164923 408634.70970126 407256.00707532]]
2025-03-29 13:47:58,504 - INFO - Future predictions (first 5 rows):         Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0 2025-02-01       488826.771952       414720.644157       410102.417612           414720.644157                 434016.416656                 464186.595639
1 2025-03-01       521684.286355       418996.448504       405990.712327           418996.448504                 435987.713320                 462991.285325
2 2025-04-01       492571.712903       421593.707173       403025.889150           421593.707173                 434414.662423                 464328.784544
3 2025-05-01       494391.761416       412958.695948       401196.353741           412958.695948                 434970.240085                 464040.053334
4 2025-06-01       498836.691649       408634.709701       407256.007075           408634.709701                 433748.571483                 464624.493750
2025-03-29 13:47:59,791 - INFO - test_pred for Hong Kong: [219823.81707127 213398.59673216 213560.40656149 216391.15289625
 221203.80887423]
2025-03-29 13:47:59,792 - INFO - testY_inverse for Hong Kong: [382839. 446894. 526729. 578267. 451404.]
2025-03-29 13:47:59,886 - INFO - test_pred for Kowloon: [164675.67491289 173616.55880186 161681.12059358 154917.95402246
 172610.93124834]
2025-03-29 13:47:59,890 - INFO - testY_inverse for Kowloon: [537171. 360223. 421374. 380800. 294118.]
2025-03-29 13:47:59,919 - INFO - test_pred for New Territories: [161118.23114504 159727.43308219 166560.44447664 157111.17305079
 173014.32856714]
2025-03-29 13:47:59,919 - INFO - testY_inverse for New Territories: [408229. 603420. 356483. 316057. 362343.]
2025-03-29 13:48:00,472 - INFO - 
Future Predictions (First 12 Months):
2025-03-29 13:48:00,473 - INFO -          Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0  2025-02-01       488826.771952       414720.644157       410102.417612           414720.644157                 434016.416656                 464186.595639
1  2025-03-01       521684.286355       418996.448504       405990.712327           418996.448504                 435987.713320                 462991.285325
2  2025-04-01       492571.712903       421593.707173       403025.889150           421593.707173                 434414.662423                 464328.784544
3  2025-05-01       494391.761416       412958.695948       401196.353741           412958.695948                 434970.240085                 464040.053334
4  2025-06-01       498836.691649       408634.709701       407256.007075           408634.709701                 433748.571483                 464624.493750
5  2025-07-01       500081.039015       413812.524643       406575.427047           413812.524643                 434048.204265                 464446.122248
6  2025-08-01       500364.442276       420620.627192       405082.614453           420620.627192                 433190.523129                 463902.862102
7  2025-09-01       499735.031853       406007.987841       406675.207519           406675.207519                 434024.169065                 462911.285907
8  2025-10-01       505856.008902       404946.847022       403155.085299           404946.847022                 436424.346411                 464246.471169
9  2025-11-01       507059.007657       419789.337002       412714.830587           419789.337002                 434018.569925                 462984.748390
10 2025-12-01       489736.479719       418799.217841       407802.053442           418799.217841                 435572.125819                 463293.866895
11 2026-01-01       503410.797668       416897.121077       408819.961166           416897.121077                 436142.723055                 462474.849771
2025-03-29 13:55:48,435 - INFO - Processing new data...
2025-03-29 13:55:48,439 - INFO - Loading data files...
2025-03-29 13:55:48,526 - INFO - Columns in df_rents_prices: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-29 13:55:48,559 - INFO - First 5 rows of df_rents_prices:
   Year  Month  Rent_Hong_Kong  Rent_Kowloon  Rent_New_Territories  Price_Hong_Kong  Price_Kowloon  Price_New_Territories
0  1999      1             776           799                   551           145982         136973                 140446
1  1999      2             793           835                   568           111466         234150                 111028
2  1999      3             790           865                   679           107098         161751                 104394
3  1999      4             759           831                   681           110840         227823                  82195
4  1999      5             717           861                   617           171299         139793                 153616
2025-03-29 13:55:48,559 - INFO - Columns in df_yields: ['Year', 'Month', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E']
2025-03-29 13:55:48,567 - INFO - First 5 rows of df_yields:
   Year  Month  Yield_A  Yield_B  Yield_C  Yield_D  Yield_E
0  1999      1      5.2      4.3      4.3      4.5      4.5
1  1999      2      5.2      4.3      4.4      4.7      4.4
2  1999      3      5.2      4.3      4.5      4.6      4.6
3  1999      4      5.1      4.4      4.4      4.5      4.2
4  1999      5      5.1      4.3      4.4      4.5      4.1
2025-03-29 13:55:48,567 - INFO - Columns in df_sales: ['Year', 'Month', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration']
2025-03-29 13:55:48,568 - INFO - First 5 rows of df_sales:
   Year  Month  Primary_Sales_No  Primary_Sales_Consideration  Secondary_Sales_No  Secondary_Sales_Consideration
0  2002      1              2718                         8218                5129                           9966
1  2002      2              1506                         4305                4189                           8070
2  2002      3              1709                         4190                3741                           6795
3  2002      4              2543                         6516                4866                           8739
4  2002      5              2257                         5844                5068                          11097
2025-03-29 13:55:48,568 - INFO - Columns in df_population: ['Year', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 13:55:48,570 - INFO - First 5 rows of df_population:
   Year  Population  Yearly_Percent_Change  Yearly Change  Migrants_Net  Median Age  Fertility Rate  Density  Urban_Pop_Percent  Urban Population  Share_World_Pop  World Population  Global Rank
0  2005     6908486                   0.60          40764         -1488        37.7            0.96     6580               98.8           6827761            0.100        6586970132           99
1  2010     7101617                   0.55          38626          8307        39.9            1.12     6763               98.9           7025221            0.100        7021732148          102
2  2015     7366409                   0.73          52958         10547        41.7            1.23     7016               98.4           7245701            0.099        7470491872          102
3  2020     7490235                   0.33          24765         -1800        44.4            0.89     7134                NaN        7887001292            0.095        7887001292          103
4  2022     7465915                  -0.16         -12160         -3427        45.6            0.71     7110                NaN        8021407192            0.093        8021407192          104
2025-03-29 13:55:48,570 - INFO - Columns in df_rental_prices: ['Year', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories']
2025-03-29 13:55:48,571 - INFO - First 5 rows of df_rental_prices:
   Year  A_Hong Kong  A_Kowloon  A_New Territories  B_Hong Kong  B_Kowloon  B_New Territories  C_Hong Kong  C_Kowloon  C_New Territories  D_Hong Kong  D_Kowloon  D_New Territories  E_Hong Kong  E_Kowloon  E_New Territories
0  1999          193        173                133          197        157                116          248        183                140          274        187                177          307        186                175
1  2000          192        166                130          198        149                117          252        172                144          276        195                184          316        197                174
2  2001          187        153                120          191        146                112          254        184                141          282        233                177          328        207                186
3  2002          165        134                105          168        132                101          225        164                122          247        196                156          305        190                169
4  2003          152        122                 93          147        120                 88          191        157                103          216        172                133          261        182                146
2025-03-29 13:55:48,571 - INFO - Columns in df_rental_indices: ['Year', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes']
2025-03-29 13:55:48,572 - INFO - First 5 rows of df_rental_indices:
   Year  Index_A  Index_B  Index_C  Index_D  Index_E    A.1   B & C  Index_D_E  Index_All_Classes
0  1999    100.0    100.0    100.0    100.0    100.0  100.0   100.0      100.0                NaN
1  2000     88.3     89.5     91.2     94.2     98.7   89.2    95.4       89.6                NaN
2  2001     77.2     78.8     80.8     83.2     87.8   78.4    84.4       78.7                NaN
3  2002     68.1     70.2     71.9     76.6     81.8   69.5    77.9       69.9                NaN
4  2003     59.7     61.1     65.3     70.2     76.2   61.0    72.0       61.6                NaN
2025-03-29 13:55:48,572 - INFO - Columns in df_economic: ['Year', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate']
2025-03-29 13:55:48,572 - INFO - First 5 rows of df_economic:
   Year  GDP_Growth_Rate  Unemployment_Rate  Annual_Change_Unemployment  Real_Interest_Rate
0  2002         1.656701               7.28                        2.19            8.805613
1  2003         3.056284               7.86                        0.58           11.711278
2  2004         8.700021               6.74                       -1.12            8.932391
3  2005         7.388156               5.58                       -1.16            6.367951
4  2006         7.032607               4.77                       -0.81            8.496912
2025-03-29 13:55:48,609 - INFO - Merging datasets...
2025-03-29 13:55:48,621 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 13:55:48,627 - INFO - First 5 rows of merged DataFrame:
   Year  Month  Rent_Hong_Kong  Rent_Kowloon  Rent_New_Territories  Price_Hong_Kong  Price_Kowloon  Price_New_Territories       Date  Yield_A  Yield_B  Yield_C  Yield_D  Yield_E  Primary_Sales_No  Primary_Sales_Consideration  Secondary_Sales_No  Secondary_Sales_Consideration  A_Hong Kong  A_Kowloon  A_New Territories  B_Hong Kong  B_Kowloon  B_New Territories  C_Hong Kong  C_Kowloon  C_New Territories  D_Hong Kong  D_Kowloon  D_New Territories  E_Hong Kong  E_Kowloon  E_New Territories  Index_A  Index_B  Index_C  Index_D  Index_E    A.1   B & C  Index_D_E  Index_All_Classes  GDP_Growth_Rate  Unemployment_Rate  Annual_Change_Unemployment  Real_Interest_Rate  Population  Yearly_Percent_Change  Yearly Change  Migrants_Net  Median Age  Fertility Rate  Density  Urban_Pop_Percent  Urban Population  Share_World_Pop  World Population  Global Rank
0  1999      1             776           799                   551           145982         136973                 140446 1999-01-01      5.2      4.3      4.3      4.5      4.5               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0    100.0    100.0    100.0    100.0    100.0  100.0   100.0      100.0                NaN              NaN                NaN                         NaN                 NaN         NaN                    NaN            NaN           NaN         NaN             NaN      NaN                NaN               NaN              NaN               NaN          NaN
1  1999      2             793           835                   568           111466         234150                 111028 1999-02-01      5.2      4.3      4.4      4.7      4.4               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0    100.0    100.0    100.0    100.0    100.0  100.0   100.0      100.0                NaN              NaN                NaN                         NaN                 NaN         NaN                    NaN            NaN           NaN         NaN             NaN      NaN                NaN               NaN              NaN               NaN          NaN
2  1999      3             790           865                   679           107098         161751                 104394 1999-03-01      5.2      4.3      4.5      4.6      4.6               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0    100.0    100.0    100.0    100.0    100.0  100.0   100.0      100.0                NaN              NaN                NaN                         NaN                 NaN         NaN                    NaN            NaN           NaN         NaN             NaN      NaN                NaN               NaN              NaN               NaN          NaN
3  1999      4             759           831                   681           110840         227823                  82195 1999-04-01      5.1      4.4      4.4      4.5      4.2               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0    100.0    100.0    100.0    100.0    100.0  100.0   100.0      100.0                NaN              NaN                NaN                         NaN                 NaN         NaN                    NaN            NaN           NaN         NaN             NaN      NaN                NaN               NaN              NaN               NaN          NaN
4  1999      5             717           861                   617           171299         139793                 153616 1999-05-01      5.1      4.3      4.4      4.5      4.1               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0    100.0    100.0    100.0    100.0    100.0  100.0   100.0      100.0                NaN              NaN                NaN                         NaN                 NaN         NaN                    NaN            NaN           NaN         NaN             NaN      NaN                NaN               NaN              NaN               NaN          NaN
2025-03-29 13:55:48,629 - INFO - Target columns: ['Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-29 13:55:48,629 - INFO - Data in Price_Hong_Kong (first 5 rows): [145982, 111466, 107098, 110840, 171299]
2025-03-29 13:55:48,631 - INFO - Min value in Price_Hong_Kong: 65409, Max value in Price_Hong_Kong: 888210
2025-03-29 13:55:48,631 - INFO - Data in Price_Kowloon (first 5 rows): [136973, 234150, 161751, 227823, 139793]
2025-03-29 13:55:48,631 - INFO - Min value in Price_Kowloon: 79192, Max value in Price_Kowloon: 627952
2025-03-29 13:55:48,631 - INFO - Data in Price_New_Territories (first 5 rows): [140446, 111028, 104394, 82195, 153616]
2025-03-29 13:55:48,631 - INFO - Min value in Price_New_Territories: 61105, Max value in Price_New_Territories: 708985
2025-03-29 13:55:48,635 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 13:55:48,652 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 13:55:48,670 - INFO - Number of selected features before feature selection: 64
2025-03-29 13:55:48,705 - INFO - Target values (y) before scaling: [[145982. 136973. 140446.]
 [111466. 234150. 111028.]
 [107098. 161751. 104394.]
 [110840. 227823.  82195.]
 [171299. 139793. 153616.]]
2025-03-29 13:55:48,705 - INFO - Target values (y) min: 61105.0, max: 888210.0
2025-03-29 13:55:48,719 - INFO - Price scaler mean_: [341777.68690096 297930.59744409 249102.16536864]
2025-03-29 13:55:48,719 - INFO - Price scaler scale_: [184464.04997183 124015.20656389 133778.90598671]
2025-03-29 13:55:48,719 - INFO - y_test before inverse transform: [[ 0.22259792  1.92912151  1.18947627]
 [ 0.56984715  0.50229649  2.64853291]
 [ 1.00264151  0.99538924  0.80267389]
 [ 1.2820347   0.66821969  0.50048873]
 [ 0.59429636 -0.03074298  0.84647751]]
2025-03-29 13:55:48,719 - INFO - Performing feature selection with mutual information...
2025-03-29 13:55:48,792 - INFO - Selected features after feature selection: ['E_Kowloon', 'Index_C', 'Index_E', 'Yield_B', 'C_Hong Kong', 'Real_Interest_Rate', 'B_Hong Kong', 'Year']
2025-03-29 13:55:48,792 - INFO - Number of selected features after feature selection: 8
2025-03-29 13:55:48,793 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'E_Kowloon', 'Index_C', 'Index_E', 'Yield_B', 'C_Hong Kong', 'Real_Interest_Rate', 'B_Hong Kong', 'Year']
2025-03-29 13:55:48,793 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 13:55:48,803 - INFO - Using device: cpu
2025-03-29 13:55:48,803 - INFO - Training Transformer model for Hong Kong...
2025-03-29 13:55:49,314 - INFO - Epoch 10/100, Loss for Hong Kong: 0.1613
2025-03-29 13:55:49,611 - INFO - Epoch 20/100, Loss for Hong Kong: 0.2612
2025-03-29 13:55:49,902 - INFO - Epoch 30/100, Loss for Hong Kong: 0.2344
2025-03-29 13:55:50,189 - INFO - Epoch 40/100, Loss for Hong Kong: 0.1614
2025-03-29 13:55:50,475 - INFO - Epoch 50/100, Loss for Hong Kong: 0.1091
2025-03-29 13:55:50,766 - INFO - Epoch 60/100, Loss for Hong Kong: 0.1287
2025-03-29 13:55:51,046 - INFO - Epoch 70/100, Loss for Hong Kong: 0.3576
2025-03-29 13:55:51,320 - INFO - Epoch 80/100, Loss for Hong Kong: 0.0444
2025-03-29 13:55:51,594 - INFO - Epoch 90/100, Loss for Hong Kong: 0.0893
2025-03-29 13:55:51,872 - INFO - Epoch 100/100, Loss for Hong Kong: 0.3972
2025-03-29 13:55:51,875 - ERROR - Error in main execution: could not broadcast input array from shape (79,) into shape (234,)
2025-03-29 14:01:32,494 - INFO - Processing new data...
2025-03-29 14:01:32,496 - INFO - Loading data files...
2025-03-29 14:01:32,552 - INFO - Columns in df_rents_prices: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-29 14:01:32,560 - INFO - First 5 rows of df_rents_prices:
   Year  Month  Rent_Hong_Kong  Rent_Kowloon  Rent_New_Territories  Price_Hong_Kong  Price_Kowloon  Price_New_Territories
0  1999      1             776           799                   551           145982         136973                 140446
1  1999      2             793           835                   568           111466         234150                 111028
2  1999      3             790           865                   679           107098         161751                 104394
3  1999      4             759           831                   681           110840         227823                  82195
4  1999      5             717           861                   617           171299         139793                 153616
2025-03-29 14:01:32,560 - INFO - Columns in df_yields: ['Year', 'Month', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E']
2025-03-29 14:01:32,562 - INFO - First 5 rows of df_yields:
   Year  Month  Yield_A  Yield_B  Yield_C  Yield_D  Yield_E
0  1999      1      5.2      4.3      4.3      4.5      4.5
1  1999      2      5.2      4.3      4.4      4.7      4.4
2  1999      3      5.2      4.3      4.5      4.6      4.6
3  1999      4      5.1      4.4      4.4      4.5      4.2
4  1999      5      5.1      4.3      4.4      4.5      4.1
2025-03-29 14:01:32,562 - INFO - Columns in df_sales: ['Year', 'Month', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration']
2025-03-29 14:01:32,562 - INFO - First 5 rows of df_sales:
   Year  Month  Primary_Sales_No  Primary_Sales_Consideration  Secondary_Sales_No  Secondary_Sales_Consideration
0  2002      1              2718                         8218                5129                           9966
1  2002      2              1506                         4305                4189                           8070
2  2002      3              1709                         4190                3741                           6795
3  2002      4              2543                         6516                4866                           8739
4  2002      5              2257                         5844                5068                          11097
2025-03-29 14:01:32,562 - INFO - Columns in df_population: ['Year', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 14:01:32,563 - INFO - First 5 rows of df_population:
   Year  Population  Yearly_Percent_Change  Yearly Change  Migrants_Net  Median Age  Fertility Rate  Density  Urban_Pop_Percent  Urban Population  Share_World_Pop  World Population  Global Rank
0  2005     6908486                   0.60          40764         -1488        37.7            0.96     6580               98.8           6827761            0.100        6586970132           99
1  2010     7101617                   0.55          38626          8307        39.9            1.12     6763               98.9           7025221            0.100        7021732148          102
2  2015     7366409                   0.73          52958         10547        41.7            1.23     7016               98.4           7245701            0.099        7470491872          102
3  2020     7490235                   0.33          24765         -1800        44.4            0.89     7134                NaN        7887001292            0.095        7887001292          103
4  2022     7465915                  -0.16         -12160         -3427        45.6            0.71     7110                NaN        8021407192            0.093        8021407192          104
2025-03-29 14:01:32,563 - INFO - Columns in df_rental_prices: ['Year', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories']
2025-03-29 14:01:32,564 - INFO - First 5 rows of df_rental_prices:
   Year  A_Hong Kong  A_Kowloon  A_New Territories  B_Hong Kong  B_Kowloon  B_New Territories  C_Hong Kong  C_Kowloon  C_New Territories  D_Hong Kong  D_Kowloon  D_New Territories  E_Hong Kong  E_Kowloon  E_New Territories
0  1999          193        173                133          197        157                116          248        183                140          274        187                177          307        186                175
1  2000          192        166                130          198        149                117          252        172                144          276        195                184          316        197                174
2  2001          187        153                120          191        146                112          254        184                141          282        233                177          328        207                186
3  2002          165        134                105          168        132                101          225        164                122          247        196                156          305        190                169
4  2003          152        122                 93          147        120                 88          191        157                103          216        172                133          261        182                146
2025-03-29 14:01:32,564 - INFO - Columns in df_rental_indices: ['Year', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes']
2025-03-29 14:01:32,565 - INFO - First 5 rows of df_rental_indices:
   Year  Index_A  Index_B  Index_C  Index_D  Index_E    A.1   B & C  Index_D_E  Index_All_Classes
0  1999    100.0    100.0    100.0    100.0    100.0  100.0   100.0      100.0                NaN
1  2000     88.3     89.5     91.2     94.2     98.7   89.2    95.4       89.6                NaN
2  2001     77.2     78.8     80.8     83.2     87.8   78.4    84.4       78.7                NaN
3  2002     68.1     70.2     71.9     76.6     81.8   69.5    77.9       69.9                NaN
4  2003     59.7     61.1     65.3     70.2     76.2   61.0    72.0       61.6                NaN
2025-03-29 14:01:32,565 - INFO - Columns in df_economic: ['Year', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate']
2025-03-29 14:01:32,566 - INFO - First 5 rows of df_economic:
   Year  GDP_Growth_Rate  Unemployment_Rate  Annual_Change_Unemployment  Real_Interest_Rate
0  2002         1.656701               7.28                        2.19            8.805613
1  2003         3.056284               7.86                        0.58           11.711278
2  2004         8.700021               6.74                       -1.12            8.932391
3  2005         7.388156               5.58                       -1.16            6.367951
4  2006         7.032607               4.77                       -0.81            8.496912
2025-03-29 14:01:32,587 - INFO - Merging datasets...
2025-03-29 14:01:32,599 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'Yield_A', 'Yield_B', 'Yield_C', 'Yield_D', 'Yield_E', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong Kong', 'E_Kowloon', 'E_New Territories', 'Index_A', 'Index_B', 'Index_C', 'Index_D', 'Index_E', 'A.1', ' B & C', 'Index_D_E', 'Index_All_Classes', 'GDP_Growth_Rate', 'Unemployment_Rate', 'Annual_Change_Unemployment', 'Real_Interest_Rate', 'Population', 'Yearly_Percent_Change', 'Yearly Change', 'Migrants_Net', 'Median Age', 'Fertility Rate', 'Density', 'Urban_Pop_Percent', 'Urban Population', 'Share_World_Pop', 'World Population', 'Global Rank']
2025-03-29 14:01:32,605 - INFO - First 5 rows of merged DataFrame:
   Year  Month  Rent_Hong_Kong  Rent_Kowloon  Rent_New_Territories  Price_Hong_Kong  Price_Kowloon  Price_New_Territories       Date  Yield_A  Yield_B  Yield_C  Yield_D  Yield_E  Primary_Sales_No  Primary_Sales_Consideration  Secondary_Sales_No  Secondary_Sales_Consideration  A_Hong Kong  A_Kowloon  A_New Territories  B_Hong Kong  B_Kowloon  B_New Territories  C_Hong Kong  C_Kowloon  C_New Territories  D_Hong Kong  D_Kowloon  D_New Territories  E_Hong Kong  E_Kowloon  E_New Territories  Index_A  Index_B  Index_C  Index_D  Index_E    A.1   B & C  Index_D_E  Index_All_Classes  GDP_Growth_Rate  Unemployment_Rate  Annual_Change_Unemployment  Real_Interest_Rate  Population  Yearly_Percent_Change  Yearly Change  Migrants_Net  Median Age  Fertility Rate  Density  Urban_Pop_Percent  Urban Population  Share_World_Pop  World Population  Global Rank
0  1999      1             776           799                   551           145982         136973                 140446 1999-01-01      5.2      4.3      4.3      4.5      4.5               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0    100.0    100.0    100.0    100.0    100.0  100.0   100.0      100.0                NaN              NaN                NaN                         NaN                 NaN         NaN                    NaN            NaN           NaN         NaN             NaN      NaN                NaN               NaN              NaN               NaN          NaN
1  1999      2             793           835                   568           111466         234150                 111028 1999-02-01      5.2      4.3      4.4      4.7      4.4               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0    100.0    100.0    100.0    100.0    100.0  100.0   100.0      100.0                NaN              NaN                NaN                         NaN                 NaN         NaN                    NaN            NaN           NaN         NaN             NaN      NaN                NaN               NaN              NaN               NaN          NaN
2  1999      3             790           865                   679           107098         161751                 104394 1999-03-01      5.2      4.3      4.5      4.6      4.6               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0    100.0    100.0    100.0    100.0    100.0  100.0   100.0      100.0                NaN              NaN                NaN                         NaN                 NaN         NaN                    NaN            NaN           NaN         NaN             NaN      NaN                NaN               NaN              NaN               NaN          NaN
3  1999      4             759           831                   681           110840         227823                  82195 1999-04-01      5.1      4.4      4.4      4.5      4.2               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0    100.0    100.0    100.0    100.0    100.0  100.0   100.0      100.0                NaN              NaN                NaN                         NaN                 NaN         NaN                    NaN            NaN           NaN         NaN             NaN      NaN                NaN               NaN              NaN               NaN          NaN
4  1999      5             717           861                   617           171299         139793                 153616 1999-05-01      5.1      4.3      4.4      4.5      4.1               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0    100.0    100.0    100.0    100.0    100.0  100.0   100.0      100.0                NaN              NaN                NaN                         NaN                 NaN         NaN                    NaN            NaN           NaN         NaN             NaN      NaN                NaN               NaN              NaN               NaN          NaN
2025-03-29 14:01:32,606 - INFO - Target columns: ['Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-29 14:01:32,606 - INFO - Data in Price_Hong_Kong (first 5 rows): [145982, 111466, 107098, 110840, 171299]
2025-03-29 14:01:32,607 - INFO - Min value in Price_Hong_Kong: 65409, Max value in Price_Hong_Kong: 888210
2025-03-29 14:01:32,607 - INFO - Data in Price_Kowloon (first 5 rows): [136973, 234150, 161751, 227823, 139793]
2025-03-29 14:01:32,607 - INFO - Min value in Price_Kowloon: 79192, Max value in Price_Kowloon: 627952
2025-03-29 14:01:32,607 - INFO - Data in Price_New_Territories (first 5 rows): [140446, 111028, 104394, 82195, 153616]
2025-03-29 14:01:32,607 - INFO - Min value in Price_New_Territories: 61105, Max value in Price_New_Territories: 708985
2025-03-29 14:01:32,610 - WARNING - Interest Rate or Rental_Index_Class_A column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 14:01:32,620 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 14:01:32,630 - INFO - Number of selected features before feature selection: 64
2025-03-29 14:01:32,681 - INFO - Target values (y) before scaling: [[145982. 136973. 140446.]
 [111466. 234150. 111028.]
 [107098. 161751. 104394.]
 [110840. 227823.  82195.]
 [171299. 139793. 153616.]]
2025-03-29 14:01:32,681 - INFO - Target values (y) min: 61105.0, max: 888210.0
2025-03-29 14:01:32,693 - INFO - Price scaler mean_: [341777.68690096 297930.59744409 249102.16536864]
2025-03-29 14:01:32,694 - INFO - Price scaler scale_: [184464.04997183 124015.20656389 133778.90598671]
2025-03-29 14:01:32,694 - INFO - X_train shape: (234, 64)
2025-03-29 14:01:32,694 - INFO - X_test shape: (79, 64)
2025-03-29 14:01:32,694 - INFO - y_train shape: (234, 3)
2025-03-29 14:01:32,694 - INFO - y_test shape: (79, 3)
2025-03-29 14:01:32,695 - INFO - y_test before inverse transform: [[ 0.22259792  1.92912151  1.18947627]
 [ 0.56984715  0.50229649  2.64853291]
 [ 1.00264151  0.99538924  0.80267389]
 [ 1.2820347   0.66821969  0.50048873]
 [ 0.59429636 -0.03074298  0.84647751]]
2025-03-29 14:01:32,697 - INFO - Performing feature selection with mutual information...
2025-03-29 14:01:32,758 - INFO - Selected features after feature selection: ['D_Kowloon', 'Index_E', 'Yield_C', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'B_Hong Kong', 'Year']
2025-03-29 14:01:32,758 - INFO - Number of selected features after feature selection: 8
2025-03-29 14:01:32,759 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'D_Kowloon', 'Index_E', 'Yield_C', 'Yield_B', 'Real_Interest_Rate', 'C_Hong Kong', 'B_Hong Kong', 'Year']
2025-03-29 14:01:32,759 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 14:01:32,765 - INFO - Using device: cpu
2025-03-29 14:01:32,765 - INFO - Training Transformer model for Hong Kong...
2025-03-29 14:01:33,213 - INFO - Epoch 10/100, Loss for Hong Kong: 0.3563
2025-03-29 14:01:33,542 - INFO - Epoch 20/100, Loss for Hong Kong: 0.4380
2025-03-29 14:01:33,844 - INFO - Epoch 30/100, Loss for Hong Kong: 0.1406
2025-03-29 14:01:34,136 - INFO - Epoch 40/100, Loss for Hong Kong: 0.1018
2025-03-29 14:01:34,419 - INFO - Epoch 50/100, Loss for Hong Kong: 0.1511
2025-03-29 14:01:34,697 - INFO - Epoch 60/100, Loss for Hong Kong: 0.2405
2025-03-29 14:01:34,981 - INFO - Epoch 70/100, Loss for Hong Kong: 0.2030
2025-03-29 14:01:35,261 - INFO - Epoch 80/100, Loss for Hong Kong: 0.1171
2025-03-29 14:01:35,533 - INFO - Epoch 90/100, Loss for Hong Kong: 0.0820
2025-03-29 14:01:35,803 - INFO - Epoch 100/100, Loss for Hong Kong: 0.3511
2025-03-29 14:01:35,805 - INFO - Training Transformer model for Kowloon...
2025-03-29 14:01:36,111 - INFO - Epoch 10/100, Loss for Kowloon: 0.2998
2025-03-29 14:01:36,393 - INFO - Epoch 20/100, Loss for Kowloon: 0.4594
2025-03-29 14:01:36,672 - INFO - Epoch 30/100, Loss for Kowloon: 0.4627
2025-03-29 14:01:36,949 - INFO - Epoch 40/100, Loss for Kowloon: 0.1109
2025-03-29 14:01:37,235 - INFO - Epoch 50/100, Loss for Kowloon: 0.2921
2025-03-29 14:01:37,507 - INFO - Epoch 60/100, Loss for Kowloon: 0.2076
2025-03-29 14:01:37,809 - INFO - Epoch 70/100, Loss for Kowloon: 0.2063
2025-03-29 14:01:38,088 - INFO - Epoch 80/100, Loss for Kowloon: 0.1565
2025-03-29 14:01:38,365 - INFO - Epoch 90/100, Loss for Kowloon: 0.2673
2025-03-29 14:01:38,640 - INFO - Epoch 100/100, Loss for Kowloon: 0.1452
2025-03-29 14:01:38,641 - INFO - Training Transformer model for New Territories...
2025-03-29 14:01:38,932 - INFO - Epoch 10/100, Loss for New Territories: 0.3002
2025-03-29 14:01:39,212 - INFO - Epoch 20/100, Loss for New Territories: 0.1145
2025-03-29 14:01:39,488 - INFO - Epoch 30/100, Loss for New Territories: 0.0894
2025-03-29 14:01:39,766 - INFO - Epoch 40/100, Loss for New Territories: 0.2345
2025-03-29 14:01:40,040 - INFO - Epoch 50/100, Loss for New Territories: 0.0639
2025-03-29 14:01:40,308 - INFO - Epoch 60/100, Loss for New Territories: 0.0465
2025-03-29 14:01:40,581 - INFO - Epoch 70/100, Loss for New Territories: 0.1224
2025-03-29 14:01:40,852 - INFO - Epoch 80/100, Loss for New Territories: 0.0835
2025-03-29 14:01:41,121 - INFO - Epoch 90/100, Loss for New Territories: 0.1663
2025-03-29 14:01:41,392 - INFO - Epoch 100/100, Loss for New Territories: 0.0674
2025-03-29 14:01:41,394 - INFO - Transformer test predictions: [[1.04061162 0.99749994 1.19466686]
 [1.04061162 0.99749994 1.19466686]
 [1.03617489 0.99769402 1.18201399]
 [1.03617489 0.99769402 1.18201399]
 [1.02762806 0.997504   1.16767859]]
2025-03-29 14:01:41,400 - INFO - Training Prophet model for Hong Kong...
2025-03-29 14:01:41,407 - INFO - Prophet train data for Hong Kong:           ds       y
0 1999-01-01  145982
1 1999-02-01  111466
2 1999-03-01  107098
3 1999-04-01  110840
4 1999-05-01  171299
2025-03-29 14:01:41,407 - INFO - Number of data points in prophet_train for Hong Kong: 234
2025-03-29 14:01:41,441 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/y_pyogi2.json
2025-03-29 14:01:41,447 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/fe901kse.json
2025-03-29 14:01:41,457 - DEBUG - idx 0
2025-03-29 14:01:41,457 - DEBUG - running CmdStan, num_threads: None
2025-03-29 14:01:41,459 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=61342', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/y_pyogi2.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/fe901kse.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelw91tp6mu/prophet_model-20250329140141.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 14:01:41,459 - INFO - Chain [1] start processing
2025-03-29 14:01:41,551 - INFO - Chain [1] done processing
2025-03-29 14:01:41,589 - INFO - Prophet test predictions for Hong Kong: [549557.87033569 533494.81948792 533899.36184859 540976.22768549
 553007.88661332]
2025-03-29 14:01:41,589 - INFO - Training Prophet model for Kowloon...
2025-03-29 14:01:41,590 - INFO - Prophet train data for Kowloon:           ds       y
0 1999-01-01  136973
1 1999-02-01  234150
2 1999-03-01  161751
3 1999-04-01  227823
4 1999-05-01  139793
2025-03-29 14:01:41,590 - INFO - Number of data points in prophet_train for Kowloon: 234
2025-03-29 14:01:41,595 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/ceihx9yn.json
2025-03-29 14:01:41,600 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/o5ea23_d.json
2025-03-29 14:01:41,600 - DEBUG - idx 0
2025-03-29 14:01:41,600 - DEBUG - running CmdStan, num_threads: None
2025-03-29 14:01:41,600 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=92550', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/ceihx9yn.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/o5ea23_d.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelzeurt8de/prophet_model-20250329140141.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 14:01:41,600 - INFO - Chain [1] start processing
2025-03-29 14:01:41,654 - INFO - Chain [1] done processing
2025-03-29 14:01:41,681 - INFO - Prophet test predictions for Kowloon: [411687.64391091 434039.85363333 404201.25486984 387293.33844205
 431525.77853287]
2025-03-29 14:01:41,682 - INFO - Training Prophet model for New Territories...
2025-03-29 14:01:41,682 - INFO - Prophet train data for New Territories:           ds         y
0 1999-01-01  140446.0
1 1999-02-01  111028.0
2 1999-03-01  104394.0
3 1999-04-01   82195.0
4 1999-05-01  153616.0
2025-03-29 14:01:41,682 - INFO - Number of data points in prophet_train for New Territories: 234
2025-03-29 14:01:41,687 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/26a18rjd.json
2025-03-29 14:01:41,691 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/zl1q9i6p.json
2025-03-29 14:01:41,692 - DEBUG - idx 0
2025-03-29 14:01:41,692 - DEBUG - running CmdStan, num_threads: None
2025-03-29 14:01:41,692 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=88011', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/26a18rjd.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/zl1q9i6p.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelcfn5cmvp/prophet_model-20250329140141.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 14:01:41,692 - INFO - Chain [1] start processing
2025-03-29 14:01:41,745 - INFO - Chain [1] done processing
2025-03-29 14:01:41,771 - INFO - Prophet test predictions for New Territories: [402793.91425732 399316.91910021 416399.45842783 392776.27986319
 432534.18146572]
2025-03-29 14:01:41,776 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 14:01:41,776 - INFO - Ensemble predictions before inverse transform: [[219823.77250125 164675.65606433 161118.28250304]
 [213398.55216214 173616.5399533  159727.4844402 ]
 [213560.36644437 161681.10056434 166560.49257952]
 [216391.11277913 154917.93399323 157111.22115367]
 [221203.77122217 172610.90991555 173014.37319345]]
2025-03-29 14:01:41,781 - INFO - y_true (actual test prices): [[382839. 537171. 408229.]
 [446894. 360223. 603420.]
 [526729. 421374. 356483.]
 [578267. 380800. 316057.]
 [451404. 294118. 362343.]]
2025-03-29 14:01:41,781 - INFO - y_pred (predicted test prices): [[4.05499251e+10 2.04225834e+10 2.15544767e+10]
 [3.93647030e+10 2.15313890e+10 2.13684172e+10]
 [3.93945519e+10 2.00512130e+10 2.22825296e+10]
 [3.99167228e+10 1.92124775e+10 2.10184164e+10]
 [4.08044853e+10 2.14066756e+10 2.31459227e+10]]
2025-03-29 14:01:41,784 - INFO - Ensemble Hong Kong - RMSE: 43167909302.00 HKD/m², MAE: 43091153426.20 HKD/m², MAPE: 10129039.49%, R²: -99071681804.3082
2025-03-29 14:01:41,784 - INFO - Ensemble Hong Kong - 90% CI: [39453183215.02, 47436503010.80]
2025-03-29 14:01:41,784 - INFO - Ensemble Kowloon - RMSE: 20923594215.45 HKD/m², MAE: 20908220106.13 HKD/m², MAPE: 5968422.97%, R²: -60111608395.9384
2025-03-29 14:01:41,784 - INFO - Ensemble Kowloon - 90% CI: [19360402318.91, 21985885880.63]
2025-03-29 14:01:41,784 - INFO - Ensemble New Territories - RMSE: 24239117420.20 HKD/m², MAE: 24188937271.35 HKD/m², MAPE: 7032238.84%, R²: -73826676328.1174
2025-03-29 14:01:41,784 - INFO - Ensemble New Territories - 90% CI: [21604378792.88, 26665655352.95]
2025-03-29 14:01:41,789 - INFO - Features shape: (8,)
2025-03-29 14:01:41,789 - INFO - Number of selected features in predict_future: 8
2025-03-29 14:01:41,789 - INFO - Features values shape after manual selection: (1, 8)
2025-03-29 14:01:41,859 - INFO - Prophet future predictions: [[604221.48103139 425927.26046351 513848.70141675]
 [686365.26703981 436616.77133309 503569.43820518]
 [613583.83340956 443109.91800411 496157.38026166]
 [618133.95469029 421522.3899425  491583.54174065]
 [629246.28027444 410712.42432507 506732.67507544]]
2025-03-29 14:01:41,931 - INFO - Transformer future predictions: [[512359.38232009 434576.78643253 336953.57886927]
 [512359.38232009 434576.78643253 336953.57886927]
 [512359.38232009 434576.78643253 336953.57886927]
 [512359.38232009 434576.78643253 336953.57886927]
 [512359.38232009 434576.78643253 336953.57886927]]
2025-03-29 14:01:41,931 - INFO - Future predictions before inverse transform: [[549104.22180461 431116.97604492 407711.62788826]
 [581961.73620798 435392.78039275 403599.92260363]
 [552849.16275588 437990.03906116 400635.09942623]
 [554669.21126817 429355.02783652 398805.56401782]
 [559114.14150183 425031.04158955 404865.21735174]]
2025-03-29 14:01:41,938 - INFO - Future predictions (first 5 rows):         Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0 2025-02-01       549104.221805       431116.976045       407711.627888           431116.976045                 459102.449734                 488615.405908
1 2025-03-01       581961.736208       435392.780393       403599.922604           435392.780393                 458295.654437                 489183.190933
2 2025-04-01       552849.162756       437990.039061       400635.099426           437990.039061                 460090.829309                 490014.436491
3 2025-05-01       554669.211268       429355.027837       398805.564018           429355.027837                 460903.300699                 489330.914295
4 2025-06-01       559114.141502       425031.041590       404865.217352           425031.041590                 461449.735135                 488864.119900
2025-03-29 14:01:43,338 - INFO - test_pred for Hong Kong: [219823.77250125 213398.55216214 213560.36644437 216391.11277913
 221203.77122217]
2025-03-29 14:01:43,338 - INFO - testY_inverse for Hong Kong: [382839. 446894. 526729. 578267. 451404.]
2025-03-29 14:01:43,397 - INFO - test_pred for Kowloon: [164675.65606433 173616.5399533  161681.10056434 154917.93399323
 172610.90991555]
2025-03-29 14:01:43,397 - INFO - testY_inverse for Kowloon: [537171. 360223. 421374. 380800. 294118.]
2025-03-29 14:01:43,437 - INFO - test_pred for New Territories: [161118.28250304 159727.4844402  166560.49257952 157111.22115367
 173014.37319345]
2025-03-29 14:01:43,437 - INFO - testY_inverse for New Territories: [408229. 603420. 356483. 316057. 362343.]
2025-03-29 14:01:43,982 - INFO - 
Future Predictions (First 12 Months):
2025-03-29 14:01:43,985 - INFO -          Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0  2025-02-01       549104.221805       431116.976045       407711.627888           431116.976045                 459102.449734                 488615.405908
1  2025-03-01       581961.736208       435392.780393       403599.922604           435392.780393                 458295.654437                 489183.190933
2  2025-04-01       552849.162756       437990.039061       400635.099426           437990.039061                 460090.829309                 490014.436491
3  2025-05-01       554669.211268       429355.027837       398805.564018           429355.027837                 460903.300699                 489330.914295
4  2025-06-01       559114.141502       425031.041590       404865.217352           425031.041590                 461449.735135                 488864.119900
5  2025-07-01       560358.488867       430208.856531       404184.637324           430208.856531                 461073.695938                 489488.036762
6  2025-08-01       560641.892128       437016.959081       402691.824729           437016.959081                 461671.243883                 488983.432836
7  2025-09-01       560012.481705       422404.319729       404284.417795           422404.319729                 459887.041794                 489172.736671
8  2025-10-01       566133.458755       421343.178910       400764.295575           421343.178910                 458747.079853                 487570.400405
9  2025-11-01       567336.457509       436185.668890       410324.040863           436185.668890                 458470.103885                 489109.699687
10 2025-12-01       550013.929572       435195.549729       405411.263718           435195.549729                 458750.361700                 489298.931739
11 2026-01-01       563688.247521       433293.452965       406429.171442           433293.452965                 461546.357090                 489127.658308
2025-03-29 14:08:34,069 - ERROR - Data file /Users/mastin/project_folder/economic_indicators.csv not found.
2025-03-29 14:08:34,073 - ERROR - Error in main execution: Data file /Users/mastin/project_folder/economic_indicators.csv not found.
2025-03-29 14:12:47,944 - INFO - Processing new data...
2025-03-29 14:12:47,947 - INFO - Loading data files...
2025-03-29 14:12:47,999 - INFO - Columns in df_rents_prices: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-29 14:12:48,012 - INFO - First 5 rows of df_rents_prices:
   Year  Month  Rent_Hong_Kong  Rent_Kowloon  Rent_New_Territories  Price_Hong_Kong  Price_Kowloon  Price_New_Territories
0  1999      1             776           799                   551           145982         136973                 140446
1  1999      2             793           835                   568           111466         234150                 111028
2  1999      3             790           865                   679           107098         161751                 104394
3  1999      4             759           831                   681           110840         227823                  82195
4  1999      5             717           861                   617           171299         139793                 153616
2025-03-29 14:12:48,012 - INFO - Columns in df_yields: ['Year', 'Month', 'A', 'B', 'C', 'D', 'E']
2025-03-29 14:12:48,015 - INFO - First 5 rows of df_yields:
   Year  Month    A    B    C    D    E
0  1999      1  5.2  4.3  4.3  4.5  4.5
1  1999      2  5.2  4.3  4.4  4.7  4.4
2  1999      3  5.2  4.3  4.5  4.6  4.6
3  1999      4  5.1  4.4  4.4  4.5  4.2
4  1999      5  5.1  4.3  4.4  4.5  4.1
2025-03-29 14:12:48,015 - INFO - Columns in df_sales: ['Year', 'Month', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration']
2025-03-29 14:12:48,015 - INFO - First 5 rows of df_sales:
   Year  Month  Primary_Sales_No  Primary_Sales_Consideration  Secondary_Sales_No  Secondary_Sales_Consideration
0  2002      1              2718                         8218                5129                           9966
1  2002      2              1506                         4305                4189                           8070
2  2002      3              1709                         4190                3741                           6795
3  2002      4              2543                         6516                4866                           8739
4  2002      5              2257                         5844                5068                          11097
2025-03-29 14:12:48,015 - INFO - Columns in df_population: ['Year', 'Population', 'Yearly % Change', 'Yearly Change', 'Migrants (net)', 'Median Age', 'Fertility Rate', 'Density (P/Km²)', 'Urban Pop %', 'Urban Population', "Country's Share of World Pop", 'World Population', 'Global Rank']
2025-03-29 14:12:48,016 - INFO - First 5 rows of df_population:
   Year  Population  Yearly % Change  Yearly Change  Migrants (net)  Median Age  Fertility Rate  Density (P/Km²)  Urban Pop %  Urban Population  Country's Share of World Pop  World Population  Global Rank
0  2005     6908486             0.60          40764           -1488        37.7            0.96             6580         98.8           6827761                         0.100        6586970132           99
1  2010     7101617             0.55          38626            8307        39.9            1.12             6763         98.9           7025221                         0.100        7021732148          102
2  2015     7366409             0.73          52958           10547        41.7            1.23             7016         98.4           7245701                         0.099        7470491872          102
3  2020     7490235             0.33          24765           -1800        44.4            0.89             7134          NaN        7887001292                         0.095        7887001292          103
4  2022     7465915            -0.16         -12160           -3427        45.6            0.71             7110          NaN        8021407192                         0.093        8021407192          104
2025-03-29 14:12:48,016 - INFO - Columns in df_rental_prices: ['Year', 'A_Hong_Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong_Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong_Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong_Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong_Kong', 'E_Kowloon', 'E_New Territories']
2025-03-29 14:12:48,016 - INFO - First 5 rows of df_rental_prices:
   Year  A_Hong_Kong  A_Kowloon  A_New Territories  B_Hong_Kong  B_Kowloon  B_New Territories  C_Hong_Kong  C_Kowloon  C_New Territories  D_Hong_Kong  D_Kowloon  D_New Territories  E_Hong_Kong  E_Kowloon  E_New Territories
0  1999          193        173                133          197        157                116          248        183                140          274        187                177          307        186                175
1  2000          192        166                130          198        149                117          252        172                144          276        195                184          316        197                174
2  2001          187        153                120          191        146                112          254        184                141          282        233                177          328        207                186
3  2002          165        134                105          168        132                101          225        164                122          247        196                156          305        190                169
4  2003          152        122                 93          147        120                 88          191        157                103          216        172                133          261        182                146
2025-03-29 14:12:48,017 - INFO - Columns in df_rental_indices: ['Year', 'A', 'B', 'C', 'D', 'E', 'A.1', ' B & C', 'D & E', 'All Classes']
2025-03-29 14:12:48,018 - INFO - First 5 rows of df_rental_indices:
   Year      A      B      C      D      E    A.1   B & C  D & E  All Classes
0  1999  100.0  100.0  100.0  100.0  100.0  100.0   100.0  100.0          NaN
1  2000   88.3   89.5   91.2   94.2   98.7   89.2    95.4   89.6          NaN
2  2001   77.2   78.8   80.8   83.2   87.8   78.4    84.4   78.7          NaN
3  2002   68.1   70.2   71.9   76.6   81.8   69.5    77.9   69.9          NaN
4  2003   59.7   61.1   65.3   70.2   76.2   61.0    72.0   61.6          NaN
2025-03-29 14:12:48,018 - INFO - Columns in df_economic: ['Year', 'GDP Growth Rate (%)', 'Unemployment Rate (%)', 'Annual Change in Unemployment (%)', 'Real Interest Rate (%)']
2025-03-29 14:12:48,018 - INFO - First 5 rows of df_economic:
   Year  GDP Growth Rate (%)  Unemployment Rate (%)  Annual Change in Unemployment (%)  Real Interest Rate (%)
0  2002             1.656701                   7.28                               2.19                8.805613
1  2003             3.056284                   7.86                               0.58               11.711278
2  2004             8.700021                   6.74                              -1.12                8.932391
3  2005             7.388156                   5.58                              -1.16                6.367951
4  2006             7.032607                   4.77                              -0.81                8.496912
2025-03-29 14:12:48,044 - INFO - Merging datasets...
2025-03-29 14:12:48,055 - INFO - Columns in merged DataFrame: ['Year', 'Month', 'Rent_Hong_Kong', 'Rent_Kowloon', 'Rent_New_Territories', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Date', 'A_x', 'B_x', 'C_x', 'D_x', 'E_x', 'Primary_Sales_No', 'Primary_Sales_Consideration', 'Secondary_Sales_No', 'Secondary_Sales_Consideration', 'A_Hong_Kong', 'A_Kowloon', 'A_New Territories', 'B_Hong_Kong', 'B_Kowloon', 'B_New Territories', 'C_Hong_Kong', 'C_Kowloon', 'C_New Territories', 'D_Hong_Kong', 'D_Kowloon', 'D_New Territories', 'E_Hong_Kong', 'E_Kowloon', 'E_New Territories', 'A_y', 'B_y', 'C_y', 'D_y', 'E_y', 'A.1', ' B & C', 'D & E', 'All Classes', 'GDP Growth Rate (%)', 'Unemployment Rate (%)', 'Annual Change in Unemployment (%)', 'Real Interest Rate (%)', 'Population', 'Yearly % Change', 'Yearly Change', 'Migrants (net)', 'Median Age', 'Fertility Rate', 'Density (P/Km²)', 'Urban Pop %', 'Urban Population', "Country's Share of World Pop", 'World Population', 'Global Rank']
2025-03-29 14:12:48,060 - INFO - First 5 rows of merged DataFrame:
   Year  Month  Rent_Hong_Kong  Rent_Kowloon  Rent_New_Territories  Price_Hong_Kong  Price_Kowloon  Price_New_Territories       Date  A_x  B_x  C_x  D_x  E_x  Primary_Sales_No  Primary_Sales_Consideration  Secondary_Sales_No  Secondary_Sales_Consideration  A_Hong_Kong  A_Kowloon  A_New Territories  B_Hong_Kong  B_Kowloon  B_New Territories  C_Hong_Kong  C_Kowloon  C_New Territories  D_Hong_Kong  D_Kowloon  D_New Territories  E_Hong_Kong  E_Kowloon  E_New Territories    A_y    B_y    C_y    D_y    E_y    A.1   B & C  D & E  All Classes  GDP Growth Rate (%)  Unemployment Rate (%)  Annual Change in Unemployment (%)  Real Interest Rate (%)  Population  Yearly % Change  Yearly Change  Migrants (net)  Median Age  Fertility Rate  Density (P/Km²)  Urban Pop %  Urban Population  Country's Share of World Pop  World Population  Global Rank
0  1999      1             776           799                   551           145982         136973                 140446 1999-01-01  5.2  4.3  4.3  4.5  4.5               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0  100.0  100.0  100.0  100.0  100.0  100.0   100.0  100.0          NaN                  NaN                    NaN                                NaN                     NaN         NaN              NaN            NaN             NaN         NaN             NaN              NaN          NaN               NaN                           NaN               NaN          NaN
1  1999      2             793           835                   568           111466         234150                 111028 1999-02-01  5.2  4.3  4.4  4.7  4.4               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0  100.0  100.0  100.0  100.0  100.0  100.0   100.0  100.0          NaN                  NaN                    NaN                                NaN                     NaN         NaN              NaN            NaN             NaN         NaN             NaN              NaN          NaN               NaN                           NaN               NaN          NaN
2  1999      3             790           865                   679           107098         161751                 104394 1999-03-01  5.2  4.3  4.5  4.6  4.6               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0  100.0  100.0  100.0  100.0  100.0  100.0   100.0  100.0          NaN                  NaN                    NaN                                NaN                     NaN         NaN              NaN            NaN             NaN         NaN             NaN              NaN          NaN               NaN                           NaN               NaN          NaN
3  1999      4             759           831                   681           110840         227823                  82195 1999-04-01  5.1  4.4  4.4  4.5  4.2               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0  100.0  100.0  100.0  100.0  100.0  100.0   100.0  100.0          NaN                  NaN                    NaN                                NaN                     NaN         NaN              NaN            NaN             NaN         NaN             NaN              NaN          NaN               NaN                           NaN               NaN          NaN
4  1999      5             717           861                   617           171299         139793                 153616 1999-05-01  5.1  4.3  4.4  4.5  4.1               NaN                          NaN                 NaN                            NaN        193.0      173.0              133.0        197.0      157.0              116.0        248.0      183.0              140.0        274.0      187.0              177.0        307.0      186.0              175.0  100.0  100.0  100.0  100.0  100.0  100.0   100.0  100.0          NaN                  NaN                    NaN                                NaN                     NaN         NaN              NaN            NaN             NaN         NaN             NaN              NaN          NaN               NaN                           NaN               NaN          NaN
2025-03-29 14:12:48,061 - INFO - Target columns: ['Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories']
2025-03-29 14:12:48,061 - INFO - Data in Price_Hong_Kong (first 5 rows): [145982, 111466, 107098, 110840, 171299]
2025-03-29 14:12:48,062 - INFO - Min value in Price_Hong_Kong: 65409, Max value in Price_Hong_Kong: 888210
2025-03-29 14:12:48,062 - INFO - Data in Price_Kowloon (first 5 rows): [136973, 234150, 161751, 227823, 139793]
2025-03-29 14:12:48,062 - INFO - Min value in Price_Kowloon: 79192, Max value in Price_Kowloon: 627952
2025-03-29 14:12:48,062 - INFO - Data in Price_New_Territories (first 5 rows): [140446, 111028, 104394, 82195, 153616]
2025-03-29 14:12:48,062 - INFO - Min value in Price_New_Territories: 61105, Max value in Price_New_Territories: 708985
2025-03-29 14:12:48,065 - WARNING - Interest Rate or Rental Index column not found. Skipping Interest_Rental_Ratio feature.
2025-03-29 14:12:48,073 - WARNING - NaN values found after initial fill. Filling with column means...
2025-03-29 14:12:48,082 - INFO - Number of selected features before feature selection: 68
2025-03-29 14:12:48,104 - INFO - Target values (y) before scaling: [[145982. 136973. 140446.]
 [111466. 234150. 111028.]
 [107098. 161751. 104394.]
 [110840. 227823.  82195.]
 [171299. 139793. 153616.]]
2025-03-29 14:12:48,104 - INFO - Target values (y) min: 61105.0, max: 888210.0
2025-03-29 14:12:48,117 - INFO - Price scaler mean_: [341777.68690096 297930.59744409 249102.16536864]
2025-03-29 14:12:48,117 - INFO - Price scaler scale_: [184464.04997183 124015.20656389 133778.90598671]
2025-03-29 14:12:48,117 - INFO - X_train shape: (234, 68)
2025-03-29 14:12:48,117 - INFO - X_test shape: (79, 68)
2025-03-29 14:12:48,117 - INFO - y_train shape: (234, 3)
2025-03-29 14:12:48,117 - INFO - y_test shape: (79, 3)
2025-03-29 14:12:48,117 - INFO - y_test before inverse transform: [[ 0.22259792  1.92912151  1.18947627]
 [ 0.56984715  0.50229649  2.64853291]
 [ 1.00264151  0.99538924  0.80267389]
 [ 1.2820347   0.66821969  0.50048873]
 [ 0.59429636 -0.03074298  0.84647751]]
2025-03-29 14:12:48,117 - INFO - Performing feature selection with mutual information...
2025-03-29 14:12:48,175 - INFO - Selected features after feature selection: ['Real Interest Rate (%)_lag_1', 'E_y', 'B_x', 'Real Interest Rate (%)', 'C_Hong_Kong', 'B_Hong_Kong', 'Year', 'Real Interest Rate (%)_lag_2']
2025-03-29 14:12:48,175 - INFO - Number of selected features after feature selection: 8
2025-03-29 14:12:48,176 - INFO - Updated DataFrame columns after feature selection: ['Date', 'Price_Hong_Kong', 'Price_Kowloon', 'Price_New_Territories', 'Real Interest Rate (%)_lag_1', 'E_y', 'B_x', 'Real Interest Rate (%)', 'C_Hong_Kong', 'B_Hong_Kong', 'Year', 'Real Interest Rate (%)_lag_2']
2025-03-29 14:12:48,176 - INFO - Number of feature columns in df after feature selection: 8
2025-03-29 14:12:48,187 - INFO - Using device: cpu
2025-03-29 14:12:48,187 - INFO - Training Transformer model for Hong Kong...
2025-03-29 14:12:48,896 - INFO - Epoch 10/100, Loss for Hong Kong: 0.4396
2025-03-29 14:12:49,245 - INFO - Epoch 20/100, Loss for Hong Kong: 0.1204
2025-03-29 14:12:49,595 - INFO - Epoch 30/100, Loss for Hong Kong: 0.3072
2025-03-29 14:12:49,951 - INFO - Epoch 40/100, Loss for Hong Kong: 0.2222
2025-03-29 14:12:50,255 - INFO - Epoch 50/100, Loss for Hong Kong: 0.3707
2025-03-29 14:12:50,593 - INFO - Epoch 60/100, Loss for Hong Kong: 0.6289
2025-03-29 14:12:50,892 - INFO - Epoch 70/100, Loss for Hong Kong: 0.5454
2025-03-29 14:12:51,185 - INFO - Epoch 80/100, Loss for Hong Kong: 0.2462
2025-03-29 14:12:51,519 - INFO - Epoch 90/100, Loss for Hong Kong: 0.1275
2025-03-29 14:12:51,833 - INFO - Epoch 100/100, Loss for Hong Kong: 0.3633
2025-03-29 14:12:51,837 - INFO - Training Transformer model for Kowloon...
2025-03-29 14:12:52,141 - INFO - Epoch 10/100, Loss for Kowloon: 0.1422
2025-03-29 14:12:52,467 - INFO - Epoch 20/100, Loss for Kowloon: 0.1423
2025-03-29 14:12:52,821 - INFO - Epoch 30/100, Loss for Kowloon: 0.1718
2025-03-29 14:12:53,111 - INFO - Epoch 40/100, Loss for Kowloon: 0.0990
2025-03-29 14:12:53,444 - INFO - Epoch 50/100, Loss for Kowloon: 0.5379
2025-03-29 14:12:53,781 - INFO - Epoch 60/100, Loss for Kowloon: 0.2633
2025-03-29 14:12:54,071 - INFO - Epoch 70/100, Loss for Kowloon: 0.2472
2025-03-29 14:12:54,395 - INFO - Epoch 80/100, Loss for Kowloon: 0.0653
2025-03-29 14:12:54,731 - INFO - Epoch 90/100, Loss for Kowloon: 0.3866
2025-03-29 14:12:55,017 - INFO - Epoch 100/100, Loss for Kowloon: 0.2047
2025-03-29 14:12:55,018 - INFO - Training Transformer model for New Territories...
2025-03-29 14:12:55,334 - INFO - Epoch 10/100, Loss for New Territories: 0.1084
2025-03-29 14:12:55,652 - INFO - Epoch 20/100, Loss for New Territories: 0.1983
2025-03-29 14:12:55,937 - INFO - Epoch 30/100, Loss for New Territories: 0.1737
2025-03-29 14:12:56,219 - INFO - Epoch 40/100, Loss for New Territories: 0.2738
2025-03-29 14:12:56,513 - INFO - Epoch 50/100, Loss for New Territories: 0.0515
2025-03-29 14:12:56,808 - INFO - Epoch 60/100, Loss for New Territories: 0.1031
2025-03-29 14:12:57,090 - INFO - Epoch 70/100, Loss for New Territories: 0.2189
2025-03-29 14:12:57,387 - INFO - Epoch 80/100, Loss for New Territories: 0.2581
2025-03-29 14:12:57,732 - INFO - Epoch 90/100, Loss for New Territories: 0.1113
2025-03-29 14:12:58,013 - INFO - Epoch 100/100, Loss for New Territories: 0.1324
2025-03-29 14:12:58,014 - INFO - Transformer test predictions: [[1.09760404 1.00435984 1.11164069]
 [1.09760404 1.00435984 1.11164069]
 [1.09183562 1.00309229 1.1051327 ]
 [1.09183562 1.00309229 1.1051327 ]
 [1.08563006 1.00163639 1.09751558]]
2025-03-29 14:12:58,021 - INFO - Training Prophet model for Hong Kong...
2025-03-29 14:12:58,028 - INFO - Prophet train data for Hong Kong:           ds       y
0 1999-01-01  145982
1 1999-02-01  111466
2 1999-03-01  107098
3 1999-04-01  110840
4 1999-05-01  171299
2025-03-29 14:12:58,029 - INFO - Number of data points in prophet_train for Hong Kong: 234
2025-03-29 14:12:58,095 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/ypsz1dwq.json
2025-03-29 14:12:58,100 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/cfs0j76d.json
2025-03-29 14:12:58,105 - DEBUG - idx 0
2025-03-29 14:12:58,105 - DEBUG - running CmdStan, num_threads: None
2025-03-29 14:12:58,106 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=11594', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/ypsz1dwq.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/cfs0j76d.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelh847nkn3/prophet_model-20250329141258.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 14:12:58,106 - INFO - Chain [1] start processing
2025-03-29 14:12:58,188 - INFO - Chain [1] done processing
2025-03-29 14:12:58,267 - INFO - Prophet test predictions for Hong Kong: [549557.87033569 533494.81948792 533899.36184859 540976.22768549
 553007.88661332]
2025-03-29 14:12:58,267 - INFO - Training Prophet model for Kowloon...
2025-03-29 14:12:58,268 - INFO - Prophet train data for Kowloon:           ds       y
0 1999-01-01  136973
1 1999-02-01  234150
2 1999-03-01  161751
3 1999-04-01  227823
4 1999-05-01  139793
2025-03-29 14:12:58,268 - INFO - Number of data points in prophet_train for Kowloon: 234
2025-03-29 14:12:58,273 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/o99r7pyv.json
2025-03-29 14:12:58,277 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/9t6_si47.json
2025-03-29 14:12:58,278 - DEBUG - idx 0
2025-03-29 14:12:58,278 - DEBUG - running CmdStan, num_threads: None
2025-03-29 14:12:58,278 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=70778', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/o99r7pyv.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/9t6_si47.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_modelpirmijl0/prophet_model-20250329141258.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 14:12:58,278 - INFO - Chain [1] start processing
2025-03-29 14:12:58,334 - INFO - Chain [1] done processing
2025-03-29 14:12:58,367 - INFO - Prophet test predictions for Kowloon: [411687.64391091 434039.85363333 404201.25486984 387293.33844205
 431525.77853287]
2025-03-29 14:12:58,367 - INFO - Training Prophet model for New Territories...
2025-03-29 14:12:58,368 - INFO - Prophet train data for New Territories:           ds         y
0 1999-01-01  140446.0
1 1999-02-01  111028.0
2 1999-03-01  104394.0
3 1999-04-01   82195.0
4 1999-05-01  153616.0
2025-03-29 14:12:58,368 - INFO - Number of data points in prophet_train for New Territories: 234
2025-03-29 14:12:58,374 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/u_dju5do.json
2025-03-29 14:12:58,380 - DEBUG - input tempfile: /var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/k_polibu.json
2025-03-29 14:12:58,380 - DEBUG - idx 0
2025-03-29 14:12:58,380 - DEBUG - running CmdStan, num_threads: None
2025-03-29 14:12:58,380 - DEBUG - CmdStan args: ['/opt/anaconda3/envs/tf_m3_new/lib/python3.9/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=75889', 'data', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/u_dju5do.json', 'init=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/k_polibu.json', 'output', 'file=/var/folders/ss/1k6s1myj40l0pz1pm9k7ztbw0000gn/T/tmpn_5_kvlt/prophet_model5jqbr3u3/prophet_model-20250329141258.csv', 'method=optimize', 'algorithm=lbfgs', 'iter=10000']
2025-03-29 14:12:58,380 - INFO - Chain [1] start processing
2025-03-29 14:12:58,432 - INFO - Chain [1] done processing
2025-03-29 14:12:58,456 - INFO - Prophet test predictions for New Territories: [402793.91425732 399316.91910021 416399.45842783 392776.27986319
 432534.18146572]
2025-03-29 14:12:58,462 - INFO - Evaluating new model (Transformer + Prophet)...
2025-03-29 14:12:58,462 - INFO - Ensemble predictions before inverse transform: [[219823.8066967  164675.66018027 161118.23268734]
 [213398.58635759 173616.54406924 159727.4346245 ]
 [213560.39984081 161681.10380331 166560.44645075]
 [216391.14617557 154917.93723219 157111.1750249 ]
 [221203.80602336 172610.91239498 173014.33109564]]
2025-03-29 14:12:58,468 - INFO - y_true (actual test prices): [[382839. 537171. 408229.]
 [446894. 360223. 603420.]
 [526729. 421374. 356483.]
 [578267. 380800. 316057.]
 [451404. 294118. 362343.]]
2025-03-29 14:12:58,468 - INFO - y_pred (predicted test prices): [[4.05499314e+10 2.04225839e+10 2.15544700e+10]
 [3.93647093e+10 2.15313895e+10 2.13684106e+10]
 [3.93945580e+10 2.00512134e+10 2.22825234e+10]
 [3.99167290e+10 1.92124779e+10 2.10184102e+10]
 [4.08044917e+10 2.14066759e+10 2.31459170e+10]]
2025-03-29 14:12:58,475 - INFO - Ensemble Hong Kong - RMSE: 43167910659.58 HKD/m², MAE: 43091154887.88 HKD/m², MAPE: 10129039.76%, R²: -99071688035.6722
2025-03-29 14:12:58,475 - INFO - Ensemble Hong Kong - 90% CI: [39410464068.94, 47355019998.64]
2025-03-29 14:12:58,475 - INFO - Ensemble Kowloon - RMSE: 20923591226.54 HKD/m², MAE: 20908217122.34 HKD/m², MAPE: 5968422.10%, R²: -60111591222.1770
2025-03-29 14:12:58,475 - INFO - Ensemble Kowloon - 90% CI: [19353413960.28, 21987677564.51]
2025-03-29 14:12:58,476 - INFO - Ensemble New Territories - RMSE: 24239115714.36 HKD/m², MAE: 24188935362.01 HKD/m², MAPE: 7032238.43%, R²: -73826665936.9606
2025-03-29 14:12:58,476 - INFO - Ensemble New Territories - 90% CI: [21559378150.72, 26608623004.84]
2025-03-29 14:12:58,484 - INFO - Features shape: (8,)
2025-03-29 14:12:58,485 - INFO - Number of selected features in predict_future: 8
2025-03-29 14:12:58,485 - INFO - Features values shape after manual selection: (1, 8)
2025-03-29 14:12:58,536 - INFO - Prophet future predictions: [[604221.48103139 425927.26046351 513848.70141675]
 [686365.26703981 436616.77133309 503569.43820518]
 [613583.83340956 443109.91800411 496157.38026166]
 [618133.95469029 421522.3899425  491583.54174065]
 [629246.28027444 410712.42432507 506732.67507544]]
2025-03-29 14:12:58,610 - INFO - Transformer future predictions: [[484787.9308211  426313.6820629  382256.49608922]
 [484787.9308211  426313.6820629  382256.49608922]
 [484787.9308211  426313.6820629  382256.49608922]
 [484787.9308211  426313.6820629  382256.49608922]
 [484787.9308211  426313.6820629  382256.49608922]]
2025-03-29 14:12:58,610 - INFO - Future predictions before inverse transform: [[532561.35090522 426159.11342314 434893.37822023]
 [565418.86530858 430434.91777097 430781.6729356 ]
 [536306.29185648 433032.17643938 427816.84975819]
 [538126.34036878 424397.16521474 425987.31434979]
 [542571.27060244 420073.17896777 432046.96768371]]
2025-03-29 14:12:58,620 - INFO - Future predictions (first 5 rows):         Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0 2025-02-01       532561.350905       426159.113423       434893.378220           434893.378220                 460599.840010                 490555.606717
1 2025-03-01       565418.865309       430434.917771       430781.672936           430781.672936                 462967.816258                 491505.553316
2 2025-04-01       536306.291856       433032.176439       427816.849758           433032.176439                 461041.151160                 490657.698155
3 2025-05-01       538126.340369       424397.165215       425987.314350           425987.314350                 461030.056591                 490753.606261
4 2025-06-01       542571.270602       420073.178968       432046.967684           432046.967684                 463318.527195                 490931.838877
2025-03-29 14:13:00,369 - INFO - test_pred for Hong Kong: [219823.8066967  213398.58635759 213560.39984081 216391.14617557
 221203.80602336]
2025-03-29 14:13:00,369 - INFO - testY_inverse for Hong Kong: [382839. 446894. 526729. 578267. 451404.]
2025-03-29 14:13:00,471 - INFO - test_pred for Kowloon: [164675.66018027 173616.54406924 161681.10380331 154917.93723219
 172610.91239498]
2025-03-29 14:13:00,472 - INFO - testY_inverse for Kowloon: [537171. 360223. 421374. 380800. 294118.]
2025-03-29 14:13:00,545 - INFO - test_pred for New Territories: [161118.23268734 159727.4346245  166560.44645075 157111.1750249
 173014.33109564]
2025-03-29 14:13:00,545 - INFO - testY_inverse for New Territories: [408229. 603420. 356483. 316057. 362343.]
2025-03-29 14:13:01,190 - INFO - 
Future Predictions (First 12 Months):
2025-03-29 14:13:01,192 - INFO -          Date  Predicted Price HK  Predicted Price KL  Predicted Price NT  Predicted Median Price  Predicted Median Price Lower  Predicted Median Price Upper
0  2025-02-01       532561.350905       426159.113423       434893.378220           434893.378220                 460599.840010                 490555.606717
1  2025-03-01       565418.865309       430434.917771       430781.672936           430781.672936                 462967.816258                 491505.553316
2  2025-04-01       536306.291856       433032.176439       427816.849758           433032.176439                 461041.151160                 490657.698155
3  2025-05-01       538126.340369       424397.165215       425987.314350           425987.314350                 461030.056591                 490753.606261
4  2025-06-01       542571.270602       420073.178968       432046.967684           432046.967684                 463318.527195                 490931.838877
5  2025-07-01       543815.617968       425250.993909       431366.387656           431366.387656                 460011.688122                 490766.545081
6  2025-08-01       544099.021229       432059.096459       429873.575061           432059.096459                 460214.329063                 490620.967189
7  2025-09-01       543469.610806       417446.457108       431466.168127           431466.168127                 462281.774674                 490989.926580
8  2025-10-01       549590.587855       416385.316288       427946.045907           427946.045907                 459920.109493                 489611.650542
9  2025-11-01       550793.586610       431227.806268       437505.791195           437505.791195                 460776.168805                 489146.526599
10 2025-12-01       533471.058672       430237.687108       432593.014050           432593.014050                 462976.111264                 490996.237693
11 2026-01-01       547145.376621       428335.590343       433610.921774           433610.921774                 460212.551351                 491346.389687
